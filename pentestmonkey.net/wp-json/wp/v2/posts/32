{"id":32,"date":"2008-01-11T20:49:08","date_gmt":"2008-01-11T20:49:08","guid":{"rendered":"http:\/\/pentestmonkey.net\/?p=32"},"modified":"2011-08-20T15:54:45","modified_gmt":"2011-08-20T15:54:45","slug":"rsh-rlogin-config-linux","status":"publish","type":"post","link":"https:\/\/pentestmonkey.net\/blog\/rsh-rlogin-config-linux","title":{"rendered":"Getting RSH on Linux to work like RSH on Solaris"},"content":{"rendered":"<p>If you&#8217;ve tried setting up rsh\/rlogin based hacker challenges on Linux over the last few years you&#8217;ve probably noticed that Linux (I tried Redhat and Debian) doesn&#8217;t behave like Solaris.\u00a0 This makes either for really bad hacker challenges, or for ones involving lots of Solaris boxes.<\/p>\n<p>I finally found the answer recently so thought I&#8217;d post the answer incase it helps anyone else afflicted by this puzzle.<\/p>\n<p><!--more--><\/p>\n<h3>The Problem<\/h3>\n<p>If you set up a server (say 10.0.0.1) and create a user (ptm) with an insecure .rhosts file (&#8220;+ +&#8221;) you find that you can&#8217;t abuse this account as planned:<\/p>\n<pre>$ rsh -l ptm 10.0.0.1 id\r\nPermission denied.<\/pre>\n<pre>$ rlogin -l ptm 10.0.0.1\r\nPassword:<\/pre>\n<p>This is not how it works on Solaris, and it&#8217;s probably not what you want for your hacker challenge.\u00a0 + is supposed to be a wild card.\u00a0 The first + in the .rhosts file means any source IP can log in.\u00a0 The second + means that any source username can log in.<\/p>\n<p>You&#8217;ll find entries like the following in \/var\/log\/auth.log:<\/p>\n<pre>Jan 11 20:17:47 debian pam_rhosts_auth[3423]: denied to foo@10.0.0.1 as ptm: access not allowed\r\nJan 11 20:17:47 debian in.rshd[3423]: rsh denied to foo@192.168.20.1 as ptm: Permission denied<\/pre>\n<p>There&#8217;s the clue, then.\u00a0 PAM is unhappy and has denied our login attempt.<\/p>\n<h3>The Solution<\/h3>\n<p>I found <a href=\"http:\/\/forums.fedoraforum.org\/archive\/index.php\/t-57722.html\">this post<\/a> by Nalin Dahyabhai who notes that you simply need to pass the&#8221;promiscuous&#8221; option to pam_rhosts_auth.so:<\/p>\n<pre>debian:\/etc\/pam.d# cat rsh\r\nauth\u00a0\u00a0\u00a0 required\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 pam_nologin.so\r\nauth\u00a0\u00a0\u00a0 required\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 pam_env.so\r\nauth\u00a0\u00a0\u00a0 required\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 pam_rhosts_auth.so promiscuous\r\naccount required\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 pam_unix_acct.so\r\nsession required\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 pam_unix_session.so<\/pre>\n<p>You should also do this for \/etc\/pam.d\/rlogin.<\/p>\n<p>RSH and RLogin will then work like Solaris, e.g. if user ptm has an entry like the following in ~\/.rhosts:<\/p>\n<pre>+ +<\/pre>\n<p>The following commands now work:<\/p>\n<pre>$ rsh -l ptm 10.0.0.1 id<\/pre>\n<pre>$ rlogin -l ptm 10.0.0.1<\/pre>\n<p>&nbsp;<\/p>\n<p>&nbsp;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>If you&#8217;ve tried setting up rsh\/rlogin based hacker challenges on Linux over the last few years you&#8217;ve probably noticed that Linux (I tried Redhat and Debian) doesn&#8217;t behave like Solaris.\u00a0 This makes either for really bad hacker challenges, or for ones involving lots of Solaris boxes. I finally found the answer recently so thought I&#8217;d [&hellip;]<\/p>\n","protected":false},"author":3,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[5],"tags":[75,19,100,101],"_links":{"self":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/32"}],"collection":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/users\/3"}],"replies":[{"embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/comments?post=32"}],"version-history":[{"count":2,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/32\/revisions"}],"predecessor-version":[{"id":141,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/32\/revisions\/141"}],"wp:attachment":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/media?parent=32"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/categories?post=32"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/tags?post=32"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}