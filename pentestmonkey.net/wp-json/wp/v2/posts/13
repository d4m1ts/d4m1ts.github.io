{"id":13,"date":"2007-06-18T20:02:22","date_gmt":"2007-06-18T20:02:22","guid":{"rendered":"http:\/\/pentestmonkey.net\/?p=13"},"modified":"2011-08-20T16:03:51","modified_gmt":"2011-08-20T16:03:51","slug":"yapscan-bigger-scans","status":"publish","type":"post","link":"https:\/\/pentestmonkey.net\/blog\/yapscan-bigger-scans","title":{"rendered":"Yapscan Update: Scan Unlimited Hosts"},"content":{"rendered":"<p>Previous versions of yapscan had an annoying habbit of consuming large amounts of memory if you tried to do a really big portscan.\u00a0 The latest version calculates the amount of memory that will be required, and if it&#8217;s above a user-configurable maximum (150MB by default), it breaks the scan into smaller chunks.<\/p>\n<p>Download the latest version <a href=\"..\/tools\/yapscan\">here<\/a>.<\/p>\n<p><!--more--><\/p>\n<p>In the example below the memory limit is set artificially low at 5 MB.\u00a0 We can see that yapscan now detects that it won&#8217;t have sufficient memory and splits the scan into chunks.<\/p>\n<p>$ sudo .\/yapscan -sS localhost\/24 -i lo -m 5m -p 1-1024<br \/>\nStarting Yapscan v0.7.0-beta ( http:\/\/pentestmonkey.net\/tools\/yapscan )<\/p>\n<p>&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-<br \/>\n|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Scan Information\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |<br \/>\n&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-<br \/>\nScan type: &#8230;&#8230;&#8230; TCP<br \/>\nInterface: &#8230;&#8230;&#8230; lo<br \/>\nBandwidth limit: &#8230; 1000000 bits\/sec<br \/>\nSource address: &#8230;. 127.0.0.1<br \/>\nRTT: &#8230;&#8230;&#8230;&#8230;&#8230; 0.950000 secs<br \/>\nRetries: &#8230;&#8230;&#8230;.. 0<br \/>\nMax Memory: &#8230;&#8230;.. 5000 KBytes (Scanning up to 78 hosts at once)<br \/>\nPort range: &#8230;&#8230;.. 1-1024<br \/>\nPort count: &#8230;&#8230;.. 1024<br \/>\nShow closed ports .. off<br \/>\nWARNING: Network address wasn&#8217;t used to specify range to be scanned<\/p>\n<p>######## Scan of first 78 hosts started at 2007-06-18 19:48:24 +0000 #########<br \/>\n127.0.0.1:25\u00a0\u00a0\u00a0 smtp\u00a0\u00a0\u00a0 Len=44 TTL=64 IPID=0 FLAGS=SA______ SEQ=0x5da61087 ACK=0x4cbb77cf WIN=32792<br \/>\n127.0.0.1:53\u00a0\u00a0\u00a0 domain\u00a0 Len=44 TTL=64 IPID=0 FLAGS=SA______ SEQ=0x5ceda1af ACK=0x2e6a7121 WIN=32792<br \/>\n127.0.0.1:631\u00a0\u00a0 ipp\u00a0\u00a0\u00a0\u00a0 Len=44 TTL=64 IPID=0 FLAGS=SA______ SEQ=0x5df082b1 ACK=0xc814eab6 WIN=32792<br \/>\n127.0.0.1:22\u00a0\u00a0\u00a0 ssh\u00a0\u00a0\u00a0\u00a0 Len=44 TTL=64 IPID=0 FLAGS=SA______ SEQ=0x5e01a789 ACK=0x0aa84272 WIN=32792<br \/>\n127.0.0.1:902\u00a0\u00a0 vmware-authd\u00a0\u00a0\u00a0 Len=44 TTL=64 IPID=0 FLAGS=SA______ SEQ=0x5e93d221 ACK=0x9c1bc21f WIN=32792<br \/>\n127.0.0.1:80\u00a0\u00a0\u00a0 http\u00a0\u00a0\u00a0 Len=44 TTL=64 IPID=0 FLAGS=SA______ SEQ=0x5f2667cd ACK=0xd4888704 WIN=32792<br \/>\n####### Scan completed at 2007-06-18 19:48:51 +0000 #########<br \/>\n6 positive results.<\/p>\n<p>79872 packets (3194880 bytes) sent in 25.56 secs.<br \/>\nScan rate was: 999855 bits\/sec | 124982 bytes\/sec | 3125 packets\/sec.<\/p>\n<p>######## Scan of hosts 79 to 156 started at 2007-06-18 19:48:51 +0000 #########<br \/>\n####### Scan completed at 2007-06-18 19:49:16 +0000 #########<br \/>\n6 positive results.<\/p>\n<p>79872 packets (3194880 bytes) sent in 25.56 secs.<br \/>\nScan rate was: 999910 bits\/sec | 124989 bytes\/sec | 3125 packets\/sec.<\/p>\n<p>######## Scan of hosts 157 to 234 started at 2007-06-18 19:49:16 +0000 #########<br \/>\n####### Scan completed at 2007-06-18 19:49:42 +0000 #########<br \/>\n6 positive results.<\/p>\n<p>79872 packets (3194880 bytes) sent in 25.56 secs.<br \/>\nScan rate was: 999903 bits\/sec | 124988 bytes\/sec | 3125 packets\/sec.<\/p>\n<p>######## Scan of hosts 235 to 256 started at 2007-06-18 19:49:42 +0000 #########<br \/>\n####### Scan completed at 2007-06-18 19:49:49 +0000 #########<br \/>\n6 positive results.<\/p>\n<p>22528 packets (901120 bytes) sent in 7.21 secs.<br \/>\nScan rate was: 999892 bits\/sec | 124987 bytes\/sec | 3125 packets\/sec.<\/p>\n<p>&nbsp;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>Previous versions of yapscan had an annoying habbit of consuming large amounts of memory if you tried to do a really big portscan.\u00a0 The latest version calculates the amount of memory that will be required, and if it&#8217;s above a user-configurable maximum (150MB by default), it breaks the scan into smaller chunks. Download the latest [&hellip;]<\/p>\n","protected":false},"author":3,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[5],"tags":[90],"_links":{"self":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/13"}],"collection":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/users\/3"}],"replies":[{"embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/comments?post=13"}],"version-history":[{"count":2,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/13\/revisions"}],"predecessor-version":[{"id":443,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/13\/revisions\/443"}],"wp:attachment":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/media?parent=13"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/categories?post=13"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/tags?post=13"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}