{"id":497,"date":"2011-10-16T16:12:34","date_gmt":"2011-10-16T16:12:34","guid":{"rendered":"http:\/\/pentestmonkey.net\/?p=497"},"modified":"2011-10-07T19:51:51","modified_gmt":"2011-10-07T19:51:51","slug":"finding-ip-addresses-of-other-network-interfaces-on-linux","status":"publish","type":"post","link":"https:\/\/pentestmonkey.net\/uncategorized\/finding-ip-addresses-of-other-network-interfaces-on-linux","title":{"rendered":"Finding IP Addresses of Other Network Interfaces on Linux"},"content":{"rendered":"<p>The scenario for this post is that you&#8217;re connected to the local LAN of the systems you&#8217;re pentesting &#8211; possibly in a DMZ or multi-tiered architecture. \u00a0If you&#8217;re on an externally-facing LAN, you may find that there aren&#8217;t many network services to explore.<\/p>\n<p>As your pentest starts to look more like a vulnerability assessment, you might start thinking about the following:<\/p>\n<ul>\n<li>How many of these systems are multihomed?<\/li>\n<li>What network services are accessible on the other interfaces?<\/li>\n<\/ul>\n<p>In modern network architectures, systems often have a mangement LAN interface, or a backup LAN interface and potentially other interfaces that are more interesting than the one you&#8217;re looking at.<\/p>\n<p>If you can find the IP addresses of these other interfaces, you might be able to pentest a few more interesting network services from your vantage point on the external network segment.<\/p>\n<h2>Finding IP Addresses of Remote Network Interfaces<\/h2>\n<p>If you&#8217;re lucky you&#8217;ll be able to use <a href=\"http:\/\/linux.die.net\/man\/1\/snmpnetstat\">SNMP<\/a>\u00a0(generic) or a &#8220;<a href=\"http:\/\/www.nessus.org\/plugins\/index.php?view=single&amp;id=43815\">special NetBOIS query<\/a>&#8221; (Windows only) to list all the IP address of a system.<\/p>\n<p>If this doesn&#8217;t work, you might be able to bruteforce the IP addresses using ARP queries.<\/p>\n<p>Linux hosts will respond to ARP requests for all of their IP addresses on all of their Interfaces.\u00a0 \u00a0i.e. a multi-homed host might respond to both of these probes from the LAN you&#8217;re on:<\/p>\n<pre>arp-scan 10.0.0.99\r\narp-scan 192.168.0.99<\/pre>\n<p>This is counter-intuitive. \u00a0If you&#8217;re like me, you&#8217;d probably expect the target system to only answer ARP requests for IPs on the same LAN as the client. Indeed Solaris, Windows and AIX behave as expected.<\/p>\n<p>When ARP scanning, your source IP address might be important (so also try 0.0.0.0). \u00a0Reasoning for this is discussed further <a href=\"http:\/\/pentestmonkey.net\/blog\/the-science-of-safely-finding-an-unused-ip-address\">here<\/a>\u00a0and <a href=\"http:\/\/www.nta-monitor.com\/wiki\/index.php\/Arp-scan_User_Guide#Using_arp-scan_for_system_fingerprinting\">here<\/a>.<\/p>\n<p>Using <a href=\"http:\/\/www.nta-monitor.com\/tools\/arp-scan\/\">arp-scan<\/a>, a Class B can be scanned in 36 secs on my test system, using 3% CPU and 1 MB\/s bandwidth:<\/p>\n<pre>#\u00a0arp-scan --bandwidth=1M --retry=1 --arpspa=1.1.1.1 172.16.1.0\/16<\/pre>\n<p>So it&#8217;s just about practical to scan 10.0.0.0\/8, 172.16.0.0\/12 and 192.168.0.0\/16. It should take less than 3 hours and would cover all hosts on the local subnet if you used broadcast ARP requests. \u00a0To do this for 4 source addresses would take 12 hours, which is a more significant amount of time.<\/p>\n<p>If for some reason you don&#8217;t want to use broadcast ARP requests (maybe you&#8217;re not authorised to test the whole LAN), you can unicast requests by specifying the destination MAC address:<\/p>\n<pre>#\u00a0arp-scan --bandwidth=1M --retry=1 --arpspa=1.1.1.1 --destaddr=00:11:22:33:44:55 172.16.1.0\/16<\/pre>\n<h3>How to Fix<\/h3>\n<p>Changing\u00a0the <a href=\"http:\/\/www.linuxinsight.com\/proc_sys_net_ipv4_conf_eth0_arp_ignore.html\">arp_ignore<\/a> option in \/proc from 0 (default) to 1 will remedy the above\u00a0behavior.<\/p>\n<pre>echo 1 &gt; \/proc\/sys\/net\/ipv4\/conf\/all\/arp_ignore<\/pre>\n","protected":false},"excerpt":{"rendered":"<p>The scenario for this post is that you&#8217;re connected to the local LAN of the systems you&#8217;re pentesting &#8211; possibly in a DMZ or multi-tiered architecture. \u00a0If you&#8217;re on an externally-facing LAN, you may find that there aren&#8217;t many network services to explore. As your pentest starts to look more like a vulnerability assessment, you [&hellip;]<\/p>\n","protected":false},"author":3,"featured_media":0,"comment_status":"closed","ping_status":"closed","sticky":true,"template":"","format":"standard","meta":[],"categories":[1],"tags":[130,19],"_links":{"self":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/497"}],"collection":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/users\/3"}],"replies":[{"embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/comments?post=497"}],"version-history":[{"count":19,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/497\/revisions"}],"predecessor-version":[{"id":499,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/497\/revisions\/499"}],"wp:attachment":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/media?parent=497"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/categories?post=497"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/tags?post=497"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}