{"id":113,"date":"2006-09-14T23:35:42","date_gmt":"2006-09-14T23:35:42","guid":{"rendered":"http:\/\/pentestmonkey.net\/?p=113"},"modified":"2011-08-31T16:18:03","modified_gmt":"2011-08-31T16:18:03","slug":"yapscan","status":"publish","type":"post","link":"https:\/\/pentestmonkey.net\/tools\/misc\/yapscan","title":{"rendered":"yapscan"},"content":{"rendered":"<p>TCP Half-open port scanner \/ fast ICMP scanner. Some limited support for UDP scans too. It&#8217;s beta, but still kinda useful.<\/p>\n<p>Download Yapscan v0.7.4-beta as <a href=\"\/tools\/yapscan\/yapscan-0.7.4-beta.tar.gz\">tar.gz<\/a>. Recent changes are detailed in the <a href=\"\/tools\/yapscan\/CHANGELOG\">CHANGELOG.<\/a><\/p>\n<p>Update: You&#8217;re better off using the <a href=\"http:\/\/code.google.com\/p\/yapscan\/source\/checkout\">SVN copy on google code<\/a>. \u00a0It&#8217;s more up to date.<\/p>\n<p>MD5 and SHA1 checksums are the packages can be downloaded.\u00a0 They&#8217;re based on the package name (below v.v.v represents the version, e.g. 0.6.1):<br \/>\nhttp:\/\/pentestmonkey.net\/tools\/yapscan\/yapscan-v.v.v-beta.tar.gz.md5<br \/>\nhttp:\/\/pentestmonkey.net\/tools\/yapscan\/yapscan-v.v.v-beta.tar.gz.sha1<\/p>\n<p>User documentation is also available in <a href=\"\/tools\/yapscan\/yapscan-user-docs.pdf\">PDF<\/a> format.<\/p>\n<p><!--more--><\/p>\n<p>&nbsp;<\/p>\n<h1 align=\"center\">Yapscan User Documentation<\/h1>\n<p>&nbsp;<\/p>\n<h2><a title=\"SECTION00010000000000000000\" name=\"SECTION00010000000000000000\"><\/a> Contents<\/h2>\n<ul>\n<li><a title=\"tex2html31\" name=\"tex2html31\" href=\"#SECTION00020000000000000000\"><\/a>Overview<\/li>\n<li><a title=\"tex2html32\" name=\"tex2html32\" href=\"#SECTION00030000000000000000\"><\/a>License<\/li>\n<li><a title=\"tex2html33\" name=\"tex2html33\" href=\"#SECTION00040000000000000000\"><\/a>Installation\n<ul>\n<li><a title=\"tex2html34\" name=\"tex2html34\" href=\"#SECTION00041000000000000000\"><\/a>Quick Start<\/li>\n<li><a title=\"tex2html35\" name=\"tex2html35\" href=\"#SECTION00042000000000000000\"><\/a>Trouble Shooting<\/li>\n<li><a title=\"tex2html36\" name=\"tex2html36\" href=\"#SECTION00043000000000000000\"><\/a>Workaround For Missing OpenSSL Libraries<\/li>\n<\/ul>\n<\/li>\n<li><a title=\"tex2html37\" name=\"tex2html37\" href=\"#SECTION00050000000000000000\"><\/a>Features\n<ul>\n<li><a title=\"tex2html38\" name=\"tex2html38\" href=\"#SECTION00051000000000000000\"><\/a>TCP SYN Scanning<\/li>\n<li><a title=\"tex2html39\" name=\"tex2html39\" href=\"#SECTION00052000000000000000\"><\/a>(Limited) UDP Port Scanning<\/li>\n<li><a title=\"tex2html40\" name=\"tex2html40\" href=\"#SECTION00053000000000000000\"><\/a>ICMP Scanning<\/li>\n<li><a title=\"tex2html41\" name=\"tex2html41\" href=\"#SECTION00054000000000000000\"><\/a>Scanning Speed<\/li>\n<li><a title=\"tex2html42\" name=\"tex2html42\" href=\"#SECTION00055000000000000000\"><\/a>Retries<\/li>\n<\/ul>\n<\/li>\n<li><a title=\"tex2html43\" name=\"tex2html43\" href=\"#SECTION00060000000000000000\"><\/a>Yapscan Output\n<ul>\n<li><a title=\"tex2html44\" name=\"tex2html44\" href=\"#SECTION00061000000000000000\"><\/a>Scan Information<\/li>\n<li><a title=\"tex2html45\" name=\"tex2html45\" href=\"#SECTION00062000000000000000\"><\/a>Scan Start and End Times<\/li>\n<li><a title=\"tex2html46\" name=\"tex2html46\" href=\"#SECTION00063000000000000000\"><\/a>TCP Scanning<\/li>\n<li><a title=\"tex2html47\" name=\"tex2html47\" href=\"#SECTION00064000000000000000\"><\/a>ICMP Scanning<\/li>\n<\/ul>\n<\/li>\n<li><a title=\"tex2html48\" name=\"tex2html48\" href=\"#SECTION00070000000000000000\"><\/a>Limitations\n<ul>\n<li><a title=\"tex2html49\" name=\"tex2html49\" href=\"#SECTION00071000000000000000\"><\/a>Memory-hungry<\/li>\n<li><a title=\"tex2html50\" name=\"tex2html50\" href=\"#SECTION00072000000000000000\"><\/a>Replies from different IPs<\/li>\n<\/ul>\n<\/li>\n<li><a title=\"tex2html51\" name=\"tex2html51\" href=\"#SECTION00080000000000000000\"><\/a>Why write Yet Another Port Scanner?<\/li>\n<li><a title=\"tex2html52\" name=\"tex2html52\" href=\"#SECTION00090000000000000000\"><\/a>Credit<\/li>\n<\/ul>\n<p>&nbsp;<\/p>\n<h1><a title=\"SECTION00020000000000000000\" name=\"SECTION00020000000000000000\"><\/a>Overview<\/h1>\n<p>Yapscan is primarily a half-open TCP port scanner and ICMP scanner. It has a few other uses too. These are explained more fully in the &#8220;Features&#8221; section below.<\/p>\n<h1><a title=\"SECTION00030000000000000000\" name=\"SECTION00030000000000000000\"><\/a>License<\/h1>\n<p>This tool may be used for legal purposes only. Users take full responsibility for any actions performed using this tool. The author accepts no liability for damage caused by this tool. If these terms are not acceptable to you, then do not use this tool.<\/p>\n<p>In all other respects the GPL version 2 applies:<\/p>\n<pre> This program is free software; you can redistribute it and\/or modify\r\n it under the terms of the GNU General Public License version 2 as\r\n published by the Free Software Foundation. \r\n\r\n This program is distributed in the hope that it will be useful,\r\n but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n GNU General Public License for more details. \r\n\r\n You should have received a copy of the GNU General Public License along\r\n with this program; if not, write to the Free Software Foundation, Inc.,\r\n 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.<\/pre>\n<h1><a title=\"SECTION00040000000000000000\" name=\"SECTION00040000000000000000\"><\/a>Installation<\/h1>\n<h2><a title=\"SECTION00041000000000000000\" name=\"SECTION00041000000000000000\"><\/a> Quick Start<\/h2>\n<p>If you have a Linux system, with any luck the installation will just work. Other systems are not supported at this time.<\/p>\n<p>Firstly, go and download the latest tarball of yapscan from http:\/\/pentestmonkey.net if you haven&#8217;t already.<\/p>\n<pre> su -\r\n cd \/usr\/local\/src\r\n tar xfz yapscan-X.Y.tar.gz\r\n cd yapscan-X.Y\r\n make\r\n make install<\/pre>\n<h2><a title=\"SECTION00042000000000000000\" name=\"SECTION00042000000000000000\"><\/a> Trouble Shooting<\/h2>\n<p>Yapscan should install on most flavours of Linux. I&#8217;ve tried it on Gentoo using gcc v3.3.x, 3.4.x and 4.1.x (both x86 and AMD64) and Debian &#8220;Testing&#8221; using gcc-4.1.2. I think I&#8217;ve ironed out any bugs which stop compilation. That said, you&#8217;re reading this section, so I guess something went wrong&#8230;<\/p>\n<p>Any installation problems will be results of either missing header files, missing libraries or my dodgy code. Whatever the cause I&#8217;d like to make sure that this section covers the problem (or that I fix any dodgy code). If you run into problems and the notes below don&#8217;t help, please email me at the address on the first page.<\/p>\n<p>Yapscan depends on libpcap to capture reply packets, so firstly make sure you&#8217;ve installed it. On Gentoo the package is called &#8220;libpcap&#8221; on Debian it&#8217;s &#8220;libpcap-dev&#8221;(the version that includes the header files).<\/p>\n<p>Linking against OpenSSL is also recommended because it speeds up scanning. Installation is still possible if you can&#8217;t install OpenSSL &#8211; there&#8217;s a workaround below. The OpenSSL package on Gentoo is called &#8220;openssl&#8221;, on Debian it&#8217;s &#8220;openssl-dev&#8221;.<\/p>\n<p>If installing these dependencies doesn&#8217;t solve your problem, mail me and I&#8217;ll try to help.<\/p>\n<h2><a title=\"SECTION00043000000000000000\" name=\"SECTION00043000000000000000\"><\/a> Workaround For Missing OpenSSL Libraries<\/h2>\n<p>Open up &#8220;Makefile&#8221; in you favourite text editor and change this bit:<\/p>\n<pre> # OpenSSL's MD5 library speeds up scanning.  If you have openssl installed, do this:\r\n DEFINES=-DHAVE_LIBCRYPTO ${DEBUGDEFINES}\r\n LDLIBS=-lpcap -lcrypto \r\n\r\n # Otherwise do this:\r\n # DEFINES=${DEBUGDEFINES}\r\n # LDLIBS=-lpcap<\/pre>\n<p>to:<\/p>\n<pre> # OpenSSL's MD5 library speeds up scanning.  If you have openssl installed, do this:\r\n # DEFINES=-DHAVE_LIBCRYPTO ${DEBUGDEFINES}\r\n # LDLIBS=-lpcap -lcrypto \r\n\r\n # Otherwise do this:\r\n DEFINES=${DEBUGDEFINES}\r\n LDLIBS=-lpcap<\/pre>\n<p>The try to compile again:<\/p>\n<pre> make clean\r\n make\r\n make install<\/pre>\n<h1><a title=\"SECTION00050000000000000000\" name=\"SECTION00050000000000000000\"><\/a>Features<\/h1>\n<h2><a title=\"SECTION00051000000000000000\" name=\"SECTION00051000000000000000\"><\/a> TCP SYN Scanning<\/h2>\n<p>Also known as half-open scanning.<\/p>\n<p>On an internal network you probably just want to see the open ports. Here are some example of how to specify hosts and ports:<\/p>\n<pre> # yapscan -sS 192.168.0.1-254 -p 1-1024\r\n # yapscan -sS 10.0.0.1-10.0.255.255 -p 21,22,23,53,80,139,445,3389\r\n # yapscan -sS 172.16.0.0\/16 -p 80\r\n # yapscan -sS -f targets-ips.txt -p 4444<\/pre>\n<p>From an external network, you might also want to see the closed ports (-c):<\/p>\n<pre> # yapscan -sS www.example.com -p 1-65535 -c<\/pre>\n<p>You can scan just the common ports (using a portlist derived from nmap):<\/p>\n<pre> # yapscan -sS 127.0.0.1 -i lo -P common<\/pre>\n<p>(supported keywords are based on filenames what ship with yapscan. As of v0.5.5-beta there is: all, known, common, database)<\/p>\n<p>Note that we needed to specify the different interface to listen for replies on (default is eth0).<\/p>\n<p>Specify ports using names as well as numbers (from \/etc\/services):<\/p>\n<pre> # yapscan -sS router -i eth1 -p telnet,80,443,ssh,6000-6063<\/pre>\n<p>Or specify your own port list (1 port per line):<\/p>\n<pre> # yapscan -sS -f mytargets.txt -P myports.txt<\/pre>\n<p>You can do &#8220;-p -&#8221; like in nmap too if you want to scan 1-65535:<\/p>\n<pre> # yapscan -sS -f mytargets.txt -p -<\/pre>\n<p>I&#8217;ve also implemented the exotic type of scans like Xmas tree, null, etc. These aren&#8217;t particularly well tested as of v0.5.5-beta. See the help message for more info: yapscan -h<\/p>\n<p>Also see &#8220;Scanning Speed&#8221; and &#8220;Retries&#8221; near the end of this section. In particular, make sure you specify a low speed for remote testing (e.g. -b 32k).<\/p>\n<h2><a title=\"SECTION00052000000000000000\" name=\"SECTION00052000000000000000\"><\/a> (Limited) UDP Port Scanning<\/h2>\n<p>This scan mode is designed to answer the question &#8220;Does host X have any closed UDP ports?&#8221; i.e. does it reply with an ICMP Port Unreachable for probes sent to one or more of its UDP ports.<\/p>\n<p>This type of scan will (unfortunately) not tell you all the open UDP ports.<\/p>\n<p>I use this mainly for scanning Firewalled hosts which I&#8217;m pretty sure won&#8217;t have any closed UDP ports.<\/p>\n<p>Yapscan sends empty UDP packets to a range of ports at a steady (usually quite fast) rate. It will report any ICMP port unreachable messages it receives.<\/p>\n<p>If you receive no replies then you know there are no closed UDP ports.<\/p>\n<pre> # yapscan -su router -i eth1 -p 1-65535<\/pre>\n<p><strong>IMPORTANT NOTE:<\/strong> If you receive 1 or more ICMP port unreachable error messages, you cannot infer that these are the only close ports. Yapscan does not back-off intelligently like nmap, so a host which limits that rate at which it sends ICMP errors, will (falsely) appear to have less ports open.<\/p>\n<h2><a title=\"SECTION00053000000000000000\" name=\"SECTION00053000000000000000\"><\/a> ICMP Scanning<\/h2>\n<p>Yapscan can perform the following type of ICMP sweeps:<\/p>\n<ul>\n<li>Echo Request<\/li>\n<li>Timestamp Request<\/li>\n<li>Addressmask Request<\/li>\n<li>Information Request<\/li>\n<\/ul>\n<p>You can perform 1 or more types of scan at once:<\/p>\n<pre> # yapscan -sI 10.0.0.0\/16 -t echo\r\n # yapscan -sI 10.0.0.0\/16 -t echo -t addr\r\n # yapscan -sI 10.0.0.0\/16 -t info\r\n # yapscan -sI 10.0.0.0\/16 -t time\r\n # yapscan -sI 10.0.0.0\/16 -t -<\/pre>\n<p>The last example will scan all supported ICMP types.<\/p>\n<p>As of v0.5.5-beta yapscan is also able to send Router Solicitations, but it won&#8217;t report replies, so this 5th type isn&#8217;t much use at present.<\/p>\n<h2><a title=\"SECTION00054000000000000000\" name=\"SECTION00054000000000000000\"><\/a> Scanning Speed<\/h2>\n<p>Yapscan scans at a steady (and configurable) speed. You can get an ETA on you scan by pressing Enter during the scan.<\/p>\n<p>As of v0.4.9-beta yapscan will never underestimate the remaining scan time, though it can over estimate it under certain conditions.<\/p>\n<p>By default yapscan scans at 1000000 Bits \/ Second. Unless you have a fast link \/ understanding clients or both I suggest you only use the default for LAN testing. I wouldn&#8217;t recommend going much about 2Mb\/s for reliability \/ DoS reasons, but you can try it if you like:<\/p>\n<pre> # yapscan -sS -p - 192.168.0.1-14 -b 4M<\/pre>\n<p>WAN testing&#8217;s probably better done at a more sociable speed like 64Kb\/s:<\/p>\n<pre> # yapscan -sS -p - www.example.com -b 64k<\/pre>\n<p>Obviously, if the scan rate is set higher than either your upstream bandwidth or the client&#8217;s downstream bandwidth, packets will be dropped and the reliability of the scan reduced.<\/p>\n<h2><a title=\"SECTION00055000000000000000\" name=\"SECTION00055000000000000000\"><\/a> Retries<\/h2>\n<p>Reliability is obviously paramount during pentests, so the use of retries is encouraged. ICMP scans do 2 retries by default (a total of 3 tries in all). TCP and UDP only do 1.<\/p>\n<p>For an even more reliable ICMP scan you could do:<\/p>\n<pre> # yapscan -sI -r 5 myhost -t -<\/pre>\n<p>A TCP scan would be made more reliable by:<\/p>\n<pre> # yapscan -sS -r 2 myhost -p -<\/pre>\n<h1><a title=\"SECTION00060000000000000000\" name=\"SECTION00060000000000000000\"><\/a>Yapscan Output<\/h1>\n<h2><a title=\"SECTION00061000000000000000\" name=\"SECTION00061000000000000000\"><\/a> Scan Information<\/h2>\n<p>The first thing you see when you run yapscan is the &#8220;Scan Information&#8221; section. This section summarises the parameters for the scan. I included this basically so that when I looked back over my scan results I had some idea of what I&#8217;d scanned.<\/p>\n<pre>  ----------------------------------------------------------\r\n |                   Scan Information                       |\r\n  ----------------------------------------------------------\r\n Target count: ...... 1\r\n Interface: ......... lo\r\n Bandwidth limit: ... 1000000 bits\/sec\r\n Source address: .... 127.0.0.1\r\n RTT: ............... 0.950000 secs\r\n Tries: ............. 3\r\n ICMP Probe Types: .. 8 (ECHO_REQUEST)<\/pre>\n<p>The output looks slightly different for the various scan types.<\/p>\n<h2><a title=\"SECTION00062000000000000000\" name=\"SECTION00062000000000000000\"><\/a> Scan Start and End Times<\/h2>\n<p>The start and end times are included to provide a record of when the scan was done.<\/p>\n<pre> ######## Scan started at 2006-10-22 20:37:26 +0000 #########\r\n ...\r\n ####### Scan completed at 2006-10-22 20:37:27 +0000 #########<\/pre>\n<h2><a title=\"SECTION00063000000000000000\" name=\"SECTION00063000000000000000\"><\/a> TCP Scanning<\/h2>\n<p>Below is the output of a fictional TCP SYN scan run with the -c option to show closed ports as well as open ones (so I can illustrate some fields not always shown in the output).<\/p>\n<pre> 10.0.1.1:25   smtp  Len=46 TTL=19 IPID=0 FLAGS=_AR_____ SEQ=0x00000000 ACK=0x4e5d5003 WIN=0 DATA=\"rctcpoy\"\r\n 10.0.2.2:80    http  Len=46 TTL=21 IPID=0 FLAGS=_AR_____ SEQ=0x00000000 ACK=0x0b712500 WIN=0 DATA=\"rctcpo\"\r\n 10.0.3.3:53    domain  Len=44 TTL=64 IPID=0 FLAGS=SA______ SEQ=0xd1183250 ACK=0x17f67482 WIN=32792\r\n 10.0.4.4:1999     tcp-id-port     Len=40 TTL=59 IPID=43634 FLAGS=_AR____C SEQ=0x00000000\r\n ACK=0x28f45290 WIN=0\r\n 10.0.5.5:1999      tcp-id-port     Len=45 TTL=244 IPID=22340 FLAGS=_AR_____ SEQ=0x00000000\r\n ACK=0xab7e84c2 WIN=0 DATA=\"cisco\"<\/pre>\n<p>We&#8217;ll use the first reply to quickly cover most of the generic fields, then we&#8217;ll look at some of the interesting ones.<\/p>\n<table border=\"1\" cellpadding=\"3\">\n<tbody>\n<tr>\n<th align=\"left\"><strong>Field<\/strong><\/th>\n<th align=\"left\" valign=\"top\" width=\"198\"><strong>Meaning<\/strong><\/th>\n<\/tr>\n<tr>\n<td align=\"left\">10.0.3.3<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">IP Address reply came from<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">25<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">TCP Port number reply came from<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">smtp<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">Name of port (from \/etc\/services)<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">Len=46<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">Length of packet (IP header + TCP header + data)<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">TTL=19<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">Time-to-Live of reply packet<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">IPID=0<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">IP ID on reply<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">FLAGS=_AR_____<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">TCP Flags: S=SYN, A=ACK, R=RST, F=FIN, P=PSH, U=URG, E=ECN, C=CWR<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">SEQ=0x00000000<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">TCP Sequence number<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">ACK=0x4e5d5003<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">TCP Acknowledgement number<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">WIN=0<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">TCP Windows size<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">DATA=&#8220;rctcpoy&#8221;<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">Data carried by TCP packet (if any)<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<p>We see that IP address 10.0.3.3 has TCP port 53 open (note the SYN and ACK flags are set on the response). The rest of the packets indicate closed ports (the RST flag is set).<\/p>\n<p>Some of the RST packets have data attached. This is much more rare than I&#8217;ve made it seem in this example, but it&#8217;s an interesting feaure of yapscan, so worth some discussion.<\/p>\n<p>According to http:\/\/www.sonicwall.com\/support\/pdfs\/technotes\/SonicOS_TCP_RST.pdf, the string &#8220;rctcpo&#8221; for 10.0.2.2 seems to indicate that the host is protected by a Sonicwall Firewall. Presumably 10.0.3.3 is similarly protected, but I haven&#8217;t tracked down any documentation as to the exact meaning of &#8220;rctcpoy&#8221;.<\/p>\n<p>The data &#8220;cisco&#8221; is return on the response from 10.0.5.5. This is a feature of certain older version of Cisco IOS. The feature is documented as a fingerprinting vulnerability at http:\/\/cve.mitre.org\/cgi-bin\/cvename.cgi?name=1999-0453.<\/p>\n<p>Finally, note that the packet from 10.0.4.4 has the TCP C flag set. This is the Congestion Window Reduced flag, a relatively new TCP option.<\/p>\n<p>NB: There is currently no support for displaying IP options or TCP options.<\/p>\n<h2><a title=\"SECTION00064000000000000000\" name=\"SECTION00064000000000000000\"><\/a> ICMP Scanning<\/h2>\n<p>The output below shows pretty much all of the various fields you&#8217;re likely to come across when running ICMP sweeps with yapscan:<\/p>\n<pre> 10.0.1.1:18\/0 [ADDRESS_REPLY] Len=32 TTL=56 IPID=10224 ID=10406 SEQ=13643 MASK=255.255.254.0\r\n 10.0.2.2:18\/0 [ADDRESS_REPLY] Len=32 TTL=248 IPID=15111 ID=4233 SEQ=39939 MASK=255.255.255.252\r\n 10.0.3.3:14\/0 [TIMESTAMP_REPLY] Len=40 TTL=249 IPID=31174 ID=2463 SEQ=52706 orig=0x040f417e\r\n recv=0x83ecf893 xmit=0x83ecf893 std=0 end=1\r\n 10.0.4.4:14\/0 [TIMESTAMP_REPLY] Len=40 TTL=128 IPID=1617 ID=2182 SEQ=92 orig=0x041ae462\r\n recv=0x9cdc1a04 xmit=0x9cdc1a04 std=1 end=0 xmit-time=19:07:49.276 delta=-1.984\r\n 10.0.5.5:14\/0 [TIMESTAMP_REPLY] Len=40 TTL=240 IPID=10035 ID=6689 SEQ=42152 orig=0x040f40aa\r\n recv=0x04131907 xmit=0x04131907 std=1 end=1 xmit-time=18:59:20.455 delta=252.000\r\n 10.0.6.6:16\/0 [INFO_REPLY] Len=28 TTL=247 IPID=48924 ID=3706 SEQ=64144\r\n 10.0.7.7:16\/0 [INFO_REPLY] Len=28 TTL=243 IPID=64889 ID=10674 SEQ=17306\r\n 10.0.8.8:0\/0 [ECHO_REPLY] Len=28 TTL=128 IPID=1616 ID=21821 SEQ=92<\/pre>\n<h3><a title=\"SECTION00064100000000000000\" name=\"SECTION00064100000000000000\"><\/a> Generic ICMP Fields<\/h3>\n<p>The following fields are common to all ICMP results:<\/p>\n<table border=\"1\" cellpadding=\"3\">\n<tbody>\n<tr>\n<th align=\"left\"><strong>Field<\/strong><\/th>\n<th align=\"left\" valign=\"top\" width=\"198\"><strong>Meaning<\/strong><\/th>\n<\/tr>\n<tr>\n<td align=\"left\">10.0.1.1<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">IP Address reply came from<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">18\/0<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">The ICMP Type of the reply was 18. The ICMP Code was 0.<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">[ADDRESS_REPLY]<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">A human readable form for the ICMP Type. Type 18 is Address Mask Reply<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">Len=32<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">Length of packet (IP header + ICMP header + data)<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">TTL=56<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">Time-to-Live of reply packet<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">IPID=10224<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">IP ID on reply<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">SEQ=13643<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">ICMP Sequence number<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<p>&nbsp;<\/p>\n<h3><a title=\"SECTION00064200000000000000\" name=\"SECTION00064200000000000000\"><\/a> ICMP Address Mask Fields<\/h3>\n<p>A single field is unique to ICMP Address Mask scans:<\/p>\n<table border=\"1\" cellpadding=\"3\">\n<tbody>\n<tr>\n<th align=\"left\"><strong>Field<\/strong><\/th>\n<th align=\"left\" valign=\"top\" width=\"198\"><strong>Meaning<\/strong><\/th>\n<\/tr>\n<tr>\n<td align=\"left\">MASK=255.255.254.0<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">The netmask of the corresponding IP is 255.255.254.0<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<p>&nbsp;<\/p>\n<h3><a title=\"SECTION00064300000000000000\" name=\"SECTION00064300000000000000\"><\/a> ICMP Timestamp Fields<\/h3>\n<p>Yapscan will tell you if the remote system clock is accurate if the timestamp supplied is in a standard format. It manages this even the remote system has a broken IP stack which uses the wrong endianness for the timestamp fields.<\/p>\n<table border=\"1\" cellpadding=\"3\">\n<tbody>\n<tr>\n<th align=\"left\"><strong>Field<\/strong><\/th>\n<th align=\"left\" valign=\"top\" width=\"198\"><strong>Meaning<\/strong><\/th>\n<\/tr>\n<tr>\n<td align=\"left\">orig=0x040f417e<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">Originator timestamp in hex<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">recv=0x83ecf893<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">Received Timestamp in hex<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">xmit=0x83ecf893<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">Transmit Timestamp in hex<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">std=0<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">Do the timestamp fileds contain the number of milliseconds since midnight UTC as suggested by RFC 792?<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">end=1<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">Does the endianness of the xmit field appear to be correct (big endian AKA network byte order)? Most versions of Windows use the wrong endianness in this field.<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">xmit-time=19:07:49.276<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">Only displayed if std=1. A human readable representation of the xmit field. If the endianness of xmit was wrong, it is reverse before being converted to human readable format, so Yapscan will display meaningful timestamps even for Windows systems.<\/td>\n<\/tr>\n<tr>\n<td align=\"left\">delta=-1.984<\/td>\n<td align=\"left\" valign=\"top\" width=\"198\">Only displayed if std=1. The number of seconds ahead of UTC the remote system&#8217;s clock is. (UTC according to your system clock).<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<p>&nbsp;<\/p>\n<h3><a title=\"SECTION00064400000000000000\" name=\"SECTION00064400000000000000\"><\/a> ICMP Echo Fields<\/h3>\n<p>See Generic ICMP Fields section above. No additional fields are available for Echo replies.<\/p>\n<p>&nbsp;<\/p>\n<h3><a title=\"SECTION00064500000000000000\" name=\"SECTION00064500000000000000\"><\/a> ICMP Information Fields<\/h3>\n<p>See Generic ICMP Fields section above. No additional fields are available for Info replies.<\/p>\n<h1><a title=\"SECTION00070000000000000000\" name=\"SECTION00070000000000000000\"><\/a>Limitations<\/h1>\n<h2><a title=\"SECTION00071000000000000000\" name=\"SECTION00071000000000000000\"><\/a> Memory-hungry<\/h2>\n<p>Yapscan implements retries by keeping a list of hosts and ports to be scanned in memory. This has the side effect of using an awful lot of memory on large scans: 770MB for 65535 ports on 256 hosts<\/p>\n<p>This a pretty big problem. I really need to break the scan into chunks.<\/p>\n<h2><a title=\"SECTION00072000000000000000\" name=\"SECTION00072000000000000000\"><\/a> Replies from different IPs<\/h2>\n<p>If you send a packet to an address which elicits a reply from a different IP address (e.g. you ping 192.168.0.255 and get a reply from 192.168.0.5) the reply will not be reported by yapscan.<\/p>\n<p>This is because all cookies carry a &#8220;cookie&#8221; of some description which is derived from the source and destination IP of the original probe. Yapscan will inspect the reply and ensure that cookie contained within it is derived from the source and destination IP. If an unexpected IP replies yapscan will assume that the traffic is not a response to a probe.<\/p>\n<h1><a title=\"SECTION00080000000000000000\" name=\"SECTION00080000000000000000\"><\/a>Why write Yet Another Port Scanner?<\/h1>\n<p>When I started writing yapscan I wanted to:<\/p>\n<ol>\n<li>Learn some C++<\/li>\n<li>Write some generic classes that handle all the mundane parts of port scanning (like hostlist traversal, retries, bandwidth usage).<\/li>\n<\/ol>\n<p>The idea being that next time I needed to write a scanner (whether it be ARP, IPv6, DNS server-finder, mass DoS payload deliverer, etc.) I&#8217;d be able to quickly code up the probe, define how to parse responses and the generic classes would take care of the rest.<\/p>\n<p>Alas, my eyes were too big for my belly and I&#8217;ve ended up with yet another IPv4 port scanner.<\/p>\n<p>Maybe I&#8217;ll achieve my original goal someday, but as of today I&#8217;m still some way off.<\/p>\n<p>That said, I do find yapscan useful during most pentests, so I thought I&#8217;d submit it back to he community in hope that others would too.<\/p>\n<h1><a title=\"SECTION00090000000000000000\" name=\"SECTION00090000000000000000\"><\/a>Credit<\/h1>\n<p>Much inspiration (and even small amounts of code) as been drawn from other tools. It&#8217;s only right that I pay my dues&#8230;<\/p>\n<p>&nbsp;<\/p>\n<dl>\n<dt><strong>synscan<\/strong><\/dt>\n<dd><em>http:\/\/bindshell.net\/tools\/synscan<\/em>The fastest half-open portscanner that I&#8217;m aware of. I borrowed the code for determining link-layer header lengths from synscan.\u00a0<\/dd>\n<dt><strong>nmap<\/strong><\/dt>\n<dd><em>http:\/\/insecure.org\/nmap<\/em>The most reliable portscanner I&#8217;m aware of. I use nmap during every pentest. Most of yapscan&#8217;s options are designed to be intuitive for nmap users.\u00a0<\/dd>\n<dt><strong>ike-scan<\/strong><\/dt>\n<dd><em>http:\/\/www.nta-monitor.com\/tools\/ike-scan<\/em>Hostlist structures and retries are heavily inspired by ike-scan.\u00a0<\/dd>\n<dt><strong>hping2<\/strong><\/dt>\n<dd><em>http:\/\/www.hping.org<\/em>The output format is loosley based on hping2&#8217;s.\u00a0<\/dd>\n<dt><strong>scanrand<\/strong><\/dt>\n<dd><em>http:\/\/www.doxpara.com\/paketto<\/em>I love the Inverse SYN Cookies idea. Very simple method to determine if replies on the wire are meant for your scanner or some other app.\u00a0<\/dd>\n<\/dl>\n","protected":false},"excerpt":{"rendered":"<p>TCP Half-open port scanner \/ fast ICMP scanner. Some limited support for UDP scans too. It&#8217;s beta, but still kinda useful. Download Yapscan v0.7.4-beta as tar.gz. Recent changes are detailed in the CHANGELOG. Update: You&#8217;re better off using the SVN copy on google code. \u00a0It&#8217;s more up to date. MD5 and SHA1 checksums are the [&hellip;]<\/p>\n","protected":false},"author":3,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[16],"tags":[19,131,90],"_links":{"self":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/113"}],"collection":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/users\/3"}],"replies":[{"embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/comments?post=113"}],"version-history":[{"count":6,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/113\/revisions"}],"predecessor-version":[{"id":470,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/113\/revisions\/470"}],"wp:attachment":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/media?parent=113"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/categories?post=113"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/tags?post=113"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}