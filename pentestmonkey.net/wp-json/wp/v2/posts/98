{"id":98,"date":"2008-03-31T21:41:46","date_gmt":"2008-03-31T21:41:46","guid":{"rendered":"http:\/\/pentestmonkey.net\/?p=98"},"modified":"2011-08-20T15:50:27","modified_gmt":"2011-08-20T15:50:27","slug":"using-sudo-with-yaptest","status":"publish","type":"post","link":"https:\/\/pentestmonkey.net\/yaptest\/using\/using-sudo-with-yaptest","title":{"rendered":"Getting Yaptest to work with Sudo"},"content":{"rendered":"<p>When you first install yaptest and try to use sudo you might get the following error:<\/p>\n<pre>$ sudo yaptest-nmap-udp.pl<\/pre>\n<pre>ERROR: Environment variable YAPTEST_DBNAME is not set<\/pre>\n<pre>\u00a0at \/usr\/local\/lib\/site_perl\/yaptest.pm line 126<\/pre>\n<pre>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 yaptest::new('yaptest') called at \/usr\/local\/bin\/yaptest-hosts.pl line 8<\/pre>\n<pre>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 (in cleanup) Can't call method \"disconnect\" on an undefined value at \/usr\/local\/lib\/site_perl\/yaptest.pm line 3247.<\/pre>\n<p>This is because sudo has (very sensibly) unset the environment variable YAPTEST_CONFIG_FILE which in turn prevents YAPTEST_DBNAME getting set.\u00a0 The yaptest scripts no longer know which test they&#8217;re supposed to be working on.<\/p>\n<p>The solution is simple.\u00a0 Add an entry like the following into \/etc\/sudoers:<\/p>\n<pre># Allow users in group users to export specific variables<\/pre>\n<pre>Defaults:youruser \u00a0\u00a0\u00a0\u00a0 env_keep=\"DISPLAY YAPTEST_CONFIG_FILE\"<\/pre>\n<p>This prevents sudo from unsetting the YAPTEST_CONFIG_FILE (and also DISPLAY because that can be a pain too).<\/p>\n<p>&nbsp;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>When you first install yaptest and try to use sudo you might get the following error: $ sudo yaptest-nmap-udp.pl ERROR: Environment variable YAPTEST_DBNAME is not set \u00a0at \/usr\/local\/lib\/site_perl\/yaptest.pm line 126 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 yaptest::new(&#8216;yaptest&#8217;) called at \/usr\/local\/bin\/yaptest-hosts.pl line 8 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 (in cleanup) Can&#8217;t call method &#8220;disconnect&#8221; on an undefined value at \/usr\/local\/lib\/site_perl\/yaptest.pm line 3247. This is because [&hellip;]<\/p>\n","protected":false},"author":3,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[10],"tags":[93,69],"_links":{"self":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/98"}],"collection":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/users\/3"}],"replies":[{"embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/comments?post=98"}],"version-history":[{"count":1,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/98\/revisions"}],"predecessor-version":[{"id":376,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/98\/revisions\/376"}],"wp:attachment":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/media?parent=98"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/categories?post=98"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/tags?post=98"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}