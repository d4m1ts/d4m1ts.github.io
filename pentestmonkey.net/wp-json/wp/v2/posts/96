{"id":96,"date":"2008-03-30T18:09:36","date_gmt":"2008-03-30T18:09:36","guid":{"rendered":"http:\/\/pentestmonkey.net\/?p=96"},"modified":"2011-08-20T15:50:51","modified_gmt":"2011-08-20T15:50:51","slug":"interrupting-and-resuming-yaptest","status":"publish","type":"post","link":"https:\/\/pentestmonkey.net\/yaptest\/using\/interrupting-and-resuming-yaptest","title":{"rendered":"Interrupting and Resuming Scans With Yaptest"},"content":{"rendered":"<p>As of yaptest v0.0.7 it is possible to interrupt scans and resume them later without duplicating lots of the scanning you&#8217;ve already completed.\u00a0 This feature is intended primarily for multi-day pentests where you need to stop your scan at the end of each day, then resume where you left off the next morning.<\/p>\n<p>This page explains how to use the feature.<\/p>\n<p><!--more--><\/p>\n<h2>How do I run my scans so that I can resume them later?<\/h2>\n<p>Basically, you don&#8217;t need to anything special.\u00a0 As of version 0.0.7 yaptest remembers which commands it has run against which hosts and avoids running the same commands twice.<\/p>\n<p>By way of an example, say you&#8217;ve finished your TCP port scans and start running nikto:<\/p>\n<pre>$ yaptest-nikto.pl<\/pre>\n<p>&#8230; some scanning &#8230;<\/p>\n<p>Now suppose that you need to interrupt the scan.\u00a0 You hit CTRL-C and leave some nikto scans completed, some interrupted part way through and some not even started.\u00a0 You can resume your scan simply by running yaptest-nikto.pl again:<\/p>\n<pre>$ yaptest-nikto.pl<\/pre>\n<p>&#8230; some more scanning &#8230;<\/p>\n<p>Yaptest will not run nikto against anything that you successfully scanned before.\u00a0 It will only run against those web servers which had their scan interrupted or those for which the scan wasn&#8217;t even started.<\/p>\n<h2>And this works for all yaptest scripts?<\/h2>\n<p>Well, sort of.\u00a0 It works for all scripts that use the run_test API, which is the vast majority. \u00a0 The only two exceptions as of v0.0.7 are:<\/p>\n<ul>\n<li>yaptest-arp-scan-local-network.pl<\/li>\n<li>yaptest-snmpwalk.pl<\/li>\n<\/ul>\n<h2>What about if I actually WANT to re-run a test for some reason?<\/h2>\n<p>There are occasions when you might want to run a scan twice.\u00a0 One situtation is when you kick off yaptest without first configuring your IP stack properly.\u00a0 Yaptest will think that the tests concerned have finished successfully, but you know different.\u00a0 You need to make yaptest forget that certain commands have been run.<\/p>\n<p>Lets stick with the nikto example and assume that we need to rerun all of our nikto scans.\u00a0 First find out the command_id that yaptest has used to &#8220;remember&#8221; that nikto has been run.\u00a0 Yaptest-progress.pl will show you all the command_id&#8217;s:<\/p>\n<p>$ yaptest-progress.pl list<\/p>\n<p>**************************************************************************<br \/>\n*\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Starting yaptest-progress.pl\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 *<br \/>\n*\u00a0 [ Using yaptest v0.0.7 &#8211; http:\/\/pentestmonkey.net\/projects\/yaptest ]\u00a0 *<br \/>\n**************************************************************************<\/p>\n<p>command_id\u00a0\u00a0\u00a0\u00a0\u00a0 command_template<br \/>\n&#8212;&#8212;&#8212;-\u00a0\u00a0\u00a0\u00a0\u00a0 &#8212;&#8212;&#8212;&#8212;&#8212;-<br \/>\n1\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 nbtscan -b 32000 -v -f ::IPFILE::<br \/>\n2\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 nice nmap -sU -P0 -n -O -v -oA nmap-udp-::IP::.out ::IP::<br \/>\n3\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 nbtscan -h -b 32000 -v -f ::IPFILE::<br \/>\n4\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ike-scan -f ::IPFILE::<br \/>\n5\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 yapscan -sI -r 5 -i vmnet8 -b 200000 -t &#8211; -f ::IPFILE::<br \/>\n6\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 onesixtyone -c \/home\/x\/tools\/dictionaries\/snmp-communities.txt -i ::IPFILE::<br \/>\n7\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 sudo nmap -sO -P0 -n -v -oA nmap-ip-protocols-::IP::.out ::IP::<br \/>\n8\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 amap -u -b ::IP:: ::PORTLIST-SPACE::<br \/>\n9\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 yapscan -sS -r 2 -i vmnet8 -b 1000000 -P known -f ::IPFILE::<br \/>\n10\u00a0\u00a0\u00a0\u00a0\u00a0 rpcinfo -p ::IP::<br \/>\n11\u00a0\u00a0\u00a0\u00a0\u00a0 showmount -e ::IP::<br \/>\n12\u00a0\u00a0\u00a0\u00a0\u00a0 showmount -a ::IP::<br \/>\n13\u00a0\u00a0\u00a0\u00a0\u00a0 rup -d ::IP::<br \/>\n14\u00a0\u00a0\u00a0\u00a0\u00a0 rusers -l ::IP::<br \/>\n15\u00a0\u00a0\u00a0\u00a0\u00a0 nxscan ::IP::<br \/>\n16\u00a0\u00a0\u00a0\u00a0\u00a0 nmap -sS -P0 -n -O -v -A &#8211;version-all -oA nmap-tcp-::IP::.out -p ::PORTLIST:: ::IP::<br \/>\n17\u00a0\u00a0\u00a0\u00a0\u00a0 bannergrab ::IP:: ::PORT::<br \/>\n18\u00a0\u00a0\u00a0\u00a0\u00a0 amap -b ::IP:: ::PORTLIST-SPACE::<br \/>\n19\u00a0\u00a0\u00a0\u00a0\u00a0 nikto.pl -nolookup 127.0.0.1 -h ::IP:: -p ::PORT::<br \/>\n20\u00a0\u00a0\u00a0\u00a0\u00a0 dcetest ::IP::<br \/>\n&#8230;<\/p>\n<p>We can see the nikto command towards the end of the output above with command_id 19.\u00a0 Now we&#8217;ll use this id to delete some entries form yaptest&#8217;s progress table to make it forget that it&#8217;s run nikto before:<\/p>\n<pre>$ yaptest-progress.pl reset 19<\/pre>\n<p>That&#8217;s it.\u00a0 Next time your rerun yaptest-nikto.pl, it&#8217;ll scan all web server because yaptest has forgotten that it scanned them.<\/p>\n<h2>What it I only want to re-run part of a test, not all of it?<\/h2>\n<p>There are some options you can pass to yaptest-progress.pl if you only want to rescan some hosts, but not all.\u00a0 Here are some examples:<\/p>\n<pre>$ yaptest-progress.pl reset 19 -i 10.0.0.1<\/pre>\n<pre>$ yaptest-progress.pl reset 19 -i 10.0.0.1 -p 8000\r\n\r\n$ yaptest-progress.pl reset 19 -p 8000<\/pre>\n<pre><\/pre>\n<p>&nbsp;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>As of yaptest v0.0.7 it is possible to interrupt scans and resume them later without duplicating lots of the scanning you&#8217;ve already completed.\u00a0 This feature is intended primarily for multi-day pentests where you need to stop your scan at the end of each day, then resume where you left off the next morning. This page [&hellip;]<\/p>\n","protected":false},"author":3,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[10],"tags":[69],"_links":{"self":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/96"}],"collection":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/users\/3"}],"replies":[{"embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/comments?post=96"}],"version-history":[{"count":1,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/96\/revisions"}],"predecessor-version":[{"id":379,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/posts\/96\/revisions\/379"}],"wp:attachment":[{"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/media?parent=96"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/categories?post=96"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/pentestmonkey.net\/wp-json\/wp\/v2\/tags?post=96"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}