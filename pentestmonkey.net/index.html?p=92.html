<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Yaptest User Guide | pentestmonkey</title>
<link rel="stylesheet" href="wp-content/themes/baza-noclegowa/style.css" type="text/css" media="screen" />
<link rel="pingback" href="https://pentestmonkey.net/xmlrpc.php" />
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='https://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="pentestmonkey &raquo; Feed" href="feed" />
<link rel="alternate" type="application/rss+xml" title="pentestmonkey &raquo; Comments Feed" href="comments/feed" />
<link rel="alternate" type="application/rss+xml" title="pentestmonkey &raquo; Yaptest User Guide Comments Feed" href="yaptest/using/yaptest-user-guide/feed" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/pentestmonkey.net\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.8.3"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='wp-includes/css/dist/block-library/style.min.css%3Fver=5.8.3.css' type='text/css' media='all' />
<link rel="https://api.w.org/" href="wp-json/index.html" /><link rel="alternate" type="application/json" href="wp-json/wp/v2/posts/92" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="xmlrpc.php%3Frsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="wp-includes/wlwmanifest.xml" /> 
<link rel="canonical" href="projects/yaptest/yaptest-user-guide/index.html" />
<link rel='shortlink' href='index.html%3Fp=92.html' />
<link rel="alternate" type="application/json+oembed" href="wp-json/oembed/1.0/embed%3Furl=https:%252F%252Fpentestmonkey.net%252Fyaptest%252Fusing%252Fyaptest-user-guide" />
<link rel="alternate" type="text/xml+oembed" href="wp-json/oembed/1.0/embed%3Furl=https:%252F%252Fpentestmonkey.net%252Fyaptest%252Fusing%252Fyaptest-user-guide&amp;format=xml" />
	
<!--[if IE 6]><script src="https://pentestmonkey.net/wp-content/themes/baza-noclegowa/js/DD_belatedPNG.js"></script><![endif]-->
</head>
<body class="post-template-default single single-post postid-92 single-format-standard">
	<div class="all-page">
		
		<div class="container">
			
			<!-- HEADER -->
			<div id="header">
			    <div class="website-name"><a href="index.html">pentestmonkey</a></div>
				<div class="slogan">Taking the monkey work out of pentesting</div>
			</div>
			<div class="clear"></div>
			<!-- /HEADER -->

			<!-- main NAVIGATION -->
			<div id="mainNav">
				<div class="wrap">
    <ul id="menu-cheat-sheets" class="menu"><li id="menu-item-133" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-133"><a href="category/site-news.html"><span>Site News</span></a></li>
<li id="menu-item-130" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-130"><a href="category/blog/index.html"><span>Blog</span></a></li>
<li id="menu-item-136" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-136"><a href="category/tools/index.html"><span>Tools</span></a></li>
<li id="menu-item-137" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-137"><a href="category/yaptest/index.html"><span>Yaptest</span></a></li>
<li id="menu-item-134" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-134"><a href="category/cheat-sheet.html"><span>Cheat Sheets</span></a></li>
<li id="menu-item-135" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-135"><a href="category/contact.html"><span>Contact</span></a></li>
</ul>    <div class="clear"><!-- --></div>
				</div>
			</div>
			<!-- /main NAVIGATION -->
			<div class="clear"></div>


			<!-- CONTENT -->
			<div id="content">
	<!-- Start: Left Panel -->
	<div class="content">

	
		<div class="post-92 post type-post status-publish format-standard hentry category-using tag-yaptest-2" id="post-92">
			<h1>Yaptest User Guide</h1>

			<div class="entryContent">
				<p>Some notes on how to actually use yaptest&#8230;<br />
<span id="more-92"></span></p>
<p>This page covers how to setup a new test using yaptest and run some supported tools to begin a pentest.  Also see the <a href="yaptest/projects/yaptest/yaptest-installation.html">Installation page</a> .</p>
<h3>Assumptions</h3>
<p>This guide assumes you&#8217;re using Linux and have PostgreSQL installed locally and that the database server allows you to connect as any user without a password (the default on gentoo).</p>
<p>Disclaimer: This configuration is bad from a security perspective unless:</p>
<ul>
<li>PostgreSQL is bound to the loopback interface only or accessed via unix domain sockets; AND</li>
<li>You&#8217;re the only person allowed to log into the database server</li>
</ul>
<p>It is also assumed that:</p>
<ul>
<li>yaptest has been successfully <a href="yaptest/projects/yaptest/yaptest-installation.html">installed</a>.</li>
<li>You are using BASH as your shell.</li>
</ul>
<h3>Starting a New Test</h3>
<p>First start the postgresql backend.  The command is normally something like:</p>
<pre># /etc/init.d/postgresql start</pre>
<p>Use yaptest-wizard.pl to create a new database and a new directory to hold all your test data.  This design is used to avoid mixing data from two clients either at the file-system level or at the database-level.  If you don&#8217;t like interactive wizards use the tools yaptest-new-db.pl and yaptest-new-test-area.pl instead.</p>
<pre>$ yaptest-wizard.pl

**************************************************************************
*                       Starting yaptest-wizard.pl                       *
*  [ Using yaptest v0.0.7 - http://pentestmonkey.net/projects/yaptest ]  *
**************************************************************************

                    __  __            __            __
                     / /___ _____  / /____  _____/ /_
                       / __ `/ __ / __/ _ / ___/ __/
                     / / /_/ / /_/ / /_/  __(__  ) /_
                    /_/__,_/ .___/__/___/____/__/
                           /_/
                Doing the tedious bits so you don't have to

    THIS WIZARD CURRENLTY ONLY DEALS WITH THE CREATION OF NEW DATABASES
                               AND TEST AREAS
=========================================================================
Database Configuration

You are currenlty not configured to use a database.

Options:
  1: Create a new database
  q: Quit

NB: If you previously created a database and want to use it,
    quit, change to the corresponding directory,
    'source env.sh', then re-run this wizard.

Enter option (1, q):</pre>
<p>Select 1 to create a new database.  Give it a name like &#8220;abc_company&#8221;.  This is also used for a directory which should be used to store all your tool output.</p>
<pre>Enter option (1, q): 1</pre>
<pre>-------------------------------------------------------------------------
=========================================================================
Create New Database</pre>
<pre>Enter a name for the new database.  A subdirectory of the same name will
be created at the same time.</pre>
<pre>Current Directory: /home/u
Enter name for new yaptest database (or CTRL-C to quit): abc_company
-------------------------------------------------------------------------
Database name: abc_company
Creating directory 'abc_company'...done
Creating database 'abc_company'
Config file: /home/u/abc_company/yaptest.conf
Writing to config file /home/u/abc_company/yaptest.conf
Creating file env.sh
Restarting wizard with new configuration</pre>
<pre>...
=========================================================================
Database Configuration
You are currently configured to use:
  Database:    abc_company
  Test Dir:    /home/u/abc_company
The following test areas exist in this database:
  &lt;none&gt;
Options:
  1: Create a new test area in above database
  2: Create a new database
  q: Quit</pre>
<pre>NB: If you previously created different database and want
    to use it, quit, change to the corresponding directory,
    'source env.sh', then re-run this wizard.
Enter option (1, 2, q):</pre>
<p>Next you&#8217;ll need to create at least on test area.  In this context a &#8220;test area&#8221; is a pair of location-of-pentest-lappy and target-network.  The following example test areas illustrate the meaning of &#8220;test area&#8221;:</p>
<ul>
<li>Test area &#8220;inet_to_us_gw&#8221; could mean testing over the Internet towards your client&#8217;s United State gateway</li>
<li>Test area &#8220;vlan123_local&#8221; could mean connecting to VLAN123 and testing the local hosts on that segment</li>
<li>Test area &#8220;userlan_to_dmz&#8221; could mean connecting to the Internal network and scanning the DMZ</li>
</ul>
<p>The larger the pentest, the more important it is that you choose sensible names.  For small tests, anything will do.  We&#8217;ll go with &#8220;external&#8221;:</p>
<pre>Enter option (1, 2, q): 1</pre>
<pre>-------------------------------------------------------------------------
=========================================================================
Create New Test Area
To create a new test area (internal, vlan100, network123, etc.) enter the
test area name below.  A directory of the name name will be created at
same time.</pre>
<pre>Current Directory: /home/u/abc_company
Enter name for new test area (or CTRL-C to quit): external
-------------------------------------------------------------------------
Database name: external
Creating directory 'external'...done
Creating test area 'external'
Writing to config file yaptest.conf
Creating file env.sh
-------------------------------------------------------------------------
=========================================================================
Now quit the wizard with q:
Enter option (1, 2, q): q
-------------------------------------------------------------------------
IMPORTANT: To use your newly created test areas you must first:
           $ cd abc_company/yourtestarea
           $ source env.sh</pre>
<p>Follow the &#8220;important&#8221; instructions above:</p>
<pre>$ cd abc_company/
$ cd external/
$ source env.sh</pre>
<p>Any yaptest scripts you run will now:</p>
<ul>
<li>Know which database to use</li>
<li>Know which test area you&#8217;re currently assessing</li>
<li>Save scan data to the correct directory</li>
</ul>
<p>NB: If you forget to &#8220;source env.sh&#8221; all the yaptest script will throw an error like:</p>
<pre>ERROR: Environment variable YAPTEST_DBNAME is not set...</pre>
<p>You can create new test areas later on using the wizard.  To view a list of test areas either use the wizard or the command:</p>
<pre>$ yaptest-test-areas.pl query</pre>
<p>In the next section we&#8217;ll do some scanning.  Once you&#8217;ve finished a test area and need to move to the next one it&#8217;s important that you move to the corresponding directory and &#8220;source&#8221; the env.sh file:</p>
<pre>$ cd ../external_gw2</pre>
<pre>$ source env.sh</pre>
<h3>Doing some scanning</h3>
<p>For this section we&#8217;ll assume that we&#8217;re testing the local network segment so we can demonstrate the use of ARP for host-discovery.</p>
<p>The first thing you&#8217;d normally do when running yaptest is to add all the IP addresses you want to test into the backend database.  First we need to find a list of live hosts.</p>
<p>We need to be root to run <a href="http://www.nta-monitor.com/tools/arp-scan/">arp-scan</a> , so the use of sudo is recommended.  However if you can&#8217;t be bothered <a href="projects/yaptest/using-sudo-with-yaptest/index.html">configuring sudo</a> to preserve the right parts of your environment do this:</p>
<pre>$ su</pre>
<pre># pwd</pre>
<pre>/home/u/abc_company/vlan1</pre>
<pre># source env.sh</pre>
<p>Check that yaptest knows the correct network interface to use. And set it if not. The help message describes how to do this:</p>
<pre># yaptest-arp-scan-local-network.pl --help

Usage: yaptest-arp-scan-local-network.pl
ARP scans the local network.

This script needs to know the Network Interface to use.  This
is found from the 'yaptest_interface' config option:
$ yaptest-config.pl query yaptest_interface
$ yaptest-config.pl set yaptest_interface eth0

NB: This script relies on arp-scan being in the path</pre>
<p>Start the scan&#8230;</p>
<pre># yaptest-arp-scan-local-network.pl
[PID 936] ------------------ Yaptest "run_test" executing command ... ---------------------
[PID 936] Command ............. arp-scan -r 2 -I vmnet1 -l
[PID 936] Output File ......... arp-scan.out.2
[PID 936] ---------------------------------------------------------------------------------
[PID 936] Interface: vmnet1, datalink type: EN10MB (Ethernet)
[PID 936] Starting arp-scan 1.5 with 256 hosts (http://www.nta-monitor.com/tools/arp-scan/)
[PID 936] 172.16.16.4   00:0c:29:f3:6b:a8       VMware, Inc.
[PID 936] 172.16.16.5   00:0c:29:09:8d:2e       VMware, Inc.
[PID 936] 172.16.16.6   00:0c:29:31:dc:1b       VMware, Inc.
[PID 936] 172.16.16.7   00:0c:29:3d:85:01       VMware, Inc.
[PID 936] 172.16.16.8   00:0c:29:8b:2d:e3       VMware, Inc.
[PID 936] 172.16.16.9   00:0c:29:f7:de:4e       VMware, Inc.
[PID 936] 172.16.16.10  00:0c:29:d6:64:c3       VMware, Inc.
[PID 936] 172.16.16.254 00:50:56:ea:9d:d8       VMWare, Inc.
[PID 936]
[PID 936] 8 packets received by filter, 0 packets dropped by kernel
[PID 936] Ending arp-scan 1.5: 256 hosts scanned in 1.283 seconds (199.53 hosts/sec).  8 responded</pre>
<p>Note that if you run this command twice a different output file will be used to avoid clobbering the first.</p>
<p>The output from arp-scan will be automatically parsed by yaptest-parse-arp-scan.pl (as of yaptest 0.0.7).  If for any reason you need to parse the output of an old arp-scan, you can do this manually:</p>
<pre># yaptest-parse-arp-scan.pl arp-scan.out.2

**************************************************************************
*                   Starting yaptest-parse-arp-scan.pl                   *
*  [ Using yaptest v0.0.4 - http://pentestmonkey.net/projects/yaptest ]  *
**************************************************************************

Processing arp-scan.out.2...
Interface: vmnet1, datalink type: EN10MB (Ethernet)
Starting arp-scan 1.5 with 256 hosts (http://www.nta-monitor.com/tools/arp-scan/)
172.16.16.4     00:0c:29:f3:6b:a8       VMware, Inc.
PARSED: IP=172.16.16.4, MAC=00:0c:29:f3:6b:a8, DESC=VMware, Inc.
172.16.16.5     00:0c:29:09:8d:2e       VMware, Inc.
PARSED: IP=172.16.16.5, MAC=00:0c:29:09:8d:2e, DESC=VMware, Inc.
172.16.16.6     00:0c:29:31:dc:1b       VMware, Inc.
PARSED: IP=172.16.16.6, MAC=00:0c:29:31:dc:1b, DESC=VMware, Inc.
...</pre>
<p>Once this is done, our backend database will be populated with a list of hosts to scan.</p>
<pre># yaptest-hosts.pl query
vlan1  172.16.16.4     null    null
vlan1  172.16.16.5     null    null
vlan1  172.16.16.6     null    null
vlan1  172.16.16.7     null    null
vlan1  172.16.16.8     null    null
vlan1  172.16.16.9     null    null
vlan1  172.16.16.10    null    null
vlan1  172.16.16.254   null    null
Total records: 8</pre>
<p>You can remove any hosts that you don&#8217;t want scanned:</p>
<pre># yaptest-hosts.pl delete -i 172.16.16.254</pre>
<pre>Deleting 172.16.16.254</pre>
<pre># yaptest-hosts.pl query
vlan1  172.16.16.4     null    null
vlan1  172.16.16.5     null    null
vlan1  172.16.16.6     null    null
vlan1  172.16.16.7     null    null
vlan1  172.16.16.8     null    null
vlan1  172.16.16.9     null    null
vlan1  172.16.16.10    null    null
Total records: 7</pre>
<p>The other tools can then draw on this information to perform further testing.  Note that you can also add a list of hosts to scan using the script yaptest-hosts.pl (for those occassions when ARP scanning isn&#8217;t appropriate).</p>
<pre># yaptest-hosts.pl add -f ips.txt</pre>
<p>At this point, you&#8217;d probably just run yaptest-db-ips.sh to run a whole load of different pre-configured tests.  However, for the purposes of this tutorial, we&#8217;ll run some of the commands from yaptest-db-ips.sh manually.</p>
<p>Fisrt we&#8217;ll do a TCP portscan using <a href="tools/yapscan/index.html">yapscan</a> .  The following script connects to the database to find which hosts it needs to scan:</p>
<pre># yaptest-yapscan-tcp.pl</pre>
<pre>[PID 1057] ------------------ Yaptest "run_test" executing command ... ---------------------
[PID 1057] Command ............. yapscan -sS -r 2 -i vmnet1 -b 1000000 -P all -f yaptest-ips-0YZ4x
[PID 1057] Output File ......... yapscan-tcp.out.2
[PID 1057] ---------------------------------------------------------------------------------
[PID 1057] Starting Yapscan v0.7.1-beta ( http://pentestmonkey.net/tools/yapscan )
[PID 1057]
[PID 1057]  ----------------------------------------------------------
[PID 1057] |                   Scan Information                       |
[PID 1057]  ----------------------------------------------------------
[PID 1057] Scan type: ......... TCP
[PID 1057] IPs File: .......... yaptest-ips-0YZ4x
[PID 1057] Interface: ......... vmnet1
[PID 1057] Bandwidth limit: ... 1000000 bits/sec
[PID 1057] Source address: .... 172.16.16.1
[PID 1057] RTT: ............... 0.950000 secs
[PID 1057] Retries: ........... 2
[PID 1057] Max Memory: ........ 150000 KBytes (Scanning up to 36 hosts at once)
[PID 1057] Port file: ......... all
[PID 1057] Port count: ........ 65535
[PID 1057] Show closed ports .. off
[PID 1057]
[PID 1057] ####### Scan of first 7 hosts started at 2007-07-28 13:04:50 +0000 #########
[PID 1057] 172.16.16.5:7        echo    Len=44 TTL=128 IPID=19039 FLAGS=SA______ SEQ=0xfca78ae9 ACK=0xf37388f7 WIN=64240
[PID 1057] 172.16.16.5:9        discard Len=44 TTL=128 IPID=19040 FLAGS=SA______ SEQ=0xfca860e6 ACK=0x76bb1a85 WIN=64240
[PID 1057] 172.16.16.7:7        echo    Len=44 TTL=255 IPID=47493 FLAGS=SA______ SEQ=0x0c7efba5 ACK=0x6058dc5d WIN=9112
...</pre>
<p>Again the output from yapscan will be automatically parsed (as of 0.0.7) and a list of open ports saved in the backend database.  This information is used later by other tools.  If you want to parse the output of an old yapscan manually you can use yaptest-parse-yapscan.pl.</p>
<p>Use the yaptest-ports.pl command to list the open ports in the backend database.  Output is tab-delimited for each cutting and grepping:</p>
<pre># yaptest-ports.pl query
vlan1  172.16.16.4     21      TCP
vlan1  172.16.16.4     25      TCP
vlan1  172.16.16.4     80      TCP
vlan1  172.16.16.4     119     TCP
vlan1  172.16.16.4     135     TCP
...</pre>
<p>The help message describes the various other type of queries you can make about open ports:</p>
<pre>yaptest-ports.pl

**************************************************************************
*                       Starting yaptest-ports.pl                        *
*  [ Using yaptest v0.0.7 - http://pentestmonkey.net/projects/yaptest ]  *
**************************************************************************

Usage: yaptest-ports.pl query [ options ]
Lists open ports found

Options are:
        -i ip          IP to search for
        -p port        Port to search for
        -t test_area   Test area to search for
        -r string      String to search for in 'rpcinfo -p' output (e.g. 'sadmind')
        -s string      String to search for in nmap service string (e.g. 'http')
        -v string      String to search for in nmap version string (e.g. 'Apache')</pre>
<p>Here are some examples:</p>
<pre>$ yaptest-ports.pl query -p 23 | cut -f 2 &gt; telnet-ips.txt</pre>
<pre>$ yaptest-ports.pl query -r sadmind | cut -f 2 &gt; sadmind-ips.txt</pre>
<p>Other commands you can run that will operate on all hosts include:</p>
<ul>
<li>yaptest-nmap-udp.pl (parse with yaptest-parse-nmap-xml.pl)</li>
<li>yaptest-onesixtyone.pl (parse with yaptest-parse-onesixtyone.pl)</li>
<li>yaptest-nbtscan.pl</li>
<li>yaptest-yapscan-icmp.pl (parse with yaptest-parse-yapscan-icmp.pl)</li>
</ul>
<h3>Testing some of the open ports</h3>
<p>Now we&#8217;ll run nmap on all the open TCP ports so it can do it&#8217;s banner grabbing and service-identification magic.  In this next example, up to 5 nmap processes are run in parallel.  The output of these processes gets intermingled, but the individual output files will still make sense.</p>
<p><span style="font-size: xx-small;"># yaptest-nmap-tcp.pl [PID 22469] &#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212; Yaptest Running Command &#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;- [PID 22469] Command &#8230;&#8230;&#8230;&#8230;. nmap -sS -P0 -n -O -v -A -oA nmap-tcp-10.10.0.243.out.22467 -p 111,21,22,23,25,32774,32775,32776,32777,32778,32780,32782,32784,32785,32786,32790, 32791,32792,32793,32794,32861,4045,513,514,587,5987,5988,7100,79,80,898,9010 10.10.0.243 [PID 22469] Output File &#8230;&#8230;&#8230; nmap-tcp-10.10.0.243.out.3 [PID 22469] &#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211; [PID 22471] &#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212; Yaptest Running Command &#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;- [PID 22471] Command &#8230;&#8230;&#8230;&#8230;. nmap -sS -P0 -n -O -v -A -oA nmap-tcp-10.10.0.127.out.22467 -p 443 10.10.0.127 [PID 22471] Output File &#8230;&#8230;&#8230; nmap-tcp-10.10.0.127.out.2 [PID 22471] &#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211; [PID 22471] [PID 22471] Starting Nmap 4.20 ( http://insecure.org ) at 2007-06-30 21:27 BST [PID 22471] Initiating ARP Ping Scan at 21:27 &#8230; </span></p>
<p>The output can be parsed into the database as follows (you still need to do this manually as of v0.0.7):</p>
<pre>$ yaptest-parse-nmap-xml.pl *.xml
Processing nmap-tcp-172.16.16.10.out.31962.xml...
IP: 172.16.16.10
PARSED: 172.16.16.10: echo (7/tcp) open
PARSED: 172.16.16.10: discard (9/tcp) open
PARSED: 172.16.16.10: daytime (13/tcp) open Sun Solaris daytime
PARSED: 172.16.16.10: chargen (19/tcp) open
PARSED: 172.16.16.10: ftp (21/tcp) open Solaris ftpd
PARSED: 172.16.16.10: telnet (23/tcp) open BSD-derived telnetd
PARSED: 172.16.16.10: smtp (25/tcp) open Sendmail 8.12.11+Sun/8.12.11
PARSED: 172.16.16.10: time (37/tcp) open   (32 bits)</pre>
<p>Now we run nikto on all of the HTTP and HTTPS services identified by nmap:</p>
<pre>$ yaptest-nikto.pl
Targets for this test are:
172.16.16.4     80
172.16.16.4     4066
172.16.16.5     80
172.16.16.5     9170
172.16.16.6     80
172.16.16.6     7140
172.16.16.6     8099
172.16.16.9     898
172.16.16.9     5988
Total records: 9

[PID 1130] ------------------ Yaptest "run_test" executing command ... ---------------------
[PID 1130] Command ............. nikto.pl -nolookup 127.0.0.1 -h 172.16.16.4 -p 80
[PID 1130] Output File ......... nikto.pl-172.16.16.4-80.out
[PID 1130] Inactivity Timeout .. 300
[PID 1130] ---------------------------------------------------------------------------------
...</pre>
<p>Other simple tests based on open ports include:</p>
<ul>
<li>yaptest-rpcinfo.pl</li>
<li>yaptest-dcetest.pl</li>
<li>yaptest-ntp.pl</li>
<li>yaptest-telnet-fuser.pl</li>
<li>yaptest-nxscan.pl</li>
</ul>
<p>Check out yaptest-db-ips.sh for a more complete list.  This will run pretty much all the tools yaptest support in the appropriate order.</p>
<h3>Testing some RPC services</h3>
<p>You can parse the output of rpcinfo like this:</p>
<pre>$ yaptest-parse-rpcinfo.pl rpcinfo-*</pre>
<p>The following tests are based on the output of rpcinfo, so yaptest-rcpinfo.pl must be run first:</p>
<ul>
<li>yaptest-rusers.pl</li>
<li>yaptest-rup.pl</li>
<li>yaptest-nfs.pl</li>
</ul>
<h3>Password guessing</h3>
<p>The following scripts can be used to kick off password guessing against any of the supported protocols.  You&#8217;ll need to tell yaptest where your dictionary files are kept first.  The help message wille explain how to do this.</p>
<ul>
<li>yaptest-password-guess-ftp.pl</li>
<li>yaptest-password-guess-mssql.pl</li>
<li>yaptest-password-guess-rlogin.pl</li>
<li>yaptest-password-guess-smb.pl</li>
<li>yaptest-password-guess-ssh.pl</li>
</ul>
<h3>Other Yaptest-related stuff</h3>
<p>If you want to run nessus, yaptest can give a list of ports that are open on the network (both UDP and TCP).  The format is suitable for copy and pasting into most nessus clients:</p>
<pre>$ yaptest-get-all-open-ports.pl
21,22,23,25,79,80,111,443,513,514,587,898,4045,5987,5988,7100,9010,32774,32775,32776,32777,32778,32780,32782,32784, 32785,32786,32790,32791,32792,32793,32794,32861</pre>
<h3>One script to run it all</h3>
<p>After the database has been populated with the IPs you want to test, the following shell script can be used to start off most of the supported tests on targets in the database:</p>
<p># yaptest-db-ips.sh</p>
<p>Yaptest can also keep track of value usernames, password and password hashes that you&#8217;ve collected.  See <a href="yaptest/projects/yaptest/yaptest-password-management.html">Managing Login Credentials with Yaptest</a> for more information.</p>
<p>&nbsp;</p>
<pre></pre>
                <div class="clear"></div>
								<p class="postmeta"><span class="tags"><a href="tag/yaptest-2/index.html" rel="tag">yaptest</a></span></p>				<p class="postmeta"><span class="cats"><a href="category/yaptest/using.html" rel="category tag">Using</a></span></p>
								
			<p></p>
		
			<div class="navigation2">
				<div class="alignright prev"><a href="projects/yaptest/yaptest-faq/index.html" rel="prev">Yaptest FAQs</a></div>
				<div class="alignleft next"><a href="index.html%3Fp=17.html" rel="next">Minor update: Yapscan v0.7.2</a></div>
			</div>		

			</div>
		</div>

	
<!-- You can start editing here. -->


			<!-- If comments are open, but there are no comments. -->

	 
<p></p>
<br />


	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="projects/yaptest/yaptest-user-guide/index.html#respond" style="display:none;">Cancel reply</a></small></h3><p class="must-log-in">You must be <a href="https://pentestmonkey.net/wp-login.php?redirect_to=https%3A%2F%2Fpentestmonkey.net%2Fyaptest%2Fusing%2Fyaptest-user-guide">logged in</a> to post a comment.</p>	</div><!-- #respond -->
	




	
	</div>
				<!-- sidebar -->
				<div class="sideBar">
					
					<div class="nav">
						<div class="bFrameT"><i></i></div>
	<form method="get" id="searchform" action="index.html" class="searchForm">
	<p><input type="text" value="" name="s" id="s" class="field" />
	<input type="image" src="wp-content/themes/baza-noclegowa/images/search.gif" alt="" title="Search" id="searchsubmit" class="btn" /></p>
</form>
<h3><span>Categories</span></h3>
			<ul>
					<li class="cat-item cat-item-5"><a href="category/blog/index.html">Blog</a> (78)
</li>
	<li class="cat-item cat-item-39"><a href="category/cheat-sheet.html">Cheat Sheets</a> (10)
<ul class='children'>
	<li class="cat-item cat-item-40"><a href="category/cheat-sheet/shells.html">Shells</a> (1)
</li>
	<li class="cat-item cat-item-8"><a href="category/cheat-sheet/sql-injection.html">SQL Injection</a> (7)
</li>
</ul>
</li>
	<li class="cat-item cat-item-7"><a href="category/contact.html">Contact</a> (2)
</li>
	<li class="cat-item cat-item-3"><a href="category/site-news.html">Site News</a> (3)
</li>
	<li class="cat-item cat-item-4"><a href="category/tools/index.html">Tools</a> (17)
<ul class='children'>
	<li class="cat-item cat-item-14"><a href="category/tools/audit.html">Audit</a> (3)
</li>
	<li class="cat-item cat-item-16"><a href="category/tools/misc.html">Misc</a> (7)
</li>
	<li class="cat-item cat-item-13"><a href="category/tools/user-enumeration.html">User Enumeration</a> (4)
</li>
	<li class="cat-item cat-item-15"><a href="category/tools/web-shells.html">Web Shells</a> (3)
</li>
</ul>
</li>
	<li class="cat-item cat-item-1"><a href="category/uncategorized.html">Uncategorized</a> (3)
</li>
	<li class="cat-item cat-item-6"><a href="category/yaptest/index.html">Yaptest</a> (15)
<ul class='children'>
	<li class="cat-item cat-item-12"><a href="category/yaptest/front-end.html">Front End</a> (1)
</li>
	<li class="cat-item cat-item-9"><a href="category/yaptest/installing.html">Installing</a> (2)
</li>
	<li class="cat-item cat-item-11"><a href="category/yaptest/overview.html">Overview</a> (2)
</li>
	<li class="cat-item cat-item-10"><a href="category/yaptest/using.html">Using</a> (8)
</li>
</ul>
</li>
			</ul>

						
						<div class="bFrameB"><i></i></div>
					</div>
					
				</div>
				<!-- /sidebar -->	
				</div>
				<!-- /content -->
				
			</div>
			<!-- /CONTENT -->	
			
		
		<!-- bottom NAVIGATION -->
		<div id="bottomNav">
		</div>
		<!-- /bottom NAVIGATION -->
		
		<!-- FOOTER -->
		<div id="footer">
		<p class="footer-menu">
         <ul class="menu"></ul>        </p>
			
<div class="credits">Powered by <a href="http://wordpress.org/">WordPress</a>. Design: <a href="http://www.baza-noclegowa.pl/">Baza Noclegowa</a>.</div>
			
		</div>
		<!-- /FOOTER -->
	</div>
		<script type='text/javascript' src='wp-includes/js/wp-embed.min.js%3Fver=5.8.3' id='wp-embed-js'></script>
</body>
</html>
