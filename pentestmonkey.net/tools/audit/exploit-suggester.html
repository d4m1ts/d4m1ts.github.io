<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>exploit-suggester | pentestmonkey</title>
<link rel="stylesheet" href="../../wp-content/themes/baza-noclegowa/style.css" type="text/css" media="screen" />
<link rel="pingback" href="https://pentestmonkey.net/xmlrpc.php" />
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='https://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="pentestmonkey &raquo; Feed" href="../../feed" />
<link rel="alternate" type="application/rss+xml" title="pentestmonkey &raquo; Comments Feed" href="../../comments/feed" />
<link rel="alternate" type="application/rss+xml" title="pentestmonkey &raquo; exploit-suggester Comments Feed" href="exploit-suggester/feed" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/pentestmonkey.net\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.8.3"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='../../wp-includes/css/dist/block-library/style.min.css%3Fver=5.8.3.css' type='text/css' media='all' />
<link rel="https://api.w.org/" href="../../wp-json/index.html" /><link rel="alternate" type="application/json" href="../../wp-json/wp/v2/posts/108" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc.php%3Frsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../wp-includes/wlwmanifest.xml" /> 
<link rel="canonical" href="../../index.html%3Fp=108.html" />
<link rel='shortlink' href='../../index.html%3Fp=108.html' />
<link rel="alternate" type="application/json+oembed" href="../../wp-json/oembed/1.0/embed%3Furl=https:%252F%252Fpentestmonkey.net%252Ftools%252Faudit%252Fexploit-suggester" />
<link rel="alternate" type="text/xml+oembed" href="../../wp-json/oembed/1.0/embed%3Furl=https:%252F%252Fpentestmonkey.net%252Ftools%252Faudit%252Fexploit-suggester&amp;format=xml" />
	
<!--[if IE 6]><script src="https://pentestmonkey.net/wp-content/themes/baza-noclegowa/js/DD_belatedPNG.js"></script><![endif]-->
</head>
<body class="post-template-default single single-post postid-108 single-format-standard">
	<div class="all-page">
		
		<div class="container">
			
			<!-- HEADER -->
			<div id="header">
			    <div class="website-name"><a href="../../index.html">pentestmonkey</a></div>
				<div class="slogan">Taking the monkey work out of pentesting</div>
			</div>
			<div class="clear"></div>
			<!-- /HEADER -->

			<!-- main NAVIGATION -->
			<div id="mainNav">
				<div class="wrap">
    <ul id="menu-cheat-sheets" class="menu"><li id="menu-item-133" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-133"><a href="../../category/site-news.html"><span>Site News</span></a></li>
<li id="menu-item-130" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-130"><a href="../../category/blog/index.html"><span>Blog</span></a></li>
<li id="menu-item-136" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-136"><a href="../../category/tools/index.html"><span>Tools</span></a></li>
<li id="menu-item-137" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-137"><a href="../../category/yaptest/index.html"><span>Yaptest</span></a></li>
<li id="menu-item-134" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-134"><a href="../../category/cheat-sheet.html"><span>Cheat Sheets</span></a></li>
<li id="menu-item-135" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-135"><a href="../../category/contact.html"><span>Contact</span></a></li>
</ul>    <div class="clear"><!-- --></div>
				</div>
			</div>
			<!-- /main NAVIGATION -->
			<div class="clear"></div>


			<!-- CONTENT -->
			<div id="content">
	<!-- Start: Left Panel -->
	<div class="content">

	
		<div class="post-108 post type-post status-publish format-standard hentry category-audit tag-exploitsuggester tag-pentest tag-tool" id="post-108">
			<h1>exploit-suggester</h1>

			<div class="entryContent">
				<p>This tool reads the output of &#8220;showrev -p&#8221; on Solaris machines and outputs a list of exploits that you might want to try.  It currently focusses on local exploitation of Solaris 8 on SPARC, but other version of Solaris are partially supported.</p>
<h3>Features</h3>
<p>The current version of exploit-suggester has the following features:</p>
<ul>
<li>Restrict search to only remote exploits (or local) using the -l option.</li>
<li>Perfom the search remotely &#8211; no need to upload exploit-suggester to target system.</li>
<li>Restrict search by rating so you can show only exploits that are likely to succeed (-r / -R options).</li>
<li>Displays URL for further reading and exploit download.</li>
</ul>
<h3>Download</h3>
<p><a href="../exploit-suggester/exploit-suggester-0.3.tar.gz">exploit-suggester-0.3.tar.gz</a></p>
<h3></h3>
<p><span id="more-108"></span></p>
<h3>Preamble</h3>
<p>After gaining access to a low-privelege account during a pentest (e.g. through password guessing or a remote exploit) the next stage is usually to try to escallate privelges to root.  Techniques typically include:</p>
<ul>
<li>Manipulation of any custom tools which might installed (SUID files, cron jobs)</li>
<li>Obtaining credentials from backup files which have weak file permissions</li>
<li>Exploiting any local trust relationships (.rhosts, SSH keys)</li>
<li>Trojaning the PATH if weak file permissions have been set on directories</li>
<li>Password guessing now you have a full list of usernames</li>
<li>Manipulation of 3rd part tools that have been installed (e.g. weak file permission on config files or in /etc/init.d)</li>
<li>Exploitation of public vulnerabiliites in software that&#8217;s currently installed</li>
</ul>
<p>This tools focusses purely on the last technique.  This tool aims to help you quickly identify which vulnerbilities exist because of poor patching, and gives you a link to publicy available exploit code.</p>
<p>Good pentesters are more than capable of manually identifying which local exploits a system is susceptible to.  However, this process can be a little slow and sometimes degenerates into a tedeous trial and error process.  This tool aims to speed up the process by suggesting which exploits to try first.</p>
<h3>What the tool does</h3>
<p>It reads in a list of installed patches, correlates this information against a small internal database and lists plublic exploits which may help you on your quest for root.  Links are provided so that you can download the exploit and read about the vulnerability.</p>
<p>Some remote exploits are also listed because it was easy to implement.  However, this is of limited to use for remote tests as you need the patch list in order to generate a list of possible sploits.</p>
<h3>What the tool doesn&#8217;t do</h3>
<p>Exploit-suggester does NOT list all missing patches.  Other tools such as <a href="http://www.par.univie.ac.at/solaris/pca/">Patch Check Advanced</a> do this job very effectively.  Exploit-suggester purposefully omits details of vulnerabilities for which public exploit code is not available.</p>
<p>It does not aim to reference all known exploit code, just to list enough help you get root.</p>
<p>It doesn&#8217;t provide the exploit code or tell you how to use it.  It simply points you in the right direction.</p>
<p>Links to descriptions of the vulnerabilities are provided, but this tool will not tell you about about the nature of the vulnerbility, fixes, recommendations or anything else that might help with reporting.</p>
<h3>Installation</h3>
<p>Exploit-suggester is just a PERL script, so installation should be trivial.  Simply place exploit-suggester.pl somehwere in your PATH.  The database file sploitdb.xml must be in the same directory as exploit-suggester.pl.</p>
<p>You may need to install the XML::Simple PERL module first.  If it&#8217;s not available through your package manager, you can get it from CPAN:</p>
<pre># perl -MCPAN -e shell</pre>
<pre>&gt; install XML::Simple</pre>
<h3>Example Output</h3>
<pre>$ head showrev.out
Patch: 109618-01 Obsoletes:  Requires:  Incompatibles:  Packages: SUNWeuxwe, SUNWeuezt, SUNWeudlg, SUNWeudda
Patch: 109889-01 Obsoletes: 109353-04 Requires:  Incompatibles:  Packages: SUNWkvmx, SUNWkvm, SUNWmdb, SUNWhea, SUNWpstl, SUNWpstlx
Patch: 110369-05 Obsoletes: 110709-02 Requires:  Incompatibles:  Packages: SUNWkvmx, SUNWcarx, SUNWcsr</pre>
<pre>...</pre>
<pre>$ ./exploit-suggestions.pl 8 sparc showrev.out
exploit-suggester v0.1 ( http://pentestmonkey.net/tools/exploit-suggester )

 -------------------------------------------------------------
|                     Runtime options                         |
 -------------------------------------------------------------
Solaris version: ................ 8
Architecture: ................... sparc
Patch file: ..................... showrev.out
Exploit database: ............... sploitdb.txt
Don't list sploits rated as ..... N/A - Exclude no ratings
List only sploits rated as ...... N/A - List any rating
List only local sploits ......... N/A - Show both

 -------------------------------------------------------------
|                   Suggested Exploits                        |
 -------------------------------------------------------------
Description:          'at' Arbitrary File Deletion
Remote:               0
Exploit Rating:       1 (Sploit normally works)
Patch installed:      108875-10
Min vulnerable patch: 108875-00
Max vulnerable patch: 108875-12
Exploit Link:         http://www.securityfocus.com/data/vulnerabilities/exploits/isec-solaris-at-rm.c
Exploit Link:         http://www.securityfocus.com/data/vulnerabilities/exploits/solaris-at.c
Info Link:            http://securityfocus.com/bid/6693

Description:          /usr/ucb/ps information leakage
Remote:               0
Exploit Rating:       1 (Sploit normally works)
Patch installed:      109023-01
Min vulnerable patch: 109023-00
Max vulnerable patch: 109023-05
Exploit Link:         http://milw0rm.com/exploits/2242
Note:                 Local environment variable leakage: /usr/ucb/ps -auxgeww

Description:          KCMS Arbitrary File Reading Vulnerability
Remote:               1
Exploit Rating:       1 (Sploit normally works)
Patch installed:      111400-01
Min vulnerable patch: 111400-00
Max vulnerable patch: 111400-01
Exploit Link:         http://www.securityfocus.com/data/vulnerabilities/exploits/solaris_kcms_readfile.pm
Info Link:            http://securityfocus.com/bid/6665

Description:          X11 Keyboard Extension Overflow
Remote:               0
Exploit Rating:       1 (Sploit normally works)
Patch installed:      119067-00
Min vulnerable patch: 119067-00
Max vulnerable patch: 119067-03
Exploit Link:         http://www.securityfocus.com/data/vulnerabilities/exploits/raptor_xkb.c
Info Link:            http://www.securityfocus.com/bid/19905

Description:          libdthelp Overflow Privilege Escalation
Remote:               0
Exploit Rating:       1 (Sploit normally works)
Patch installed:      108949-07
Min vulnerable patch: 108949-00
Max vulnerable patch: 108949-08
Exploit Link:         http://www.securityfocus.com/data/vulnerabilities/exploits/raptor_libdthelp.c
Info Link:            http://www.securityfocus.com/bid/8973

Description:          priocntl Vulnerability
Remote:               0
Exploit Rating:       1 (Sploit normally works)
Patch installed:      108528-13
Min vulnerable patch: 108528-00
Max vulnerable patch: 108528-17
Exploit Link:         http://archive.cert.uni-stuttgart.de/bugtraq/2002/11/msg00359.html
Info Link:            http://securityfocus.com/bid/6262

Description:          sadmind Authentication Spoofing
Remote:               1
Exploit Rating:       1 (Sploit normally works)
Patch installed:      116455-00
Min vulnerable patch: 116455-00
Max vulnerable patch: 116455-00
Exploit Link:         http://www.securityfocus.com/data/vulnerabilities/exploits/solaris_sadmind_exec.pm
Exploit Link:         http://www.securityfocus.com/data/vulnerabilities/exploits/rootdown.plm
Info Link:            http://securityfocus.com/bid/8615

Description:          vfs_getvfssw Kernel Module Loading Vulnerability
Remote:               0
Exploit Rating:       1 (Sploit normally works)
Patch installed:      108528-13
Min vulnerable patch: 108528-00
Max vulnerable patch: 108528-26
Exploit Link:         http://www.securityfocus.com/data/vulnerabilities/exploits/solaris_vfs_getvfssw.tar
Info Link:            http://securityfocus.com/bid/9962
Note:                 DoS risk if you insert the wrong kernel module

Description:          whodo Overflow
Remote:               0
Exploit Rating:       2 (Sploit untested)
Patch installed:      111826-00
Min vulnerable patch: 111826-00
Max vulnerable patch: 111826-00
Exploit Link:         http://www.securityfocus.com/data/vulnerabilities/exploits/whodoexp.c
Info Link:            http://securityfocus.com/bid/2935

Description:          LD_PRELOAD Privilege Escalation
Remote:               0
Exploit Rating:       3 (Sploit normally fails)
Patch installed:      109147-12
Min vulnerable patch: 109147-07
Max vulnerable patch: 109147-24
Exploit Link:         http://www.securityfocus.com/data/vulnerabilities/exploits/raptor_ldpreload.c
Info Link:            http://www.securityfocus.com/bid/8305/info

Description:          libsldap Overflow
Remote:               0
Exploit Rating:       3 (Sploit normally fails)
Patch installed:      111091-00
Min vulnerable patch: 111091-00
Max vulnerable patch: 111091-02
Exploit Link:         http://www.securityfocus.com/data/vulnerabilities/exploits/libsldap-exp.c
Exploit Link:         http://www.securityfocus.com/data/vulnerabilities/exploits/ldap_exp2.c
Info Link:            http://securityfocus.com/bid/2931</pre>
<p><strong>Limitations</strong></p>
<p>Currently the database is biased towards exploiting Solaris 8 on SPARC.  I&#8217;ll update the database to more fully support other flavours of Solaris later.  I might also implement limited support for Windows and Linux too at some stage.</p>
<p>&nbsp;</p>
                <div class="clear"></div>
								<p class="postmeta"><span class="tags"><a href="../../tag/exploitsuggester.html" rel="tag">exploitsuggester</a>, <a href="../../tag/pentest/index.html" rel="tag">pentest</a>, <a href="../../tag/tool/index.html" rel="tag">tool</a></span></p>				<p class="postmeta"><span class="cats"><a href="../../category/tools/audit.html" rel="category tag">Audit</a></span></p>
								
			<p></p>
		
			<div class="navigation2">
				<div class="alignright prev"><a href="../../index.html%3Fp=22.html" rel="prev">Linux Local Privilege Escalation for x86_64</a></div>
				<div class="alignleft next"><a href="../../index.html%3Fp=23.html" rel="next">MS Access SQL Injection Cheat Sheet</a></div>
			</div>		

			</div>
		</div>

	
<!-- You can start editing here. -->


			<!-- If comments are open, but there are no comments. -->

	 
<p></p>
<br />


	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="../../index.html%3Fp=108.html#respond" style="display:none;">Cancel reply</a></small></h3><p class="must-log-in">You must be <a href="https://pentestmonkey.net/wp-login.php?redirect_to=https%3A%2F%2Fpentestmonkey.net%2Ftools%2Faudit%2Fexploit-suggester">logged in</a> to post a comment.</p>	</div><!-- #respond -->
	




	
	</div>
				<!-- sidebar -->
				<div class="sideBar">
					
					<div class="nav">
						<div class="bFrameT"><i></i></div>
	<form method="get" id="searchform" action="../../index.html" class="searchForm">
	<p><input type="text" value="" name="s" id="s" class="field" />
	<input type="image" src="../../wp-content/themes/baza-noclegowa/images/search.gif" alt="" title="Search" id="searchsubmit" class="btn" /></p>
</form>
<h3><span>Categories</span></h3>
			<ul>
					<li class="cat-item cat-item-5"><a href="../../category/blog/index.html">Blog</a> (78)
</li>
	<li class="cat-item cat-item-39"><a href="../../category/cheat-sheet.html">Cheat Sheets</a> (10)
<ul class='children'>
	<li class="cat-item cat-item-40"><a href="../../category/cheat-sheet/shells.html">Shells</a> (1)
</li>
	<li class="cat-item cat-item-8"><a href="../../category/cheat-sheet/sql-injection.html">SQL Injection</a> (7)
</li>
</ul>
</li>
	<li class="cat-item cat-item-7"><a href="../../category/contact.html">Contact</a> (2)
</li>
	<li class="cat-item cat-item-3"><a href="../../category/site-news.html">Site News</a> (3)
</li>
	<li class="cat-item cat-item-4"><a href="../../category/tools/index.html">Tools</a> (17)
<ul class='children'>
	<li class="cat-item cat-item-14"><a href="../../category/tools/audit.html">Audit</a> (3)
</li>
	<li class="cat-item cat-item-16"><a href="../../category/tools/misc.html">Misc</a> (7)
</li>
	<li class="cat-item cat-item-13"><a href="../../category/tools/user-enumeration.html">User Enumeration</a> (4)
</li>
	<li class="cat-item cat-item-15"><a href="../../category/tools/web-shells.html">Web Shells</a> (3)
</li>
</ul>
</li>
	<li class="cat-item cat-item-1"><a href="../../category/uncategorized.html">Uncategorized</a> (3)
</li>
	<li class="cat-item cat-item-6"><a href="../../category/yaptest/index.html">Yaptest</a> (15)
<ul class='children'>
	<li class="cat-item cat-item-12"><a href="../../category/yaptest/front-end.html">Front End</a> (1)
</li>
	<li class="cat-item cat-item-9"><a href="../../category/yaptest/installing.html">Installing</a> (2)
</li>
	<li class="cat-item cat-item-11"><a href="../../category/yaptest/overview.html">Overview</a> (2)
</li>
	<li class="cat-item cat-item-10"><a href="../../category/yaptest/using.html">Using</a> (8)
</li>
</ul>
</li>
			</ul>

						
						<div class="bFrameB"><i></i></div>
					</div>
					
				</div>
				<!-- /sidebar -->	
				</div>
				<!-- /content -->
				
			</div>
			<!-- /CONTENT -->	
			
		
		<!-- bottom NAVIGATION -->
		<div id="bottomNav">
		</div>
		<!-- /bottom NAVIGATION -->
		
		<!-- FOOTER -->
		<div id="footer">
		<p class="footer-menu">
         <ul class="menu"></ul>        </p>
			
<div class="credits">Powered by <a href="http://wordpress.org/">WordPress</a>. Design: <a href="http://www.baza-noclegowa.pl/">Baza Noclegowa</a>.</div>
			
		</div>
		<!-- /FOOTER -->
	</div>
		<script type='text/javascript' src='../../wp-includes/js/wp-embed.min.js%3Fver=5.8.3' id='wp-embed-js'></script>
</body>
</html>
