<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>rsh-grind | pentestmonkey</title>
<link rel="stylesheet" href="../../wp-content/themes/baza-noclegowa/style.css" type="text/css" media="screen" />
<link rel="pingback" href="https://pentestmonkey.net/xmlrpc.php" />
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='https://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="pentestmonkey &raquo; Feed" href="../../feed" />
<link rel="alternate" type="application/rss+xml" title="pentestmonkey &raquo; Comments Feed" href="../../comments/feed" />
<link rel="alternate" type="application/rss+xml" title="pentestmonkey &raquo; rsh-grind Comments Feed" href="rsh-grind/feed" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/pentestmonkey.net\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.8.3"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='../../wp-includes/css/dist/block-library/style.min.css%3Fver=5.8.3.css' type='text/css' media='all' />
<link rel="https://api.w.org/" href="../../wp-json/index.html" /><link rel="alternate" type="application/json" href="../../wp-json/wp/v2/posts/115" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc.php%3Frsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../wp-includes/wlwmanifest.xml" /> 
<link rel="canonical" href="../../index.html%3Fp=115.html" />
<link rel='shortlink' href='../../index.html%3Fp=115.html' />
<link rel="alternate" type="application/json+oembed" href="../../wp-json/oembed/1.0/embed%3Furl=https:%252F%252Fpentestmonkey.net%252Ftools%252Fmisc%252Frsh-grind" />
<link rel="alternate" type="text/xml+oembed" href="../../wp-json/oembed/1.0/embed%3Furl=https:%252F%252Fpentestmonkey.net%252Ftools%252Fmisc%252Frsh-grind&amp;format=xml" />
	
<!--[if IE 6]><script src="https://pentestmonkey.net/wp-content/themes/baza-noclegowa/js/DD_belatedPNG.js"></script><![endif]-->
</head>
<body class="post-template-default single single-post postid-115 single-format-standard">
	<div class="all-page">
		
		<div class="container">
			
			<!-- HEADER -->
			<div id="header">
			    <div class="website-name"><a href="../../index.html">pentestmonkey</a></div>
				<div class="slogan">Taking the monkey work out of pentesting</div>
			</div>
			<div class="clear"></div>
			<!-- /HEADER -->

			<!-- main NAVIGATION -->
			<div id="mainNav">
				<div class="wrap">
    <ul id="menu-cheat-sheets" class="menu"><li id="menu-item-133" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-133"><a href="../../category/site-news.html"><span>Site News</span></a></li>
<li id="menu-item-130" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-130"><a href="../../category/blog/index.html"><span>Blog</span></a></li>
<li id="menu-item-136" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-136"><a href="../../category/tools/index.html"><span>Tools</span></a></li>
<li id="menu-item-137" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-137"><a href="../../category/yaptest/index.html"><span>Yaptest</span></a></li>
<li id="menu-item-134" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-134"><a href="../../category/cheat-sheet.html"><span>Cheat Sheets</span></a></li>
<li id="menu-item-135" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-135"><a href="../../category/contact.html"><span>Contact</span></a></li>
</ul>    <div class="clear"><!-- --></div>
				</div>
			</div>
			<!-- /main NAVIGATION -->
			<div class="clear"></div>


			<!-- CONTENT -->
			<div id="content">
	<!-- Start: Left Panel -->
	<div class="content">

	
		<div class="post-115 post type-post status-publish format-standard hentry category-misc tag-pentest tag-rshgrind tag-unix" id="post-115">
			<h1>rsh-grind</h1>

			<div class="entryContent">
				<p>Basically tries lots of combinations of local and remote usernames to execute commands via RSH.</p>
<p><a href="../rsh-grind/rsh-grind-0.9.2.tar.gz">Download</a></p>
<p>SHA1sum: f1b37abb6ad54df775c1cf194ab91fd41d607f1f</p>
<p>MD5sum: 2ecae8730f89c697f2512181ded3842f</p>
<p>User documentation is also available in <a href="../rsh-grind/rsh-grind-user-docs.pdf">PDF</a> format.</p>
<p><span id="more-115"></span></p>
<p>&nbsp;</p>
<h1 align="center">rsh-grind User Documentation</h1>
<p>&nbsp;</p>
<h2><a title="SECTION00010000000000000000" name="SECTION00010000000000000000"></a> Contents</h2>
<ul>
<li><a title="tex2html11" name="tex2html11" href="https://pentestmonkey.net/tools/misc/rsh-grind-user-docs.html#SECTION00020000000000000000"></a>Overview</li>
<li><a title="tex2html12" name="tex2html12" href="https://pentestmonkey.net/tools/misc/rsh-grind-user-docs.html#SECTION00030000000000000000"></a>Installation</li>
<li><a title="tex2html13" name="tex2html13" href="https://pentestmonkey.net/tools/misc/rsh-grind-user-docs.html#SECTION00040000000000000000"></a>Usage</li>
<li><a title="tex2html14" name="tex2html14" href="https://pentestmonkey.net/tools/misc/rsh-grind-user-docs.html#SECTION00050000000000000000"></a>Some Examples
<ul>
<li><a title="tex2html15" name="tex2html15" href="https://pentestmonkey.net/tools/misc/rsh-grind-user-docs.html#SECTION00051000000000000000"></a>Assuming Remote Usernames are Same as Local Usernames</li>
<li><a title="tex2html16" name="tex2html16" href="https://pentestmonkey.net/tools/misc/rsh-grind-user-docs.html#SECTION00052000000000000000"></a>What if the Local and Remote Usernames are Different?</li>
</ul>
</li>
<li><a title="tex2html17" name="tex2html17" href="https://pentestmonkey.net/tools/misc/rsh-grind-user-docs.html#SECTION00060000000000000000"></a>License</li>
</ul>
<p>&nbsp;</p>
<h1><a title="SECTION00020000000000000000" name="SECTION00020000000000000000"></a>Overview</h1>
<p>rsh-grind is a tool for remotely enumerating user accounts that are able to use the Remtoe Shell (RSH) protocol. The RSH protocol requires a local and remote username to be supplied. rsh-grind simply works through all possible combinations of local and remote usernames supplied via a wordlist.</p>
<h1><a title="SECTION00030000000000000000" name="SECTION00030000000000000000"></a>Installation</h1>
<p>rsh-grind is just a stand alone PERL script, so installation is as simple as copying it to your path (e.g. /usr/local/bin). It has only been tested under Linux so far.</p>
<p>It depends on the following PERL modules which you may need to install them first:</p>
<ul>
<li>Socket</li>
<li>IO::Handle</li>
<li>IO::Select</li>
<li>IO::Socket</li>
<li>Getopt::Std</li>
<li>POSIX;</li>
</ul>
<p>If you have PERL installed, you should be able to install the modules from CPAN:</p>
<pre> # perl -MCPAN -e shell
 cpan&gt; install Getopt::Std</pre>
<h1><a title="SECTION00040000000000000000" name="SECTION00040000000000000000"></a>Usage</h1>
<p>rsh-grind simply needs to be passed a list of local users, a list of remote users and a list of target RSH servers. Here&#8217;s the usage message:</p>
<pre> Usage: rsh-grind.pl [options] ( -U username_file ) ( -f ips.txt | hostname )
        rsh-grind.pl [options] (-l local_user|-L file) | (-r remote_user|-R file) (-f ips.txt|host) 

 options are:
         -m n     Maximum number of processes (default: 10)
         -l       Local username (on the client)
         -L file  File of local usernames
         -r       Remote username (on the server)
         -R file  File or remote usernames
         -U file  File of usernames.  Each will be used as remote and local
                  user (e.g. root/root, smtp/smtp).  Permutations will not
                  be tried.
         -c cmd   Command to execute (default: id)
                  (Must be non-interactive, so don't try /bin/sh for example)
         -f file  File of target hostnames / IPs
         -t n     Wait a maximum of n seconds for reply (default: 5)
         -d       Debugging output
         -v       Verbose
         -h       This help message 

 The Remote Shell Protocol (RSH) allows remote users to execute commands
 on the server.  Authentication is based on:
 - Source IP Address
 - Remote Username
 - Local Username 

 This script can't help you with obtaining a valid source IP address, but
 it can help you try different combinations of remote and local usernames. 

 If your source IP address is in /etc/hosts.equiv, then you just need a
 valid username on the system, the remote and local usernames should be the
 same. 

 If the remote user account you're attacking has a .rhosts file like the
 following in their home directory, it doesn't matter what the local
 username is:
 IP + 

 In both of the above cases, the most efficient usage is: 

 $ rsh-grind.pl -U users.txt target 

 If the .rhosts looks like the following, though the local username must
 be "foo":
 IP foo 

 In this case you might need to try lots of permutations before you
 hit on the one that works.  The correct usage is: 

 $ rsh-grind.pl -L localusers.txt -R remoteusers.txt target 

 Output lines will be something like:
 10.0.0.1/localuser/remoteuser    _uid=101(remoteuser) gid=1(other)_ 

 Non-printable characters are sqashed to _ to fit whole response on
 one line. 

 NB: The RSH protocol requires the binding of a local privileged port, so
 you need to run this script as root.</pre>
<h1><a title="SECTION00050000000000000000" name="SECTION00050000000000000000"></a>Some Examples</h1>
<p>For the examples below we need a list of potential usernames. The following output demostrates the format for this list:</p>
<pre> $ head users.txt
 root
 bin
 daemon
 adm
 lp
 sync
 shutdown
 halt
 mail
 news</pre>
<h2><a title="SECTION00051000000000000000" name="SECTION00051000000000000000"></a> Assuming Remote Usernames are Same as Local Usernames</h2>
<p>If we assume that users of the RSH protocol will use the same username locally (i.e. where the rsh client is run) and remotely (i.e. on the server which we&#8217;re testing), we only need a single list of usernames.</p>
<pre>  $ sudo rsh-grind.pl -U users.txt 172.16.16.7
 Starting rsh-grind v0.9.2 ( http://pentestmonkey.net/tools/rsh-grind ) 

  ----------------------------------------------------------
 |                   Scan Information                       |
  ---------------------------------------------------------- 

 Processes .............. 10
 Command ................ id
 Target ................. 172.16.16.7
 Usernames file ......... users.txt
 Username count ......... 10
 Query timeout .......... 5 secs 

 ######## Scan started at Sun May  6 18:39:13 2007 #########
 172.16.16.7/bin/bin      _uid=2(bin) gid=2(bin)_
 172.16.16.7/daemon/daemon        _uid=1(daemon) gid=1(other)_
 172.16.16.7/lp/lp        _uid=71(lp) gid=8(lp)_
 172.16.16.7/adm/adm      _uid=4(adm) gid=4(adm)_
 ######## Scan completed at Sun May  6 18:39:14 2007 #########
 4 results. 

 10 queries in 1 seconds (10.0 queries / sec)</pre>
<p>Note that we have to run as root because the RSH protocol requires us to bind to ports below 1024.</p>
<p>The results show 4 pairs of local and remote users that can execute commands via RSH. This usually indicates that user have an entry like the following in their /.rhosts file:</p>
<pre> + myuser</pre>
<p>The + here means that access is allowed from any source IP address.</p>
<p>However, in this case the results are caused by the host running rsh-grind being present in /etc/hosts.equiv (not very likely in the real world, but it demonstrates what results you&#8217;d get with the small list of usernames above).</p>
<h2><a title="SECTION00052000000000000000" name="SECTION00052000000000000000"></a> What if the Local and Remote Usernames are Different?</h2>
<p>The remote username is sometimes different to the local username, e.g. a user fred might have the following in fred/.rhosts:</p>
<pre> + fbloggs</pre>
<p>This means that the remote user fbloggs would be allowed to access fred&#8217;s account from any source IP address.</p>
<p>We simply supply two lists of usernames (often, but not necessarily the same list):</p>
<pre>  $ sudo ./rsh-grind.pl -L localusers.txt -R remoteusers.txt 172.16.16.7
 Starting rsh-grind v0.9.2 ( http://pentestmonkey.net/tools/rsh-grind ) 

  ----------------------------------------------------------
 |                   Scan Information                       |
  ---------------------------------------------------------- 

 Processes .............. 10
 Command ................ id
 Target ................. 172.16.16.7
 Remote usernames file .. localusers.txt
 Local usernames file ... remoteusers.txt
 Remote username count .. 12
 Local username count ... 12
 Query timeout .......... 5 secs 

 ######## Scan started at Sun May  6 18:58:03 2007 #########
 172.16.16.7/fred/fbloggs        _uid=102(fred) gid=1(group)_
 ######## Scan completed at Sun May  6 18:58:09 2007 #########
 0 results. 

 144 queries in 6 seconds (24.0 queries / sec)</pre>
<h1><a title="SECTION00060000000000000000" name="SECTION00060000000000000000"></a>License</h1>
<p>This tool may be used for legal purposes only. Users take full responsibility for any actions performed using this tool. The author accepts no liability for damage caused by this tool. If these terms are not acceptable to you, then do not use this tool.</p>
<p>In all other respects the GPL version 2 applies:</p>
<pre> This program is free software; you can redistribute it and/or modify
 it under the terms of the GNU General Public License version 2 as
 published by the Free Software Foundation. 

 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details. 

 You should have received a copy of the GNU General Public License along
 with this program; if not, write to the Free Software Foundation, Inc.,
 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</pre>
                <div class="clear"></div>
								<p class="postmeta"><span class="tags"><a href="../../tag/pentest/index.html" rel="tag">pentest</a>, <a href="../../tag/rshgrind.html" rel="tag">rshgrind</a>, <a href="../../tag/unix.html" rel="tag">unix</a></span></p>				<p class="postmeta"><span class="cats"><a href="../../category/tools/misc.html" rel="category tag">Misc</a></span></p>
								
			<p></p>
		
			<div class="navigation2">
				<div class="alignright prev"><a href="../../index.html%3Fp=114.html" rel="prev">dns-grind</a></div>
				<div class="alignleft next"><a href="../smtp-user-enum/index.html" rel="next">smtp-user-enum</a></div>
			</div>		

			</div>
		</div>

	
<!-- You can start editing here. -->


			<!-- If comments are open, but there are no comments. -->

	 
<p></p>
<br />


	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="../../index.html%3Fp=115.html#respond" style="display:none;">Cancel reply</a></small></h3><p class="must-log-in">You must be <a href="https://pentestmonkey.net/wp-login.php?redirect_to=https%3A%2F%2Fpentestmonkey.net%2Ftools%2Fmisc%2Frsh-grind">logged in</a> to post a comment.</p>	</div><!-- #respond -->
	




	
	</div>
				<!-- sidebar -->
				<div class="sideBar">
					
					<div class="nav">
						<div class="bFrameT"><i></i></div>
	<form method="get" id="searchform" action="../../index.html" class="searchForm">
	<p><input type="text" value="" name="s" id="s" class="field" />
	<input type="image" src="../../wp-content/themes/baza-noclegowa/images/search.gif" alt="" title="Search" id="searchsubmit" class="btn" /></p>
</form>
<h3><span>Categories</span></h3>
			<ul>
					<li class="cat-item cat-item-5"><a href="../../category/blog/index.html">Blog</a> (78)
</li>
	<li class="cat-item cat-item-39"><a href="../../category/cheat-sheet.html">Cheat Sheets</a> (10)
<ul class='children'>
	<li class="cat-item cat-item-40"><a href="../../category/cheat-sheet/shells.html">Shells</a> (1)
</li>
	<li class="cat-item cat-item-8"><a href="../../category/cheat-sheet/sql-injection.html">SQL Injection</a> (7)
</li>
</ul>
</li>
	<li class="cat-item cat-item-7"><a href="../../category/contact.html">Contact</a> (2)
</li>
	<li class="cat-item cat-item-3"><a href="../../category/site-news.html">Site News</a> (3)
</li>
	<li class="cat-item cat-item-4"><a href="../../category/tools/index.html">Tools</a> (17)
<ul class='children'>
	<li class="cat-item cat-item-14"><a href="../../category/tools/audit.html">Audit</a> (3)
</li>
	<li class="cat-item cat-item-16"><a href="../../category/tools/misc.html">Misc</a> (7)
</li>
	<li class="cat-item cat-item-13"><a href="../../category/tools/user-enumeration.html">User Enumeration</a> (4)
</li>
	<li class="cat-item cat-item-15"><a href="../../category/tools/web-shells.html">Web Shells</a> (3)
</li>
</ul>
</li>
	<li class="cat-item cat-item-1"><a href="../../category/uncategorized.html">Uncategorized</a> (3)
</li>
	<li class="cat-item cat-item-6"><a href="../../category/yaptest/index.html">Yaptest</a> (15)
<ul class='children'>
	<li class="cat-item cat-item-12"><a href="../../category/yaptest/front-end.html">Front End</a> (1)
</li>
	<li class="cat-item cat-item-9"><a href="../../category/yaptest/installing.html">Installing</a> (2)
</li>
	<li class="cat-item cat-item-11"><a href="../../category/yaptest/overview.html">Overview</a> (2)
</li>
	<li class="cat-item cat-item-10"><a href="../../category/yaptest/using.html">Using</a> (8)
</li>
</ul>
</li>
			</ul>

						
						<div class="bFrameB"><i></i></div>
					</div>
					
				</div>
				<!-- /sidebar -->	
				</div>
				<!-- /content -->
				
			</div>
			<!-- /CONTENT -->	
			
		
		<!-- bottom NAVIGATION -->
		<div id="bottomNav">
		</div>
		<!-- /bottom NAVIGATION -->
		
		<!-- FOOTER -->
		<div id="footer">
		<p class="footer-menu">
         <ul class="menu"></ul>        </p>
			
<div class="credits">Powered by <a href="http://wordpress.org/">WordPress</a>. Design: <a href="http://www.baza-noclegowa.pl/">Baza Noclegowa</a>.</div>
			
		</div>
		<!-- /FOOTER -->
	</div>
		<script type='text/javascript' src='../../wp-includes/js/wp-embed.min.js%3Fver=5.8.3' id='wp-embed-js'></script>
</body>
</html>
